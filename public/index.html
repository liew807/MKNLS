<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>å­£ä¼¯å¸¸å·¥å…·å¹³å° V3.0 - CPMå…‹éš†å¢å¼ºç‰ˆ</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
    /* ç¬¬ä¸€ä¸ªé¡µé¢çš„æ‰€æœ‰CSSæ ·å¼ */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
    }

    :root {
        --ios-blue: #007AFF;
        --ios-gray-1: #8E8E93;
        --ios-gray-2: #AEAEB2;
        --ios-gray-3: #C7C7CC;
        --ios-gray-4: #D1D1D6;
        --ios-gray-5: #E5E5EA;
        --ios-gray-6: #F2F2F7;
        --ios-red: #FF3B30;
        --ios-orange: #FF9500;
        --ios-green: #34C759;
        --ios-teal: #5AC8FA;
        --ios-purple: #AF52DE;
        --ios-pink: #FF2D55;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: #000000 !important;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px 16px;
        color: #FFFFFF;
        position: relative;
        overflow-x: hidden;
    }

    /* éœ“è™¹å…‰æ™•æ•ˆæœ */
    .neon-glow {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        pointer-events: none;
        background: 
            radial-gradient(circle at 20% 80%, rgba(255, 149, 0, 0.25) 0%, transparent 50%),
            radial-gradient(circle at 80% 20%, rgba(255, 45, 85, 0.25) 0%, transparent 50%),
            radial-gradient(circle at 40% 40%, rgba(175, 82, 222, 0.25) 0%, transparent 50%),
            radial-gradient(circle at 60% 60%, rgba(0, 122, 255, 0.25) 0%, transparent 50%);
        animation: glowShift 15s ease infinite;
    }

    @keyframes glowShift {
        0%, 100% { opacity: 0.6; transform: scale(1); }
        50% { opacity: 0.8; transform: scale(1.05); }
    }

    /* ç½‘æ ¼èƒŒæ™¯ */
    .grid-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: 
            linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
        background-size: 30px 30px;
        z-index: -2;
        opacity: 0.3;
    }

    /* ç§‘å¹»ç²’å­æ•ˆæœ */
    .particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        pointer-events: none;
    }

    .particle {
        position: absolute;
        width: 2px;
        height: 2px;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 50%;
        animation: float 20s linear infinite;
    }

    @keyframes float {
        0% {
            transform: translateY(100vh) translateX(0);
            opacity: 0;
        }
        10% {
            opacity: 1;
        }
        90% {
            opacity: 1;
        }
        100% {
            transform: translateY(-100px) translateX(calc(100vw * var(--x)));
            opacity: 0;
        }
    }

    /* éœ“è™¹è¾¹æ¡†å¡ç‰‡ */
    .neon-card {
        width: 100%;
        max-width: 420px;
        background: rgba(0, 0, 0, 0.95) !important;
        backdrop-filter: blur(20px) saturate(200%);
        -webkit-backdrop-filter: blur(20px) saturate(200%);
        border-radius: 24px;
        padding: 24px 20px;
        margin-bottom: 20px;
        position: relative;
        z-index: 1;
        border: 1px solid transparent;
        box-shadow: 
            0 0 20px rgba(0, 122, 255, 0.3),
            0 0 40px rgba(255, 149, 0, 0.2),
            0 0 60px rgba(175, 82, 222, 0.1),
            inset 0 0 20px rgba(255, 255, 255, 0.05);
        animation: borderGlow 3s ease-in-out infinite alternate;
    }

    @keyframes borderGlow {
        0% {
            box-shadow: 
                0 0 20px rgba(0, 122, 255, 0.3),
                0 0 40px rgba(255, 149, 0, 0.2),
                0 0 60px rgba(175, 82, 222, 0.1),
                inset 0 0 20px rgba(255, 255, 255, 0.05);
        }
        100% {
            box-shadow: 
                0 0 25px rgba(0, 122, 255, 0.4),
                0 0 50px rgba(255, 149, 0, 0.3),
                0 0 75px rgba(175, 82, 222, 0.2),
                inset 0 0 30px rgba(255, 255, 255, 0.1);
        }
    }

    /* æ ‡é¢˜æ ·å¼ - éœ“è™¹æ¸å˜é—ªçƒ */
    .neon-title {
        text-align: center;
        font-size: 28px;
        font-weight: 700;
        margin-bottom: 24px;
        letter-spacing: -0.5px;
        background: linear-gradient(45deg, 
            #FF9500, #FF2D55, #AF52DE, #007AFF, #34C759, 
            #FF9500, #FF2D55, #AF52DE, #007AFF, #34C759);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        background-size: 300% 300%;
        animation: gradientShift 5s ease infinite, textGlow 2s ease-in-out infinite alternate;
        text-shadow: 
            0 0 10px rgba(255, 149, 0, 0.7),
            0 0 20px rgba(255, 149, 0, 0.5),
            0 0 30px rgba(255, 149, 0, 0.3);
    }

    @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    @keyframes textGlow {
        0% {
            text-shadow: 
                0 0 10px rgba(255, 149, 0, 0.7),
                0 0 20px rgba(255, 149, 0, 0.5),
                0 0 30px rgba(255, 149, 0, 0.3);
        }
        100% {
            text-shadow: 
                0 0 15px rgba(255, 149, 0, 0.9),
                0 0 30px rgba(255, 149, 0, 0.7),
                0 0 45px rgba(255, 149, 0, 0.5),
                0 0 60px rgba(255, 149, 0, 0.3);
        }
    }

    /* ç‰ˆæœ¬æ ‡ç­¾ - éœ“è™¹æ•ˆæœ */
    .version-badge {
        position: absolute;
        top: 10px;
        left: 10px;
        background: linear-gradient(135deg, #FF9500, #FF2D55);
        color: white;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        z-index: 2;
        box-shadow: 0 0 10px rgba(255, 149, 0, 0.5);
        animation: badgePulse 2s infinite;
    }

    @keyframes badgePulse {
        0%, 100% { box-shadow: 0 0 10px rgba(255, 149, 0, 0.5); }
        50% { box-shadow: 0 0 20px rgba(255, 149, 0, 0.8); }
    }

    /* è¯­è¨€é€‰æ‹©å™¨ */
    .language-selector {
        position: absolute;
        top: 20px;
        right: 20px;
        z-index: 1000;
    }

    .language-dropdown {
        background: rgba(0, 0, 0, 0.9);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 12px;
        padding: 8px 12px;
        color: #FFFFFF;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        backdrop-filter: blur(10px);
        min-width: 120px;
        box-shadow: 0 0 10px rgba(0, 122, 255, 0.3);
        transition: all 0.3s ease;
    }

    .language-dropdown:hover {
        border-color: var(--ios-blue);
        box-shadow: 0 0 15px rgba(0, 122, 255, 0.5);
    }

    .language-dropdown:focus {
        outline: none;
        box-shadow: 0 0 0 2px var(--ios-blue), 0 0 20px rgba(0, 122, 255, 0.5);
    }

    /* é¦–é¡µæ¨å¹¿ä¿¡æ¯ - éœ“è™¹æ•ˆæœ */
    .home-promotion {
        width: 100%;
        max-width: 420px;
        margin-top: 20px;
        margin-bottom: 20px;
        background: rgba(0, 0, 0, 0.95);
        border-radius: 20px;
        padding: 20px;
        border: 1px solid rgba(255, 149, 0, 0.3);
        box-shadow: 
            0 0 20px rgba(255, 149, 0, 0.3),
            0 0 40px rgba(255, 149, 0, 0.1),
            inset 0 0 20px rgba(255, 149, 0, 0.05);
        animation: promotionGlow 3s ease-in-out infinite alternate;
    }

    @keyframes promotionGlow {
        0% {
            box-shadow: 
                0 0 20px rgba(255, 149, 0, 0.3),
                0 0 40px rgba(255, 149, 0, 0.1),
                inset 0 0 20px rgba(255, 149, 0, 0.05);
        }
        100% {
            box-shadow: 
                0 0 30px rgba(255, 149, 0, 0.4),
                0 0 60px rgba(255, 149, 0, 0.2),
                inset 0 0 30px rgba(255, 149, 0, 0.1);
        }
    }

    .promotion-header {
        text-align: center;
        margin-bottom: 16px;
    }

    .promotion-title {
        font-size: 18px;
        font-weight: 700;
        margin-bottom: 8px;
        background: linear-gradient(45deg, #FF9500, #FF2D55);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 0 10px rgba(255, 149, 0, 0.5);
    }

    .promotion-subtitle {
        font-size: 14px;
        color: rgba(255, 255, 255, 0.9);
        margin-bottom: 16px;
        text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
    }

    .promotion-links {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .promotion-link {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        padding: 16px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 16px;
        color: white;
        text-decoration: none;
        font-weight: 600;
        font-size: 16px;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.2);
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    .promotion-link::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s ease;
    }

    .promotion-link:hover::before {
        left: 100%;
    }

    .promotion-link:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .promotion-link.xianyu {
        background: linear-gradient(135deg, rgba(255, 107, 53, 0.2), rgba(255, 149, 0, 0.2));
        border-color: rgba(255, 107, 53, 0.5);
        box-shadow: 0 0 15px rgba(255, 107, 53, 0.3);
    }

    .promotion-link.kuaishou {
        background: linear-gradient(135deg, rgba(255, 45, 85, 0.2), rgba(175, 82, 222, 0.2));
        border-color: rgba(255, 45, 85, 0.5);
        box-shadow: 0 0 15px rgba(255, 45, 85, 0.3);
    }

    .promotion-link.tg {
        background: linear-gradient(135deg, rgba(0, 136, 204, 0.2), rgba(52, 170, 223, 0.2));
        border-color: rgba(0, 136, 204, 0.5);
        box-shadow: 0 0 15px rgba(0, 136, 204, 0.3);
    }

    /* TGé¢‘é“æŒ‰é’® */
    .tg-channel-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        width: 100%;
        padding: 16px;
        margin-bottom: 16px;
        border: none;
        border-radius: 16px;
        background: linear-gradient(135deg, rgba(0, 136, 204, 0.2), rgba(52, 170, 223, 0.2));
        color: white;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        border: 1px solid rgba(0, 136, 204, 0.5);
        box-shadow: 0 0 15px rgba(0, 136, 204, 0.3);
        position: relative;
        overflow: hidden;
    }

    .tg-channel-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s ease;
    }

    .tg-channel-btn:hover::before {
        left: 100%;
    }

    .tg-channel-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0, 136, 204, 0.4);
    }

    /* æµ‹è¯•å¡æ ‡ç­¾ */
    .test-card-badge {
        background: linear-gradient(135deg, #FF9500, #FF2D55);
        color: white;
        padding: 4px 8px;
        border-radius: 8px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
        margin-left: 8px;
        box-shadow: 0 0 10px rgba(255, 149, 0, 0.5);
        animation: badgePulse 2s infinite;
    }

    /* æ”¹å¯†å¡æ ‡ç­¾ */
    .password-card-badge {
        background: linear-gradient(135deg, #34C759, #5AC8FA);
        color: white;
        padding: 4px 8px;
        border-radius: 8px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
        margin-left: 8px;
        box-shadow: 0 0 10px rgba(52, 199, 89, 0.5);
        animation: badgePulse 2s infinite;
    }

    /* é—ªçƒçš„åˆ°æœŸæ—¶é—´ */
    .blinking-expiry {
        animation: blink 2s infinite, colorShift 3s infinite;
        font-weight: bold;
        text-align: center;
        padding: 12px;
        border-radius: 12px;
        margin: 10px 0;
        background: linear-gradient(45deg, 
            #FF0000, #FF9500, #FFFF00, #34C759, #007AFF, #AF52DE,
            #FF0000, #FF9500, #FFFF00, #34C759, #007AFF, #AF52DE);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        background-size: 400% 400%;
        text-shadow: 0 0 10px currentColor;
        border: 1px solid rgba(255, 255, 255, 0.2);
        background-color: rgba(0, 0, 0, 0.3);
    }

    @keyframes blink {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }

    @keyframes colorShift {
        0% { background-position: 0% 50%; }
        100% { background-position: 400% 50%; }
    }

    /* çŠ¶æ€æ¶ˆæ¯ - éœ“è™¹æ•ˆæœ */
    .neon-status {
        text-align: center;
        padding: 16px;
        border-radius: 16px;
        margin-bottom: 16px;
        font-weight: 600;
        font-size: 16px;
        min-height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        background: rgba(0, 0, 0, 0.8);
        border: 1px solid;
        position: relative;
        overflow: hidden;
    }

    .neon-status::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1), transparent 70%);
        animation: shine 3s infinite;
    }

    @keyframes shine {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }

    .neon-status.error {
        color: #FF3B30;
        border-color: rgba(255, 59, 48, 0.5);
        box-shadow: 
            0 0 20px rgba(255, 59, 48, 0.3),
            inset 0 0 20px rgba(255, 59, 48, 0.1);
        text-shadow: 0 0 10px rgba(255, 59, 48, 0.5);
    }

    .neon-status.success {
        color: #34C759;
        border-color: rgba(52, 199, 89, 0.5);
        box-shadow: 
            0 0 20px rgba(52, 199, 89, 0.3),
            inset 0 0 20px rgba(52, 199, 89, 0.1);
        text-shadow: 0 0 10px rgba(52, 199, 89, 0.5);
    }

    .neon-status.admin {
        color: #FF9500;
        border-color: rgba(255, 149, 0, 0.5);
        box-shadow: 
            0 0 20px rgba(255, 149, 0, 0.3),
            inset 0 0 20px rgba(255, 149, 0, 0.1);
        text-shadow: 0 0 10px rgba(255, 149, 0, 0.5);
    }

    .neon-status.super-admin {
        color: #AF52DE;
        border-color: rgba(175, 82, 222, 0.5);
        box-shadow: 
            0 0 20px rgba(175, 82, 222, 0.3),
            inset 0 0 20px rgba(175, 82, 222, 0.1);
        text-shadow: 0 0 10px rgba(175, 82, 222, 0.5);
    }

    .neon-status.test-card {
        color: #FF2D55;
        border-color: rgba(255, 45, 85, 0.5);
        box-shadow: 
            0 0 20px rgba(255, 45, 85, 0.3),
            inset 0 0 20px rgba(255, 45, 85, 0.1);
        text-shadow: 0 0 10px rgba(255, 45, 85, 0.5);
    }

    .neon-status.password-card {
        color: #34C759;
        border-color: rgba(52, 199, 89, 0.5);
        box-shadow: 
            0 0 20px rgba(52, 199, 89, 0.3),
            inset 0 0 20px rgba(52, 199, 89, 0.1);
        text-shadow: 0 0 10px rgba(52, 199, 89, 0.5);
    }

    /* éœ“è™¹è¾“å…¥æ¡† */
    .neon-input {
        width: 100%;
        padding: 16px;
        margin-bottom: 12px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 12px;
        background: rgba(0, 0, 0, 0.8);
        font-size: 17px;
        transition: all 0.3s ease;
        outline: none;
        color: #FFFFFF;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
    }

    .neon-input:focus {
        border-color: var(--ios-blue);
        background: rgba(0, 0, 0, 0.9);
        box-shadow: 
            0 0 20px rgba(0, 122, 255, 0.5),
            0 0 40px rgba(0, 122, 255, 0.2);
    }

    .neon-input::placeholder {
        color: rgba(255, 255, 255, 0.6);
    }

    /* éœ“è™¹æŒ‰é’® */
    .neon-button {
        width: 100%;
        padding: 16px;
        border: none;
        border-radius: 12px;
        background: linear-gradient(135deg, rgba(0, 122, 255, 0.2), rgba(90, 200, 250, 0.2));
        color: white;
        font-size: 17px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-bottom: 8px;
        border: 1px solid rgba(0, 122, 255, 0.5);
        box-shadow: 0 0 15px rgba(0, 122, 255, 0.3);
        position: relative;
        overflow: hidden;
    }

    .neon-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s ease;
    }

    .neon-button:hover::before {
        left: 100%;
    }

    .neon-button:hover {
        transform: translateY(-3px);
        box-shadow: 
            0 10px 30px rgba(0, 122, 255, 0.4),
            0 0 40px rgba(0, 122, 255, 0.2);
    }

    .neon-button:active {
        transform: translateY(0);
    }

    .neon-button.secondary {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
    }

    .neon-button.destructive {
        background: linear-gradient(135deg, rgba(255, 59, 48, 0.2), rgba(255, 122, 112, 0.2));
        border: 1px solid rgba(255, 59, 48, 0.5);
        box-shadow: 0 0 15px rgba(255, 59, 48, 0.3);
    }

    .neon-button.success {
        background: linear-gradient(135deg, rgba(52, 199, 89, 0.2), rgba(111, 207, 151, 0.2));
        border: 1px solid rgba(52, 199, 89, 0.5);
        box-shadow: 0 0 15px rgba(52, 199, 89, 0.3);
    }

    .neon-button.test-card {
        background: linear-gradient(135deg, rgba(255, 149, 0, 0.2), rgba(255, 45, 85, 0.2));
        border: 1px solid rgba(255, 149, 0, 0.5);
        box-shadow: 0 0 15px rgba(255, 149, 0, 0.3);
    }

    .neon-button.password-card {
        background: linear-gradient(135deg, rgba(52, 199, 89, 0.2), rgba(90, 200, 250, 0.2));
        border: 1px solid rgba(52, 199, 89, 0.5);
        box-shadow: 0 0 15px rgba(52, 199, 89, 0.3);
    }

    .neon-button:disabled {
        background: rgba(142, 142, 147, 0.2);
        color: rgba(142, 142, 147, 0.5);
        border-color: rgba(142, 142, 147, 0.3);
        box-shadow: none;
        cursor: not-allowed;
        transform: none;
    }

    .neon-button:disabled::before {
        display: none;
    }

    /* å¯¼èˆªæŒ‰é’®ç»„ */
    .neon-nav-buttons {
        display: flex;
        gap: 8px;
        margin: 16px 0;
    }

    .neon-nav-buttons button {
        flex: 1;
        padding: 12px;
        font-size: 15px;
    }

    /* åˆ°æœŸæ—¶é—´æ˜¾ç¤º */
    .neon-expiry {
        text-align: center;
        margin: 16px 0;
        color: white;
        font-size: 15px;
        line-height: 1.4;
        background: rgba(0, 0, 0, 0.8);
        padding: 16px;
        border-radius: 16px;
        border: 1px solid rgba(255, 149, 0, 0.3);
        box-shadow: 
            0 0 20px rgba(255, 149, 0, 0.2),
            inset 0 0 20px rgba(255, 149, 0, 0.05);
    }

    /* ç»‘å®šä¿¡æ¯ */
    .neon-bind-info {
        text-align: center;
        margin: 12px 0;
        color: white;
        font-size: 15px;
        font-weight: 500;
        background: rgba(255, 149, 0, 0.2);
        padding: 12px;
        border-radius: 12px;
        border: 1px solid rgba(255, 149, 0, 0.5);
        box-shadow: 0 0 15px rgba(255, 149, 0, 0.3);
        animation: bindPulse 3s infinite;
    }

    @keyframes bindPulse {
        0%, 100% { box-shadow: 0 0 15px rgba(255, 149, 0, 0.3); }
        50% { box-shadow: 0 0 25px rgba(255, 149, 0, 0.5); }
    }

    /* ç®¡ç†å‘˜é¢æ¿ */
    .neon-admin-panel {
        border-top: 1px solid rgba(255, 255, 255, 0.3);
        padding-top: 20px;
        margin-top: 20px;
    }

    .neon-admin-title {
        text-align: center;
        font-size: 20px;
        font-weight: 700;
        color: white;
        margin-bottom: 16px;
        background: linear-gradient(45deg, #FF9500, #AF52DE);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 0 10px rgba(255, 149, 0, 0.5);
    }

    .admin-level-badge {
        background: linear-gradient(135deg, #AF52DE, #007AFF);
        color: white;
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        margin-left: 8px;
        box-shadow: 0 0 10px rgba(175, 82, 222, 0.5);
        animation: badgePulse 2s infinite;
    }

    /* CPMCYå…‹éš†å·¥å…·ç‰¹å®šæ ·å¼ */
    .clone-card {
        display: none;
    }

    .clone-card.active {
        display: block;
    }

    .account-details-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }

    .info-box {
        background: rgba(0, 0, 0, 0.6);
        border: 1px solid rgba(0, 122, 255, 0.3);
        border-radius: 12px;
        padding: 15px;
        transition: all 0.3s ease;
    }

    .info-box:hover {
        border-color: var(--ios-blue);
        box-shadow: 0 0 20px rgba(0, 122, 255, 0.3);
        transform: translateY(-3px);
    }

    .info-label {
        display: block;
        color: rgba(255, 255, 255, 0.7);
        font-size: 12px;
        font-weight: 500;
        margin-bottom: 5px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .info-value {
        display: block;
        color: #ffffff;
        font-size: 16px;
        font-weight: 600;
        font-family: 'Inter', sans-serif;
    }

    .status-badge {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        background: linear-gradient(135deg, rgba(255, 149, 0, 0.2), rgba(255, 45, 85, 0.2));
        border: 1px solid rgba(255, 149, 0, 0.5);
        box-shadow: 0 0 10px rgba(255, 149, 0, 0.3);
    }

    .operation-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }

    .option-item {
        position: relative;
    }

    .option-item input[type="radio"] {
        display: none;
    }

    .option-item label {
        display: block;
        padding: 20px;
        background: rgba(0, 0, 0, 0.6);
        border: 2px solid rgba(106, 17, 203, 0.3);
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
    }

    .option-item input[type="radio"]:checked + label {
        border-color: #6a11cb;
        background: linear-gradient(135deg, rgba(106, 17, 203, 0.1), rgba(37, 117, 252, 0.1));
        transform: scale(1.02);
        box-shadow: 0 0 20px rgba(106, 17, 203, 0.3);
    }

    .option-item label strong {
        display: block;
        color: #ffffff;
        font-size: 16px;
        margin-bottom: 8px;
        font-weight: 600;
    }

    .option-item label small {
        color: rgba(255, 255, 255, 0.7);
        font-size: 12px;
        line-height: 1.4;
    }

    .warning-box {
        background: linear-gradient(135deg, rgba(255, 59, 48, 0.1), rgba(255, 122, 112, 0.1));
        border: 2px solid rgba(255, 59, 48, 0.3);
        color: #ff8fa3;
        padding: 15px;
        border-radius: 12px;
        margin: 20px 0;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow: 0 0 20px rgba(255, 59, 48, 0.1);
    }

    .time-warning-box {
        background: linear-gradient(135deg, rgba(255, 149, 0, 0.1), rgba(241, 196, 15, 0.1));
        border: 2px solid rgba(255, 149, 0, 0.3);
        color: #ffd166;
        padding: 15px;
        border-radius: 12px;
        margin: 20px 0;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow: 0 0 20px rgba(255, 149, 0, 0.1);
    }

    .note-box {
        background: linear-gradient(135deg, rgba(52, 199, 89, 0.1), rgba(46, 204, 113, 0.1));
        border: 2px solid rgba(52, 199, 89, 0.3);
        color: #7effb2;
        padding: 15px;
        border-radius: 12px;
        margin: 20px 0;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow: 0 0 20px rgba(52, 199, 89, 0.1);
    }

    .progress-container {
        background: rgba(20, 20, 40, 0.7);
        border-radius: 12px;
        height: 20px;
        overflow: hidden;
        margin: 20px 0;
        position: relative;
        box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
    }

    .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #6a11cb 0%, #2575fc 100%);
        width: 0%;
        transition: width 0.4s ease;
        position: relative;
        box-shadow: 0 0 20px rgba(106, 17, 203, 0.5);
    }

    .progress-bar::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, 
            transparent 25%, 
            rgba(255, 255, 255, 0.3) 50%, 
            transparent 75%);
        animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }

    .progress-text {
        text-align: center;
        margin: 15px 0;
        color: #ffffff;
        font-weight: 600;
        font-size: 16px;
        text-shadow: 0 0 10px rgba(106, 17, 203, 0.5);
    }

    .status-log {
        background: rgba(10, 10, 30, 0.7);
        border-radius: 12px;
        padding: 20px;
        max-height: 300px;
        overflow-y: auto;
        border: 1px solid rgba(106, 17, 203, 0.3);
        box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.3);
        margin-bottom: 20px;
    }

    .log-entry {
        padding: 10px 15px;
        border-bottom: 1px solid rgba(106, 17, 203, 0.1);
        color: #e0e0ff;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: all 0.2s ease;
    }

    .log-entry:hover {
        background: rgba(106, 17, 203, 0.05);
        border-radius: 6px;
    }

    .log-entry:last-child {
        border-bottom: none;
    }

    .log-entry i {
        color: #6a11cb;
    }

    /* åˆ‡æ¢æ ‡ç­¾æ ·å¼ */
    .tab-switcher {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
    }

    .tab-btn {
        flex: 1;
        padding: 12px;
        background: rgba(0, 0, 0, 0.6);
        border: 1px solid rgba(106, 17, 203, 0.3);
        border-radius: 10px;
        color: white;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .tab-btn:hover {
        border-color: #6a11cb;
        background: rgba(106, 17, 203, 0.1);
    }

    .tab-btn.active {
        background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        border-color: #6a11cb;
        box-shadow: 0 0 20px rgba(106, 17, 203, 0.3);
    }

    /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
    @media (max-width: 480px) {
        body {
            padding: 12px 10px;
        }

        .neon-card {
            padding: 14px 12px;
            max-width: 380px;
            border-radius: 16px;
            margin-bottom: 12px;
        }

        .neon-title {
            font-size: 22px;
            margin-bottom: 12px;
        }

        .neon-input {
            padding: 12px;
            font-size: 15px;
            margin-bottom: 10px;
        }

        .neon-button {
            padding: 12px;
            font-size: 15px;
        }

        .neon-nav-buttons {
            gap: 6px;
            margin: 10px 0;
        }

        .account-details-grid {
            grid-template-columns: 1fr;
        }

        .operation-options {
            grid-template-columns: 1fr;
        }

        .tab-switcher {
            flex-direction: column;
        }

        .status-log {
            max-height: 250px;
        }
    }
</style>
</head>
<body>

<!-- èƒŒæ™¯å…ƒç´  -->
<div class="grid-bg"></div>
<div class="neon-glow"></div>
<div class="particles" id="particles"></div>

<!-- ç‰ˆæœ¬æ ‡ç­¾ -->
<div class="version-badge">V3.0</div>

<!-- è¯­è¨€é€‰æ‹©å™¨ -->
<div class="language-selector">
    <select id="languageSelect" class="language-dropdown" onchange="changeLanguage(this.value)">
        <option value="zh-CN">ä¸­æ–‡ç®€ä½“</option>
        <option value="zh-TW">ä¸­æ–‡ç¹é«”</option>
        <option value="en">English</option>
    </select>
</div>

<!-- ä¸»å¡ç‰‡å®¹å™¨ -->
<div class="neon-card">
    <h1 class="neon-title" id="pageTitle">å­£ä¼¯å¸¸å·¥å…·å¹³å° V3.0</h1>

    <!-- åŠŸèƒ½æ ‡ç­¾åˆ‡æ¢ -->
    <div class="tab-switcher">
        <button class="tab-btn active" onclick="switchTab('main')">ğŸ  ä¸»åŠŸèƒ½</button>
        <button class="tab-btn" onclick="switchTab('clone')">ğŸ”§ CPMå…‹éš†</button>
        <button class="tab-btn" onclick="switchTab('admin')">âš™ï¸ ç®¡ç†é¢æ¿</button>
    </div>

    <!-- ä¸»åŠŸèƒ½æ ‡ç­¾ -->
    <div id="main-tab" class="tab-content active">
        <!-- TGé¢‘é“æŒ‰é’® -->
        <a href="https://t.me/cpmjbctool" class="tg-channel-btn" target="_blank">
            <i class="fab fa-telegram"></i>
            åŠ å…¥è€å­£çš„å°é»‘å±‹
        </a>

        <!-- å¯¼èˆªæŒ‰é’® -->
        <div class="neon-nav-buttons" id="navButtons">
            <button class="neon-button secondary" onclick="handleReturnHome()" id="btnHome">ğŸ  é¦–é¡µ</button>
            <button class="neon-button secondary" onclick="handleSwitchAccount()" id="btnSwitchAccount">ğŸ”„ åˆ‡æ¢è´¦å·</button>
            <button class="neon-button secondary" onclick="handleSwitchKey()" id="btnSwitchKey">ğŸ”‘ åˆ‡æ¢ç§˜é’¥</button>
        </div>

        <div id="statusMessage" class="neon-status">è¯·å…ˆè¾“å…¥ç§˜é’¥éªŒè¯</div>

        <!-- ç®¡ç†å‘˜é€‰æ‹©ç•Œé¢ -->
        <div id="adminChoice" style="display: none;">
            <div class="neon-hint" id="adminChoiceHint">è¯·é€‰æ‹©æ‚¨è¦è¿›å…¥çš„æ¨¡å¼</div>
            <button class="neon-button" onclick="enterAdminPanel()" id="btnEnterAdmin">è¿›å…¥ç®¡ç†å‘˜é¢æ¿</button>
            <button class="neon-button secondary" onclick="enterUserPanel()" id="btnEnterUser">è¿›å…¥ç”¨æˆ·åŠŸèƒ½</button>
        </div>

        <!-- ç§˜é’¥éªŒè¯éƒ¨åˆ† -->
        <div id="keyForm">
            <div class="neon-hint" id="keyHint">ç§˜é’¥è¯·å¿«æ‰‹æœç´¢cpmå­£ä¼¯å¸¸è·å–ï¼Œæˆ–é—²é±¼è´­ä¹°</div>
            <input type="text" id="accessKey" class="neon-input" placeholder="è¾“å…¥è®¿é—®ç§˜é’¥" maxlength="15">
            <div id="bindInfo" class="neon-bind-info" style="display: none;"></div>
            <button class="neon-button" onclick="handleCheckKey()" id="btnCheckKey">éªŒè¯ç§˜é’¥</button>
        </div>

        <!-- ç™»å½•éƒ¨åˆ† -->
        <div id="loginForm" style="display: none;">
            <div id="expiryDisplay" class="neon-expiry"></div>
            <input type="email" id="email" class="neon-input" placeholder="è¾“å…¥æ‚¨çš„é‚®ç®±">
            <input type="password" id="password" class="neon-input" placeholder="è¾“å…¥æ‚¨çš„å¯†ç ">
            <button class="neon-button" onclick="handleLogin()" id="btnLogin">ç™»å½•</button>
        </div>

        <!-- åŠŸèƒ½èœå• -->
        <div id="menuButtons" style="display: none;">
            <button class="neon-button secondary" onclick="switchToAdminPanel()" id="btnToAdminPanel">ğŸ”‘ åˆ‡æ¢åˆ°ç®¡ç†å‘˜é¢æ¿</button>
            <button class="neon-button" onclick="handleKingRank()" id="btnKingRank">ä¸€é”®ä¿®æ”¹ä¸ºå›½ç‹ç­‰çº§</button>
            <button class="neon-button secondary" id="btnChangeEmail" onclick="handleChangeEmail()">ä¿®æ”¹é‚®ç®±</button>
            <button class="neon-button secondary" id="btnChangePassword" onclick="handleChangePassword()">ä¿®æ”¹å¯†ç </button>
            <button class="neon-button secondary" onclick="switchTab('clone')">ğŸ”§ åˆ‡æ¢åˆ°CPMå…‹éš†</button>
        </div>
    </div>

    <!-- CPMå…‹éš†å·¥å…·æ ‡ç­¾ -->
    <div id="clone-tab" class="tab-content">
        <div class="clone-card" id="clone-tab-content">
            <h2 class="neon-title"><i class="fas fa-clone"></i> CPMCYå…‹éš†å·¥å…·</h2>
            
            <!-- è´¦å·ä¿¡æ¯å±•ç¤ºåŒº -->
            <div class="account-details-grid hidden" id="account-info-section-clone">
                <div class="info-box">
                    <span class="info-label">è´¦å·æ˜µç§°:</span>
                    <span class="info-value glow-text" id="account-name">--</span>
                </div>
                <div class="info-box">
                    <span class="info-label">æ¸¸æˆé‡‘å¸:</span>
                    <span class="info-value glow-text" id="account-money">--</span>
                </div>
                <div class="info-box">
                    <span class="info-label">è½¦è¾†æ•°é‡:</span>
                    <span class="info-value glow-text" id="account-cars">--</span>
                </div>
                <div class="info-box">
                    <span class="info-label">Local ID:</span>
                    <span class="info-value glow-text" id="account-localid">--</span>
                </div>
                <div class="info-box">
                    <span class="info-label">è´¦å·çŠ¶æ€:</span>
                    <span class="info-value status-badge glow-text" id="account-status">æœªç™»å½•</span>
                </div>
            </div>
            
            <button id="logout-btn-clone" class="neon-button secondary" style="display: none;">
                <i class="fas fa-sign-out-alt"></i> é€€å‡ºç™»å½•
            </button>

            <!-- ç™»å½•éƒ¨åˆ† -->
            <div id="login-section-clone">
                <h3><i class="fas fa-sign-in-alt"></i> ç¬¬ä¸€æ­¥ï¼šæºè´¦å·ç™»å½•</h3>
                <p class="neon-hint">è¯·ç™»å½•è¦è¢«å…‹éš†çš„æºè´¦å·ï¼ˆä½ çš„ä¸»è´¦å·ï¼‰</p>
                <div class="form-group">
                    <input type="email" id="source-email" class="neon-input" placeholder="è¾“å…¥CPMè´¦å·é‚®ç®±" required>
                </div>
                <div class="form-group">
                    <input type="password" id="source-password" class="neon-input" placeholder="è¾“å…¥CPMè´¦å·å¯†ç " required>
                </div>
                <button id="login-btn-clone" class="neon-button success">
                    <i class="fas fa-key"></i> ç™»å½•å¹¶éªŒè¯è´¦å·
                </button>
                <div id="login-status" class="neon-status" style="display: none;"></div>
            </div>

            <!-- å…‹éš†éƒ¨åˆ† -->
            <div id="clone-section-clone" class="hidden">
                <h3><i class="fas fa-clone"></i> ç¬¬äºŒæ­¥ï¼šé€‰æ‹©æ“ä½œç±»å‹</h3>
                
                <!-- æ“ä½œç±»å‹é€‰æ‹© -->
                <div class="operation-options">
                    <div class="option-item">
                        <input type="radio" id="op-type1" name="operation-type" value="modify-id" checked>
                        <label for="op-type1">
                            <strong>é€‰é¡¹1ï¼šä¿®æ”¹å½“å‰è´¦å·ID</strong><br>
                            <small>ä»…ä¿®æ”¹å½“å‰ç™»å½•è´¦å·çš„Local IDï¼Œå…¶ä»–æ•°æ®ä¸å˜</small>
                        </label>
                    </div>
                    <div class="option-item">
                        <input type="radio" id="op-type2" name="operation-type" value="clone-to-new">
                        <label for="op-type2">
                            <strong>é€‰é¡¹2ï¼šå…‹éš†åˆ°æ–°è´¦å·</strong><br>
                            <small>å¤åˆ¶å½“å‰è´¦å·æ‰€æœ‰æ•°æ®åˆ°å¦ä¸€ä¸ªè´¦å·ï¼ˆè¦†ç›–ç›®æ ‡è´¦å·ï¼‰</small>
                        </label>
                    </div>
                </div>
                
                <!-- è‡ªå®šä¹‰Local IDè¾“å…¥æ¡† -->
                <div class="form-group" id="custom-id-group">
                    <input type="text" id="custom-localid" class="neon-input" placeholder="è¾“å…¥æ–°çš„Local IDï¼ˆå­—æ¯æ•°å­—ï¼Œå»ºè®®10-20ä½ï¼‰" required>
                </div>
                
                <!-- ç›®æ ‡è´¦å·å‡­æ®éƒ¨åˆ†ï¼ˆåªåœ¨é€‰é¡¹2æ—¶æ˜¾ç¤ºï¼‰ -->
                <div id="target-credentials" class="hidden">
                    <div class="form-group">
                        <input type="email" id="target-email" class="neon-input" placeholder="è¾“å…¥ç›®æ ‡è´¦å·é‚®ç®±">
                    </div>
                    <div class="form-group">
                        <input type="password" id="target-password" class="neon-input" placeholder="è¾“å…¥ç›®æ ‡è´¦å·å¯†ç ">
                    </div>
                </div>
                
                <div class="warning-box">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>è­¦å‘Šï¼š</strong> è¿™å°†è¦†ç›–ç›®æ ‡è´¦å·çš„æ‰€æœ‰æ•°æ®ï¼è¯·è°¨æ…æ“ä½œï¼
                </div>
                
                <div class="time-warning-box">
                    <i class="fas fa-clock"></i>
                    <strong>æ³¨æ„ï¼š</strong> å…‹éš†è¿‡ç¨‹å¯èƒ½éœ€è¦2-5åˆ†é’Ÿï¼Œè¯·å‹¿å…³é—­é¡µé¢ï¼
                </div>
                
                <button id="clone-btn-clone" class="neon-button destructive">
                    <i class="fas fa-clone"></i> å¼€å§‹æ‰§è¡Œ
                </button>
                <div id="clone-status" class="neon-status" style="display: none;"></div>
            </div>

            <!-- çŠ¶æ€æ˜¾ç¤ºéƒ¨åˆ† -->
            <div id="status-section-clone">
                <h3><i class="fas fa-info-circle"></i> å…‹éš†è¿›åº¦çŠ¶æ€</h3>
                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar"></div>
                    <div class="progress-text" id="progress-text">å‡†å¤‡å¼€å§‹...</div>
                </div>
                <div class="status-log" id="status-log">
                    <div class="log-entry"><i class="fas fa-info-circle"></i> ç³»ç»Ÿå·²å°±ç»ªï¼Œè¯·å…ˆç™»å½•æºè´¦å·</div>
                </div>
            </div>

            <!-- è¯´æ˜éƒ¨åˆ† -->
            <div class="note-box">
                <i class="fas fa-lightbulb"></i>
                <strong>æç¤ºï¼š</strong> å…‹éš†æ—¶é—´å–å†³äºè½¦è¾†æ•°é‡ï¼Œé€šå¸¸éœ€è¦2-5åˆ†é’Ÿã€‚
            </div>
        </div>
    </div>

    <!-- ç®¡ç†å‘˜é¢æ¿æ ‡ç­¾ -->
    <div id="admin-tab" class="tab-content">
        <div id="adminPanel" class="neon-admin-panel">
            <h4 class="neon-admin-title" id="adminTitle">
                ğŸ”‘ ç§˜é’¥ç®¡ç†ä¸­å¿ƒ ğŸ”‘
                <span id="adminLevelBadge" class="admin-level-badge"></span>
            </h4>

            <!-- ç®¡ç†å‘˜åŠŸèƒ½åˆ‡æ¢æŒ‰é’® -->
            <button class="neon-button secondary" onclick="switchToUserFunctions()" id="btnToUserFunctions">ğŸ® åˆ‡æ¢åˆ°åŠŸèƒ½é¡µé¢</button>
            <button class="neon-button secondary" onclick="handleReturnToKeyForm()" id="btnReturnToKeyForm">ğŸ”™ è¿”å›éªŒè¯ç§˜é’¥</button>

            <div class="add-key-form">
                <!-- ç§˜é’¥ç±»å‹é€‰æ‹© -->
                <div class="key-type-options" id="keyTypeOptions">
                    <div class="key-type-option" onclick="selectKeyType('test')">
                        <input type="radio" name="keyType" id="keyTypeTest" value="test">
                        <div class="key-type-label">
                            <div class="key-type-title">
                                æµ‹è¯•å¡
                                <span class="key-type-badge test-badge">ä»…æˆå°±</span>
                            </div>
                            <div class="key-type-desc" id="testCardInfo">1å°æ—¶æœ‰æ•ˆæœŸï¼Œä»…é™1ä¸ªè´¦å·ï¼Œä»…æ”¯æŒè§£é”æˆå°±åŠŸèƒ½</div>
                        </div>
                    </div>
                    
                    <div class="key-type-option" onclick="selectKeyType('password')">
                        <input type="radio" name="keyType" id="keyTypePassword" value="password">
                        <div class="key-type-label">
                            <div class="key-type-title">
                                æ”¹å¯†å¡
                                <span class="key-type-badge password-badge">ä»…æ”¹å¯†</span>
                            </div>
                            <div class="key-type-desc" id="passwordCardInfo">1å°æ—¶æœ‰æ•ˆæœŸï¼Œä»…é™1ä¸ªè´¦å·ï¼Œä»…æ”¯æŒä¿®æ”¹å¯†ç åŠŸèƒ½</div>
                        </div>
                    </div>
                    
                    <div class="key-type-option" onclick="selectKeyType('full')">
                        <input type="radio" name="keyType" id="keyTypeFull" value="full" checked>
                        <div class="key-type-label">
                            <div class="key-type-title">
                                å…¨åŠŸèƒ½å¡
                                <span class="key-type-badge full-badge">å…¨åŠŸèƒ½</span>
                            </div>
                            <div class="key-type-desc" id="fullCardInfo">æ”¯æŒæ‰€æœ‰åŠŸèƒ½ï¼Œå¯è‡ªå®šä¹‰æ—¶é•¿å’Œç»‘å®šæ•°é‡</div>
                        </div>
                    </div>
                </div>

                <!-- å…¨åŠŸèƒ½å¡é€‰é¡¹ -->
                <div id="fullFeatureOptions" class="full-feature-options">
                    <div style="margin-bottom: 16px;">
                        <label for="newKeyDuration" style="display: block; margin-bottom: 8px; font-weight: 500; color: white; font-size: 14px;">
                            â° è®¾ç½®ç§˜é’¥æ—¶é•¿ï¼ˆå•ä½ï¼šå°æ—¶ï¼‰
                            <span style="font-size: 12px; color: rgba(255, 255, 255, 0.7);">è¯·è¾“å…¥ç§˜é’¥çš„æœ‰æ•ˆå°æ—¶æ•°ï¼Œä¾‹å¦‚ï¼š30å¤©å°±è¾“å…¥720</span>
                        </label>
                        <input type="number" id="newKeyDuration" class="neon-input" placeholder="ä¾‹å¦‚ï¼š720å°æ—¶ï¼ˆ30å¤©ï¼‰" value="24" min="1">
                    </div>
                    
                    <div style="margin-bottom: 16px;">
                        <label for="newKeyMaxBind" style="display: block; margin-bottom: 8px; font-weight: 500; color: white; font-size: 14px;">
                            ğŸ‘¥ ç»‘å®šè´¦å·ä¸Šé™
                            <span style="font-size: 12px; color: rgba(255, 255, 255, 0.7);">æœ€å¤šå…è®¸ç»‘å®šçš„è´¦å·æ•°é‡ï¼Œä¾‹å¦‚ï¼šæœ€å¤šç»‘å®š5ä¸ªè´¦å·å°±è¾“å…¥5</span>
                        </label>
                        <input type="number" id="newKeyMaxBind" class="neon-input" placeholder="ä¾‹å¦‚ï¼šæœ€å¤šç»‘å®š3ä¸ªè´¦å·å°±è¾“å…¥3" value="3" min="1">
                    </div>
                </div>
                
                <input type="text" id="newKeyRemark" class="neon-input" placeholder="å¤‡æ³¨ (å¦‚: æœˆå¡/æµ‹è¯•å¡/æ”¹å¯†å¡)">
                <button class="neon-button success" onclick="handleAddKey()" id="btnAddKey">â• ç”Ÿæˆæ–°ç§˜é’¥</button>
            </div>

            <div class="neon-nav-buttons">
                <button class="neon-button secondary" onclick="fetchKeys()" id="btnRefresh">ğŸ”„ åˆ·æ–°åˆ—è¡¨</button>
                <button class="neon-button" onclick="handleCleanupExpiredKeys()" id="btnCleanup">ğŸ—‘ï¸ æ¸…ç†è¿‡æœŸ</button>
            </div>

            <div class="neon-table-container">
                <!-- ç§˜é’¥åˆ—è¡¨ -->
                <div class="key-category" id="tgCategory">
                    <div class="category-summary">
                        <span>ğŸ¤– ç§˜é’¥åˆ—è¡¨</span>
                        <span class="key-count" id="tgKeyCount">(0)</span>
                    </div>
                    <table class="neon-table">
                        <thead>
                            <tr>
                                <th>ç§˜é’¥</th>
                                <th>å¤‡æ³¨</th>
                                <th>åˆ°æœŸæ—¶é—´</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="tgKeysTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- é¦–é¡µæ¨å¹¿ä¿¡æ¯ -->
<div class="home-promotion" id="homePromotion">
    <div class="promotion-header">
        <div class="promotion-title" id="promotionTitle">ä»€ä¹ˆï¼Ÿä½ è¿˜ä¸çŸ¥é“ç§˜é’¥æ‰¾è°ä¹°ï¼Ÿ</div>
        <div class="promotion-subtitle" id="promotionHint">é—²é±¼æœç´¢ï¼šcpmå­£ä¼¯å¸¸ æˆ–ç›´æ¥ç‚¹å‡»ä¸‹æ–¹é“¾æ¥</div>
    </div>
    <div class="promotion-links">
        <a href="https://m.tb.cn/h.704soJF?tk=rkUYfJkWvew" class="promotion-link xianyu" target="_blank">
            <i class="fas fa-shopping-cart"></i>
            é—²é±¼è´­ä¹°ç§˜é’¥
        </a>
        <a href="https://v.kuaishou.com/nVgbtpVy" class="promotion-link kuaishou" target="_blank">
            <i class="fas fa-video"></i>
            å¿«æ‰‹è”ç³»è€å­£
        </a>
    </div>
</div>

<!-- æ—¥å¿—åŒºåŸŸ -->
<div class="neon-log-container">
    <div class="neon-log-title" id="logTitle">æ“ä½œæ—¥å¿—</div>
    <div id="logHistory">
        <div class="neon-log-item log-info" id="systemLoaded">ç³»ç»Ÿï¼šé¡µé¢åŠ è½½å®Œæ¯•ã€‚</div>
    </div>
</div>

<!-- è´¦å·è¯¦æƒ…æ¨¡æ€æ¡† -->
<div id="accountModal" class="neon-modal">
    <div class="neon-modal-content">
        <h3 class="neon-modal-title" id="modalAccountTitle">è´¦å·è¯¦æƒ…</h3>
        <div id="accountDetails"></div>
        <button class="neon-button" onclick="closeAccountModal()" style="margin-top: 16px;" id="btnCloseModal">å…³é—­</button>
    </div>
</div>

<script>
    // ç¬¬ä¸€ä¸ªé¡µé¢çš„æ‰€æœ‰JavaScriptä»£ç 
    // åŸºç¡€é…ç½®
    const API_BASE_URL = '/api';
    const SUPER_ADMIN_KEY = 'woinjbc';

    // å¤šè¯­è¨€æ”¯æŒ
    const translations = {
        'zh-CN': {
            'pageTitle': 'å­£ä¼¯å¸¸å·¥å…·å¹³å° V3.0',
            'promotionTitle': 'ä»€ä¹ˆï¼Ÿä½ è¿˜ä¸çŸ¥é“ç§˜é’¥æ‰¾è°ä¹°ï¼Ÿ',
            'promotionHint': 'é—²é±¼æœç´¢ï¼šcpmå­£ä¼¯å¸¸ æˆ–ç›´æ¥ç‚¹å‡»ä¸‹æ–¹é“¾æ¥',
            'keyHint': 'ç§˜é’¥è¯·å¿«æ‰‹æœç´¢cpmå­£ä¼¯å¸¸è·å–ï¼Œæˆ–é—²é±¼è´­ä¹°',
            'btnCheckKey': 'éªŒè¯ç§˜é’¥',
            'btnLogin': 'ç™»å½•',
            'btnKingRank': 'ä¸€é”®ä¿®æ”¹ä¸ºå›½ç‹ç­‰çº§',
            'btnChangeEmail': 'ä¿®æ”¹é‚®ç®±',
            'btnChangePassword': 'ä¿®æ”¹å¯†ç ',
            'btnToggleAdmin': 'åˆ‡æ¢ç®¡ç†å‘˜æ¨¡å¼',
            'btnHome': 'ğŸ  é¦–é¡µ',
            'btnSwitchAccount': 'ğŸ”„ åˆ‡æ¢è´¦å·',
            'btnSwitchKey': 'ğŸ”‘ åˆ‡æ¢ç§˜é’¥',
            'adminTitle': 'ğŸ”‘ ç§˜é’¥ç®¡ç†ä¸­å¿ƒ ğŸ”‘',
            'testCardInfo': '1å°æ—¶æœ‰æ•ˆæœŸï¼Œä»…é™1ä¸ªè´¦å·ï¼Œä»…æ”¯æŒè§£é”æˆå°±åŠŸèƒ½',
            'passwordCardInfo': '1å°æ—¶æœ‰æ•ˆæœŸï¼Œä»…é™1ä¸ªè´¦å·ï¼Œä»…æ”¯æŒä¿®æ”¹å¯†ç åŠŸèƒ½',
            'fullCardInfo': 'æ”¯æŒæ‰€æœ‰åŠŸèƒ½ï¼Œå¯è‡ªå®šä¹‰æ—¶é•¿å’Œç»‘å®šæ•°é‡',
            'btnAddKey': 'â• ç”Ÿæˆæ–°ç§˜é’¥',
            'btnRefresh': 'ğŸ”„ åˆ·æ–°åˆ—è¡¨',
            'btnCleanup': 'ğŸ—‘ï¸ æ¸…ç†è¿‡æœŸ',
            'thKey': 'ç§˜é’¥',
            'thRemark': 'å¤‡æ³¨',
            'thExpiry': 'åˆ°æœŸæ—¶é—´',
            'thAction': 'æ“ä½œ',
            'logTitle': 'æ“ä½œæ—¥å¿—',
            'systemLoaded': 'ç³»ç»Ÿï¼šé¡µé¢åŠ è½½å®Œæ¯•ã€‚',
            'modalAccountTitle': 'è´¦å·è¯¦æƒ…',
            'btnCloseModal': 'å…³é—­',
            'testCardBadge': 'æµ‹è¯•å¡',
            'passwordCardBadge': 'æ”¹å¯†å¡',
            'testCardStatus': 'æµ‹è¯•å¡ç”¨æˆ·',
            'passwordCardStatus': 'æ”¹å¯†å¡ç”¨æˆ·',
            'testCardEmailWarning': 'æµ‹è¯•å¡ä¸æ”¯æŒä¿®æ”¹é‚®ç®±åŠŸèƒ½ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ä»˜è´¹ä½¿ç”¨å®Œæ•´åŠŸèƒ½ï¼',
            'testCardPasswordWarning': 'æµ‹è¯•å¡ä¸æ”¯æŒä¿®æ”¹å¯†ç åŠŸèƒ½ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ä»˜è´¹ä½¿ç”¨å®Œæ•´åŠŸèƒ½ï¼',
            'passwordCardKingWarning': 'æ”¹å¯†å¡ä¸æ”¯æŒå›½ç‹ç­‰çº§åŠŸèƒ½ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ä»˜è´¹ä½¿ç”¨å®Œæ•´åŠŸèƒ½ï¼',
            'passwordCardEmailWarning': 'æ”¹å¯†å¡ä¸æ”¯æŒä¿®æ”¹é‚®ç®±åŠŸèƒ½ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ä»˜è´¹ä½¿ç”¨å®Œæ•´åŠŸèƒ½ï¼',
            'superAdmin': 'è¶…çº§ç®¡ç†å‘˜',
            'normalAdmin': 'æ™®é€šç®¡ç†å‘˜',
            'adminChoiceHint': 'è¯·é€‰æ‹©æ‚¨è¦è¿›å…¥çš„æ¨¡å¼',
            'btnEnterAdmin': 'è¿›å…¥ç®¡ç†å‘˜é¢æ¿',
            'btnEnterUser': 'è¿›å…¥ç”¨æˆ·åŠŸèƒ½',
            'btnToAdminPanel': 'ğŸ”‘ åˆ‡æ¢åˆ°ç®¡ç†å‘˜é¢æ¿',
            'btnToUserFunctions': 'ğŸ® åˆ‡æ¢åˆ°åŠŸèƒ½é¡µé¢',
            'btnReturnToKeyForm': 'ğŸ”™ è¿”å›éªŒè¯ç§˜é’¥'
        },
        'zh-TW': {
            'pageTitle': 'å­£ä¼¯å¸¸å·¥å…·å¹³å° V3.0',
            'promotionTitle': 'ä»€éº¼ï¼Ÿä½ é‚„ä¸çŸ¥é“ç§˜é‘°æ‰¾èª°è²·ï¼Ÿ',
            'promotionHint': 'é–’é­šæœç´¢ï¼šcpmå­£ä¼¯å¸¸ æˆ–ç›´æ¥é»æ“Šä¸‹æ–¹é€£çµ',
            'keyHint': 'ç§˜é‘°è«‹å¿«æ‰‹æœç´¢cpmå­£ä¼¯å¸¸ç²å–ï¼Œæˆ–é–’é­šè³¼è²·',
            'btnCheckKey': 'é©—è­‰ç§˜é‘°',
            'btnLogin': 'ç™»éŒ„',
            'btnKingRank': 'ä¸€éµä¿®æ”¹ç‚ºåœ‹ç‹ç­‰ç´š',
            'btnChangeEmail': 'ä¿®æ”¹éƒµç®±',
            'btnChangePassword': 'ä¿®æ”¹å¯†ç¢¼',
            'btnToggleAdmin': 'åˆ‡æ›ç®¡ç†å“¡æ¨¡å¼',
            'btnHome': 'ğŸ  é¦–é ',
            'btnSwitchAccount': 'ğŸ”„ åˆ‡æ›è³¬è™Ÿ',
            'btnSwitchKey': 'ğŸ”‘ åˆ‡æ›ç§˜é‘°',
            'adminTitle': 'ğŸ”‘ ç§˜é‘°ç®¡ç†ä¸­å¿ƒ ğŸ”‘',
            'testCardInfo': '1å°æ™‚æœ‰æ•ˆæœŸï¼Œåƒ…é™1å€‹è³¬è™Ÿï¼Œåƒ…æ”¯æŒè§£é–æˆå°±åŠŸèƒ½',
            'passwordCardInfo': '1å°æ™‚æœ‰æ•ˆæœŸï¼Œåƒ…é™1å€‹è³¬è™Ÿï¼Œåƒ…æ”¯æŒä¿®æ”¹å¯†ç¢¼åŠŸèƒ½',
            'fullCardInfo': 'æ”¯æŒæ‰€æœ‰åŠŸèƒ½ï¼Œå¯è‡ªå®šç¾©æ™‚é•·å’Œç¶å®šæ•¸é‡',
            'btnAddKey': 'â• ç”Ÿæˆæ–°ç§˜é‘°',
            'btnRefresh': 'ğŸ”„ åˆ·æ–°åˆ—è¡¨',
            'btnCleanup': 'ğŸ—‘ï¸ æ¸…ç†éæœŸ',
            'thKey': 'ç§˜é‘°',
            'thRemark': 'å‚™è¨»',
            'thExpiry': 'åˆ°æœŸæ™‚é–“',
            'thAction': 'æ“ä½œ',
            'logTitle': 'æ“ä½œæ—¥èªŒ',
            'systemLoaded': 'ç³»çµ±ï¼šé é¢åŠ è¼‰å®Œç•¢ã€‚',
            'modalAccountTitle': 'è³¬è™Ÿè©³æƒ…',
            'btnCloseModal': 'é—œé–‰',
            'testCardBadge': 'æ¸¬è©¦å¡',
            'passwordCardBadge': 'æ”¹å¯†å¡',
            'testCardStatus': 'æ¸¬è©¦å¡ç”¨æˆ¶',
            'passwordCardStatus': 'æ”¹å¯†å¡ç”¨æˆ¶',
            'testCardEmailWarning': 'æ¸¬è©¦å¡ä¸æ”¯æŒä¿®æ”¹éƒµç®±åŠŸèƒ½ï¼Œè«‹è¯ç¹«ç®¡ç†å“¡ä»˜è²»ä½¿ç”¨å®Œæ•´åŠŸèƒ½ï¼',
            'testCardPasswordWarning': 'æ¸¬è©¦å¡ä¸æ”¯æŒä¿®æ”¹å¯†ç¢¼åŠŸèƒ½ï¼Œè«‹è¯ç¹«ç®¡ç†å“¡ä»˜è²»ä½¿ç”¨å®Œæ•´åŠŸèƒ½ï¼',
            'passwordCardKingWarning': 'æ”¹å¯†å¡ä¸æ”¯æŒåœ‹ç‹ç­‰ç´šåŠŸèƒ½ï¼Œè«‹è¯ç¹«ç®¡ç†å“¡ä»˜è²»ä½¿ç”¨å®Œæ•´åŠŸèƒ½ï¼',
            'passwordCardEmailWarning': 'æ”¹å¯†å¡ä¸æ”¯æŒä¿®æ”¹éƒµç®±åŠŸèƒ½ï¼Œè«‹è¯ç¹«ç®¡ç†å“¡ä»˜è³‡ä½¿ç”¨å®Œæ•´åŠŸèƒ½ï¼',
            'superAdmin': 'è¶…ç´šç®¡ç†å“¡',
            'normalAdmin': 'æ™®é€šç®¡ç†å“¡',
            'adminChoiceHint': 'è«‹é¸æ“‡æ‚¨è¦é€²å…¥çš„æ¨¡å¼',
            'btnEnterAdmin': 'é€²å…¥ç®¡ç†å“¡é¢æ¿',
            'btnEnterUser': 'é€²å…¥ç”¨æˆ¶åŠŸèƒ½',
            'btnToAdminPanel': 'ğŸ”‘ åˆ‡æ›åˆ°ç®¡ç†å“¡é¢æ¿',
            'btnToUserFunctions': 'ğŸ® åˆ‡æ›åˆ°åŠŸèƒ½é é¢',
            'btnReturnToKeyForm': 'ğŸ”™ è¿”å›é©—è­‰ç§˜é‘°'
        },
        'en': {
            'pageTitle': 'Ji Bochang Tool Platform V3.0',
            'promotionTitle': 'What? You dont know where to buy keys?',
            'promotionHint': 'Search cpmå­£ä¼¯å¸¸ on Xianyu or click below',
            'keyHint': 'Get key by searching cpmå­£ä¼¯å¸¸ on Kwai or buy on Xianyu',
            'btnCheckKey': 'Verify Key',
            'btnLogin': 'Login',
            'btnKingRank': 'Set King Rank',
            'btnChangeEmail': 'Change Email',
            'btnChangePassword': 'Change Password',
            'btnToggleAdmin': 'Toggle Admin Mode',
            'btnHome': 'ğŸ  Home',
            'btnSwitchAccount': 'ğŸ”„ Switch Account',
            'btnSwitchKey': 'ğŸ”‘ Switch Key',
            'adminTitle': 'ğŸ”‘ Key Management Center ğŸ”‘',
            'testCardInfo': '1 hour validity, 1 account only, unlock achievement only',
            'passwordCardInfo': '1 hour validity, 1 account only, password change only',
            'fullCardInfo': 'All functions, customizable duration and bind count',
            'btnAddKey': 'â• Generate New Key',
            'btnRefresh': 'ğŸ”„ Refresh List',
            'btnCleanup': 'ğŸ—‘ï¸ Clean Expired',
            'thKey': 'Key',
            'thRemark': 'Remark',
            'thExpiry': 'Expiry Time',
            'thAction': 'Action',
            'logTitle': 'Operation Log',
            'systemLoaded': 'System: Page loaded successfully.',
            'modalAccountTitle': 'Account Details',
            'btnCloseModal': 'Close',
            'testCardBadge': 'Test Card',
            'passwordCardBadge': 'Password Card',
            'testCardStatus': 'Test Card User',
            'passwordCardStatus': 'Password Card User',
            'testCardEmailWarning': 'Test card does not support email change. Please contact admin for paid full features!',
            'testCardPasswordWarning': 'Test card does not support password change. Please contact admin for paid full features!',
            'passwordCardKingWarning': 'Password card does not support king rank. Please contact admin for paid full features!',
            'passwordCardEmailWarning': 'Password card does not support email change. Please contact admin for paid full features!',
            'superAdmin': 'Super Admin',
            'normalAdmin': 'Normal Admin',
            'adminChoiceHint': 'Please select the mode you want to enter',
            'btnEnterAdmin': 'Enter Admin Panel',
            'btnEnterUser': 'Enter User Functions',
            'btnToAdminPanel': 'ğŸ”‘ Switch to Admin Panel',
            'btnToUserFunctions': 'ğŸ® Switch to Functions',
            'btnReturnToKeyForm': 'ğŸ”™ Return to Key Verification'
        }
    };

    // å½“å‰è¯­è¨€
    let currentLanguage = 'zh-CN';

    // çŠ¶æ€å˜é‡
    let currentKey = null;
    let currentToken = null;
    let currentExpiryTime = null;
    let currentUser = null;
    let isAdminMode = false;
    let isSuperAdmin = false;
    let currentBindInfo = null;
    let isTestCard = false;
    let isPasswordCard = false;

    // æ ‡ç­¾åˆ‡æ¢åŠŸèƒ½
    function switchTab(tabName) {
        // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        
        // æ›´æ–°æ ‡ç­¾æŒ‰é’®çŠ¶æ€
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾
        document.getElementById(tabName + '-tab').classList.add('active');
        event.target.classList.add('active');
        
        // è®°å½•å½“å‰æ ‡ç­¾
        localStorage.setItem('currentTab', tabName);
    }

    // é¡µé¢åŠ è½½æ—¶æ¢å¤æ ‡ç­¾çŠ¶æ€
    document.addEventListener('DOMContentLoaded', function() {
        const savedTab = localStorage.getItem('currentTab');
        if (savedTab) {
            switchTab(savedTab);
        }
    });

    // =================================================================
    // å¤šè¯­è¨€åŠŸèƒ½
    // =================================================================

    function changeLanguage(lang) {
        currentLanguage = lang;
        applyTranslations();
        logAction("è¯­è¨€åˆ‡æ¢", `åˆ‡æ¢åˆ° ${getLanguageName(lang)}`, 'info');
    }

    function getLanguageName(code) {
        const names = {
            'zh-CN': 'ä¸­æ–‡ç®€ä½“',
            'zh-TW': 'ä¸­æ–‡ç¹é«”',
            'en': 'English'
        };
        return names[code] || code;
    }

    function applyTranslations() {
        const langData = translations[currentLanguage];
        
        Object.keys(langData).forEach(key => {
            const element = document.getElementById(key);
            if (element && !(key === 'systemLoaded' && element.parentElement.id === 'logHistory')) {
                element.textContent = langData[key];
            }
        });

        // æ›´æ–°è¾“å…¥æ¡†placeholder
        document.getElementById('accessKey').placeholder = currentLanguage === 'zh-CN' ? 'è¾“å…¥è®¿é—®ç§˜é’¥' : 
                                                         currentLanguage === 'zh-TW' ? 'è¼¸å…¥è¨ªå•ç§˜é‘°' : 'Enter access key';
        
        document.getElementById('email').placeholder = currentLanguage === 'zh-CN' ? 'è¾“å…¥æ‚¨çš„é‚®ç®±' : 
                                                     currentLanguage === 'zh-TW' ? 'è¼¸å…¥æ‚¨çš„éƒµç®±' : 'Enter your email';
        
        document.getElementById('password').placeholder = currentLanguage === 'zh-CN' ? 'è¾“å…¥æ‚¨çš„å¯†ç ' : 
                                                        currentLanguage === 'zh-TW' ? 'è¼¸å…¥æ‚¨çš„å¯†ç¢¼' : 'Enter your password';
        
        document.getElementById('newKeyDuration').placeholder = currentLanguage === 'zh-CN' ? 'ä¾‹å¦‚ï¼š720å°æ—¶ï¼ˆ30å¤©ï¼‰' : 
                                                              currentLanguage === 'zh-TW' ? 'ä¾‹å¦‚ï¼š720å°æ™‚ï¼ˆ30å¤©ï¼‰' : 'e.g.: 720 hours (30 days)';
        
        document.getElementById('newKeyMaxBind').placeholder = currentLanguage === 'zh-CN' ? 'ä¾‹å¦‚ï¼šæœ€å¤šç»‘å®š3ä¸ªè´¦å·å°±è¾“å…¥3' : 
                                                             currentLanguage === 'zh-TW' ? 'ä¾‹å¦‚ï¼šæœ€å¤šç¶å®š3å€‹è³¬è™Ÿå°±è¼¸å…¥3' : 'e.g.: Enter 3 for max 3 accounts';
        
        document.getElementById('newKeyRemark').placeholder = currentLanguage === 'zh-CN' ? 'å¤‡æ³¨ (å¦‚: æœˆå¡/æµ‹è¯•å¡/æ”¹å¯†å¡)' : 
                                                            currentLanguage === 'zh-TW' ? 'å‚™è¨» (å¦‚: æœˆå¡/æ¸¬è©¦å¡/æ”¹å¯†å¡)' : 'Remark (e.g.: Monthly/Test/Password)';
    }

    // =================================================================
    // ç®¡ç†å‘˜æƒé™ç®¡ç†
    // =================================================================

    function updateAdminUI() {
        const adminLevelBadge = document.getElementById('adminLevelBadge');
        const keyTypeOptions = document.getElementById('keyTypeOptions');
        
        if (isSuperAdmin) {
            adminLevelBadge.textContent = translations[currentLanguage].superAdmin;
            // è¶…çº§ç®¡ç†å‘˜æ˜¾ç¤ºæ‰€æœ‰é€‰é¡¹
            document.querySelectorAll('.key-type-option').forEach(option => {
                option.style.display = 'flex';
            });
        } else {
            adminLevelBadge.textContent = translations[currentLanguage].normalAdmin;
            // æ™®é€šç®¡ç†å‘˜åªèƒ½çœ‹åˆ°æµ‹è¯•å¡å’Œæ”¹å¯†å¡
            document.getElementById('keyTypeTest').parentElement.style.display = 'flex';
            document.getElementById('keyTypePassword').parentElement.style.display = 'flex';
            document.getElementById('keyTypeFull').parentElement.style.display = 'none';
            // é»˜è®¤é€‰æ‹©æµ‹è¯•å¡
            selectKeyType('test');
        }
    }

    // =================================================================
    // ç§˜é’¥ç±»å‹é€‰æ‹©åŠŸèƒ½
    // =================================================================

    function selectKeyType(type) {
        // æ›´æ–°é€‰é¡¹æ ·å¼
        document.querySelectorAll('.key-type-option').forEach(option => {
            option.classList.remove('selected');
        });
        
        const selectedOption = document.querySelector(`.key-type-option input[value="${type}"]`).parentElement;
        selectedOption.classList.add('selected');
        
        // æ›´æ–°å•é€‰æŒ‰é’®çŠ¶æ€
        document.getElementById(`keyType${type.charAt(0).toUpperCase() + type.slice(1)}`).checked = true;
        
        // æ˜¾ç¤º/éšè—å…¨åŠŸèƒ½é€‰é¡¹
        const fullOptions = document.getElementById('fullFeatureOptions');
        if (type === 'full') {
            fullOptions.style.display = 'block';
        } else {
            fullOptions.style.display = 'none';
        }
        
        // å¦‚æœæ˜¯æµ‹è¯•å¡æˆ–æ”¹å¯†å¡ï¼Œå›ºå®šå‚æ•°
        if (type === 'test' || type === 'password') {
            document.getElementById('newKeyDuration').value = 1;
            document.getElementById('newKeyMaxBind').value = 1;
        }
    }

    function updateCardStatus(isTest, isPassword) {
        isTestCard = isTest;
        isPasswordCard = isPassword;
        const statusEl = document.getElementById('statusMessage');
        
        if (isTest) {
            statusEl.className = 'neon-status test-card';
            document.getElementById('btnChangeEmail').disabled = true;
            document.getElementById('btnChangePassword').disabled = true;
            document.getElementById('btnChangeEmail').title = translations[currentLanguage].testCardEmailWarning;
            document.getElementById('btnChangePassword').title = translations[currentLanguage].testCardPasswordWarning;
        } else if (isPassword) {
            statusEl.className = 'neon-status password-card';
            document.getElementById('btnKingRank').disabled = true;
            document.getElementById('btnChangeEmail').disabled = true;
            document.getElementById('btnKingRank').title = translations[currentLanguage].passwordCardKingWarning;
            document.getElementById('btnChangeEmail').title = translations[currentLanguage].passwordCardEmailWarning;
        } else {
            statusEl.className = 'neon-status success';
            document.getElementById('btnKingRank').disabled = false;
            document.getElementById('btnChangeEmail').disabled = false;
            document.getElementById('btnChangePassword').disabled = false;
            document.getElementById('btnKingRank').title = '';
            document.getElementById('btnChangeEmail').title = '';
            document.getElementById('btnChangePassword').title = '';
        }
    }

    // =================================================================
    // è¾…åŠ©å‡½æ•°
    // =================================================================

    function logAction(action, message, type) {
        const logHistory = document.getElementById('logHistory');
        const now = new Date().toLocaleTimeString('zh-CN', { hour12: false });
        
        const typeClass = `log-${type}`;
        const logItem = document.createElement('div');
        logItem.className = `neon-log-item ${typeClass}`;
        
        let logContent = `${now} [${action}] `;
        if (isAdminMode) {
             logContent += `(${isSuperAdmin ? 'è¶…çº§ç®¡ç†å‘˜' : 'ç®¡ç†å‘˜'}): `;
        } else if (currentUser) {
            logContent += `(${currentUser}): `;
        } else {
            logContent += `(æ¸¸å®¢): `;
        }
        logContent += message;

        logItem.textContent = logContent;
        
        logHistory.prepend(logItem);

        while (logHistory.children.length > 15) {
            logHistory.removeChild(logHistory.lastChild);
        }
    }

    function updateStatus(message, isError = false) {
        const statusEl = document.getElementById('statusMessage');
        statusEl.textContent = message;
        
        if (isTestCard) {
            statusEl.className = 'neon-status test-card';
        } else if (isPasswordCard) {
            statusEl.className = 'neon-status password-card';
        } else if (isAdminMode) {
            statusEl.className = isSuperAdmin ? 'neon-status super-admin' : 'neon-status admin';
        } else {
            statusEl.className = 'neon-status ' + (isError ? 'error' : 'success');
        }
    }

    function updateBindInfo(bindCount, maxBind, remainingBinds) {
        const bindInfoEl = document.getElementById('bindInfo');
        if (bindCount !== undefined && maxBind !== undefined && remainingBinds !== undefined) {
            const bindText = currentLanguage === 'zh-CN' ? `å½“å‰ç»‘å®š: ${bindCount}/${maxBind} | å‰©ä½™: ${remainingBinds}` :
                           currentLanguage === 'zh-TW' ? `ç•¶å‰ç¶å®š: ${bindCount}/${maxBind} | å‰©é¤˜: ${remainingBinds}` :
                           `Current: ${bindCount}/${maxBind} | Remaining: ${remainingBinds}`;
            bindInfoEl.textContent = bindText;
            bindInfoEl.style.display = 'block';
            
            if (remainingBinds <= 2) {
                bindInfoEl.style.backgroundColor = 'rgba(255, 59, 48, 0.3)';
                bindInfoEl.style.borderColor = 'rgba(255, 59, 48, 0.5)';
                bindInfoEl.style.color = '#FFB6C1';
            } else {
                bindInfoEl.style.backgroundColor = 'rgba(255, 149, 0, 0.3)';
                bindInfoEl.style.borderColor = 'rgba(255, 149, 0, 0.5)';
                bindInfoEl.style.color = 'white';
            }
        } else {
            bindInfoEl.style.display = 'none';
        }
    }

    function switchSection(showId, hideIds) {
        // æ˜¾ç¤ºæŒ‡å®šçš„éƒ¨åˆ†
        document.getElementById(showId).style.display = 'block';
        
        // éšè—å…¶ä»–éƒ¨åˆ†
        hideIds.forEach(id => {
            document.getElementById(id).style.display = 'none';
        });
        
        // æ˜¾ç¤ºå¯¼èˆªæŒ‰é’®
        document.getElementById('navButtons').style.display = 'flex';
        
        // æ§åˆ¶é¦–é¡µæ¨å¹¿ä¿¡æ¯çš„æ˜¾ç¤ºï¼šåªåœ¨keyFormé¡µé¢æ˜¾ç¤º
        const homePromotion = document.getElementById('homePromotion');
        if (showId === 'keyForm') {
            homePromotion.style.display = 'block';
        } else {
            homePromotion.style.display = 'none';
        }
    }

    function checkLogin() {
        if (!currentToken || !currentKey) {
            updateStatus(currentLanguage === 'zh-CN' ? "è¯·å…ˆç™»å½•ï¼" : 
                        currentLanguage === 'zh-TW' ? "è«‹å…ˆç™»éŒ„ï¼" : "Please login first!", true);
            handleLogout(true); 
            return false;
        }
        return true;
    }
    
    function saveAuthToStorage(key, token, expiry, user) {
        localStorage.setItem('accessKey', key);
        localStorage.setItem('idToken', token);
        localStorage.setItem('expiryTime', expiry);
        localStorage.setItem('currentUser', user);
        localStorage.setItem('currentLanguage', currentLanguage);
    }

    function loadAuthFromStorage() {
        currentKey = localStorage.getItem('accessKey');
        currentToken = localStorage.getItem('idToken');
        currentExpiryTime = localStorage.getItem('expiryTime');
        currentUser = localStorage.getItem('currentUser');
        const savedLang = localStorage.getItem('currentLanguage');
        if (savedLang) {
            currentLanguage = savedLang;
            document.getElementById('languageSelect').value = currentLanguage;
            applyTranslations();
        }
        return currentKey && currentToken;
    }

    function updateExpiryDisplay(expiryTime, durationHours, specialTag = null, clear = false) {
        const displayEl = document.getElementById('expiryDisplay');
        if (clear || !expiryTime) {
            displayEl.textContent = '';
            displayEl.className = 'neon-expiry';
            return;
        }
        
        let vipLevel = "";
        
        if (isTestCard) {
            vipLevel = translations[currentLanguage].testCardStatus;
        } else if (isPasswordCard) {
            vipLevel = translations[currentLanguage].passwordCardStatus;
        } else if (specialTag === 'DIAMOND_EXCLUSIVE') {
            vipLevel = "è‡³å°ŠVIP";
        } else if (durationHours !== null) {
            const hours = durationHours;
            
            if (hours >= 365 * 24 * 5) {
                vipLevel = "é’»çŸ³VIP";
            } else if (hours >= 30 * 24) { 
                vipLevel = "é“‚é‡‘VIP";
            } else if (hours >= 7 * 24) { 
                vipLevel = "é»„é‡‘VIP";
            } else if (hours >= 24) {
                vipLevel = "ç™½é“¶VIP";
            } else {
                vipLevel = "é’é“œVIP";
            }
        } else {
            vipLevel = currentLanguage === 'zh-CN' ? "å°Šè´µçš„ç”¨æˆ·" : 
                      currentLanguage === 'zh-TW' ? "å°Šè²´çš„ç”¨æˆ¶" : "Valued User";
        }

        const welcomeText = currentLanguage === 'zh-CN' ? `æ¬¢è¿ç™»å½•ï¼Œ<strong>${vipLevel}</strong>ç”¨æˆ·ï¼` :
                          currentLanguage === 'zh-TW' ? `æ­¡è¿ç™»éŒ„ï¼Œ<strong>${vipLevel}</strong>ç”¨æˆ¶ï¼` :
                          `Welcome, <strong>${vipLevel}</strong>!`;

        // åˆ›å»ºé—ªçƒçš„åˆ°æœŸæ—¶é—´å…ƒç´ 
        let expiryHtml = welcomeText + `<br>`;
        
        if (expiryTime) {
            // æ·»åŠ é—ªçƒæ•ˆæœ
            expiryHtml += `<div class="blinking-expiry">ç§˜é’¥å°†äº ${expiryTime} åˆ°æœŸ</div>`;
        }

        displayEl.innerHTML = expiryHtml;
    }

    // =================================================================
    // ç®¡ç†å‘˜é€‰æ‹©åŠŸèƒ½
    // =================================================================

    function enterAdminPanel() {
        document.getElementById('adminChoice').style.display = 'none';
        document.getElementById('adminPanel').style.display = 'block';
        updateStatus(currentLanguage === 'zh-CN' ? "å·²è¿›å…¥ç®¡ç†å‘˜é¢æ¿" : 
                   currentLanguage === 'zh-TW' ? "å·²é€²å…¥ç®¡ç†å“¡é¢æ¿" : "Entered admin panel", false);
        updateAdminUI();
        fetchKeys();
        logAction("ç®¡ç†å‘˜æ¨¡å¼", "è¿›å…¥ç§˜é’¥ç®¡ç†ä¸­å¿ƒ", 'info');
    }

    function enterUserPanel() {
        document.getElementById('adminChoice').style.display = 'none';
        document.getElementById('loginForm').style.display = 'block';
        updateStatus(currentLanguage === 'zh-CN' ? "è¯·ç™»å½•æ‚¨çš„æ¸¸æˆè´¦å·ä½¿ç”¨åŠŸèƒ½" : 
                   currentLanguage === 'zh-TW' ? "è«‹ç™»éŒ„æ‚¨çš„éŠæˆ²è³¬è™Ÿä½¿ç”¨åŠŸèƒ½" : "Please login with your game account to use functions", false);
        logAction("ç®¡ç†å‘˜æ¨¡å¼", "é€‰æ‹©è¿›å…¥ç”¨æˆ·åŠŸèƒ½", 'info');
    }

    // =================================================================
    // é¡µé¢åˆ‡æ¢åŠŸèƒ½
    // =================================================================

    function switchToUserFunctions() {
        document.getElementById('adminPanel').style.display = 'none';
        document.getElementById('loginForm').style.display = 'block';
        updateStatus(currentLanguage === 'zh-CN' ? "è¯·ç™»å½•æ‚¨çš„æ¸¸æˆè´¦å·ä½¿ç”¨åŠŸèƒ½" : 
                   currentLanguage === 'zh-TW' ? "è«‹ç™»éŒ„æ‚¨çš„éŠæˆ²è³¬è™Ÿä½¿ç”¨åŠŸèƒ½" : "Please login with your game account to use functions", false);
        logAction("é¡µé¢åˆ‡æ¢", "ä»ç®¡ç†å‘˜é¢æ¿åˆ‡æ¢åˆ°åŠŸèƒ½é¡µé¢", 'info');
    }

    function switchToAdminPanel() {
        document.getElementById('menuButtons').style.display = 'none';
        document.getElementById('adminPanel').style.display = 'block';
        updateStatus(currentLanguage === 'zh-CN' ? "å·²è¿›å…¥ç®¡ç†å‘˜é¢æ¿" : 
                   currentLanguage === 'zh-TW' ? "å·²é€²å…¥ç®¡ç†å“¡é¢æ¿" : "Entered admin panel", false);
        updateAdminUI();
        fetchKeys();
        logAction("é¡µé¢åˆ‡æ¢", "ä»åŠŸèƒ½é¡µé¢åˆ‡æ¢åˆ°ç®¡ç†å‘˜é¢æ¿", 'info');
    }

    function handleReturnToKeyForm() {
        handleLogout(true);
        switchSection('keyForm', ['loginForm', 'menuButtons', 'adminPanel', 'adminChoice']);
        updateStatus(currentLanguage === 'zh-CN' ? "è¯·è¾“å…¥æ–°çš„ç§˜é’¥" : 
                   currentLanguage === 'zh-TW' ? "è«‹è¼¸å…¥æ–°çš„ç§˜é‘°" : "Please enter new key", false);
        logAction("é¡µé¢åˆ‡æ¢", "è¿”å›ç§˜é’¥éªŒè¯é¡µé¢", 'info');
    }

    // =================================================================
    // æ ¸å¿ƒæ¥å£è°ƒç”¨
    // =================================================================

    async function handleCheckKey(key = null) {
        key = key || document.getElementById('accessKey').value.trim();
        if (!key) {
            return updateStatus(currentLanguage === 'zh-CN' ? "è¯·è¾“å…¥ç§˜é’¥ï¼" : 
                              currentLanguage === 'zh-TW' ? "è«‹è¼¸å…¥ç§˜é‘°ï¼" : "Please enter key!", true);
        }
        
        updateStatus(currentLanguage === 'zh-CN' ? "æ­£åœ¨éªŒè¯ç§˜é’¥ï¼Œè¯·ç¨å€™..." : 
                   currentLanguage === 'zh-TW' ? "æ­£åœ¨é©—è­‰ç§˜é‘°ï¼Œè«‹ç¨å€™..." : "Verifying key, please wait...");
        
        try {
            const email = document.getElementById('email') ? document.getElementById('email').value.trim() : null;
            
            const response = await fetch(`${API_BASE_URL}/check-key`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ key, email })
            });

            const data = await response.json();

            if (!response.ok || !data.success) {
                logAction("ç§˜é’¥éªŒè¯", data.message || "ç§˜é’¥éªŒè¯å¤±è´¥", 'error');
                throw new Error(data.message || "ç§˜é’¥éªŒè¯å¤±è´¥");
            }
            
            currentKey = key;
            currentExpiryTime = data.expiryTime;
            isAdminMode = data.isAdmin;
            isSuperAdmin = data.isSuperAdmin || false;
            isTestCard = data.isTestCard || false;
            isPasswordCard = data.isPasswordCard || false;
            
            // å¦‚æœæ˜¯ç®¡ç†å‘˜ä¸”éœ€è¦é€‰æ‹©æ¨¡å¼
            if (data.isAdmin && data.needsChoice) {
                updateCardStatus(isTestCard, isPasswordCard);
                updateBindInfo(data.bindCount, data.maxBind, data.remainingBinds);
                updateStatus(data.message, false);
                document.getElementById('adminChoice').style.display = 'block';
                document.getElementById('keyForm').style.display = 'none';
                // éšè—å¯¼èˆªæŒ‰é’®åœ¨é€‰æ‹©ç•Œé¢
                document.getElementById('navButtons').style.display = 'none';
                // éšè—å¹¿å‘Š
                document.getElementById('homePromotion').style.display = 'none';
                logAction("ç®¡ç†å‘˜éªŒè¯", "ç®¡ç†å‘˜æ¨¡å¼é€‰æ‹©ç•Œé¢", 'info');
                return;
            }
            
            updateCardStatus(isTestCard, isPasswordCard);
            updateBindInfo(data.bindCount, data.maxBind, data.remainingBinds);
            currentBindInfo = { 
                bindCount: data.bindCount, 
                maxBind: data.maxBind, 
                remainingBinds: data.remainingBinds,
                isEmailBound: data.isEmailBound
            };
            
            if (isAdminMode) {
                // ç®¡ç†å‘˜ç›´æ¥è¿›å…¥ç®¡ç†å‘˜é¢æ¿
                updateStatus(data.message, false);
                switchSection('adminPanel', ['keyForm', 'loginForm', 'menuButtons', 'adminChoice']);
                updateAdminUI();
                fetchKeys();
                logAction("ç®¡ç†å‘˜ç§˜é’¥", `${isSuperAdmin ? 'è¶…çº§ç®¡ç†å‘˜' : 'ç®¡ç†å‘˜'}æ¨¡å¼å¯ç”¨`, 'info');
            } else {
                updateExpiryDisplay(
                    currentExpiryTime, 
                    data.durationHours || null, 
                    data.cardType || null
                );
                
                if (data.isEmailBound && email) {
                    updateStatus(currentLanguage === 'zh-CN' ? `é‚®ç®± ${email} å·²ç»‘å®šæ­¤ç§˜é’¥ï¼Œå¯ä»¥ç›´æ¥ç™»å½•ï¼` : 
                               currentLanguage === 'zh-TW' ? `éƒµç®± ${email} å·²ç¶å®šæ­¤ç§˜é‘°ï¼Œå¯ä»¥ç›´æ¥ç™»éŒ„ï¼` : 
                               `Email ${email} is bound to this key, you can login directly!`, false);
                } else if (data.remainingBinds <= 0) {
                    updateStatus(currentLanguage === 'zh-CN' ? `ç§˜é’¥ç»‘å®šå·²æ»¡ï¼ä½†å·²ç»‘å®šçš„è´¦å·ä»å¯ç™»å½•ã€‚` : 
                               currentLanguage === 'zh-TW' ? `ç§˜é‘°ç¶å®šå·²æ»¿ï¼ä½†å·²ç¶å®šçš„è³¬è™Ÿä»å¯ç™»éŒ„ã€‚` : 
                               `Key binding is full! But bound accounts can still login.`, true);
                } else {
                    updateStatus(data.message, false);
                }
                
                switchSection('loginForm', ['keyForm', 'menuButtons', 'adminPanel', 'adminChoice']);
                logAction("ç§˜é’¥éªŒè¯", data.message, 'success');
            }

        } catch (error) {
            updateStatus(`${currentLanguage === 'zh-CN' ? 'éªŒè¯å¤±è´¥ï¼š' : 
                        currentLanguage === 'zh-TW' ? 'é©—è­‰å¤±æ•—ï¼š' : 'Verification failed: '}${error.message}`, true);
            updateBindInfo();
            updateCardStatus(false, false);
        }
    }

    async function fetchKeys() {
        if (!isAdminMode) return;
        logAction("ç§˜é’¥ç®¡ç†", "æ­£åœ¨è·å–åˆ†ç±»ç§˜é’¥åˆ—è¡¨...", 'info');
        updateStatus(currentLanguage === 'zh-CN' ? "æ­£åœ¨è·å–åˆ†ç±»ç§˜é’¥åˆ—è¡¨..." : 
                   currentLanguage === 'zh-TW' ? "æ­£åœ¨ç²å–åˆ†é¡ç§˜é‘°åˆ—è¡¨..." : "Fetching categorized key list...", false);

        try {
            const response = await fetch(`${API_BASE_URL}/admin/keys?key=${currentKey}`, {
                method: "GET",
                headers: { "Content-Type": "application/json" }
            });

            const data = await response.json();

            if (!response.ok || !data.success) {
                logAction("ç§˜é’¥ç®¡ç†", data.message || "è·å–åˆ—è¡¨å¤±è´¥", 'error');
                updateStatus(`${currentLanguage === 'zh-CN' ? 'è·å–ç§˜é’¥åˆ—è¡¨å¤±è´¥ï¼š' : 
                            currentLanguage === 'zh-TW' ? 'ç²å–ç§˜é‘°åˆ—è¡¨å¤±æ•—ï¼š' : 'Failed to get key list: '}${data.message || 'æœªçŸ¥é”™è¯¯'}`, true);
                return;
            }

            renderKeysTable(data.keys);
            updateStatus(currentLanguage === 'zh-CN' ? `æˆåŠŸè·å–åˆ†ç±»ç§˜é’¥ä¿¡æ¯` : 
                       currentLanguage === 'zh-TW' ? `æˆåŠŸç²å–åˆ†é¡ç§˜é‘°ä¿¡æ¯` : 
                       `Successfully got categorized key info`, false);
            logAction("ç§˜é’¥ç®¡ç†", "æˆåŠŸè·å–åˆ†ç±»ç§˜é’¥åˆ—è¡¨", 'success');

        } catch (error) {
            updateStatus(`${currentLanguage === 'zh-CN' ? 'è·å–åˆ—è¡¨å¤±è´¥ï¼š' : 
                        currentLanguage === 'zh-TW' ? 'ç²å–åˆ—è¡¨å¤±æ•—ï¼š' : 'Failed to get list: '}${error.message}`, true);
            logAction("ç§˜é’¥ç®¡ç†", `è·å–åˆ—è¡¨å¤±è´¥ï¼š${error.message}`, 'error');
        }
    }
    
    function renderKeysTable(categorizedKeys) {
        // æ¸²æŸ“TGç§˜é’¥
        const tgTbody = document.getElementById('tgKeysTableBody');
        tgTbody.innerHTML = '';
        const tgKeys = categorizedKeys.telegram || [];
        
        tgKeys.forEach(keyData => {
            renderKeyRow(tgTbody, keyData, 'tg');
        });
        document.getElementById('tgKeyCount').textContent = `(${tgKeys.length})`;
    }

    // æ¸²æŸ“å•è¡Œç§˜é’¥
    function renderKeyRow(tbody, keyData, type) {
        const isActivated = keyData.isActivated;
        let expiryTimeStr;
        
        if (isActivated && keyData.expiryTime) {
            try {
                expiryTimeStr = new Date(keyData.expiryTime).toLocaleString('zh-CN', { 
                    hour12: false, 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit', 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
            } catch (e) {
                expiryTimeStr = currentLanguage === 'zh-CN' ? 'æ—¶é—´æ ¼å¼é”™è¯¯' : 'Date format error';
            }
        } else {
            expiryTimeStr = currentLanguage === 'zh-CN' ? 'æœªæ¿€æ´»' : 'Not activated';
        }
            
        const expiryClass = (isActivated && keyData.expiryTime && (new Date(keyData.expiryTime).getTime() - Date.now() < 24 * 3600 * 1000)) ? 'style="color: #FFB6C1; font-weight: bold;"' : '';

        const boundEmails = keyData.boundEmails || [];
        const bindCount = boundEmails.length;
        const maxBind = keyData.maxBind || 3;
        const bindInfo = ` (${bindCount}/${maxBind})`;

        let cardBadge = '';
        if (keyData.isTestCard) {
            cardBadge = `<span class="test-card-badge">${translations[currentLanguage].testCardBadge}</span>`;
        } else if (keyData.isPasswordCard) {
            cardBadge = `<span class="password-card-badge">${translations[currentLanguage].passwordCardBadge}</span>`;
        }
        
        let addedByInfo = '';
        if (type === 'tg' && keyData.telegramUser) {
            const tgUser = keyData.telegramUser;
            addedByInfo = `<br><small>TGç”¨æˆ·: ${tgUser.username || tgUser.firstName || 'æœªçŸ¥'}</small>`;
        } else if (keyData.addedByName) {
            addedByInfo = `<br><small>${keyData.addedByName}</small>`;
        }

        const row = tbody.insertRow();
        
        if (type === 'tg') {
            // TGç§˜é’¥æ˜¾ç¤ºTGç”¨æˆ·ä¿¡æ¯å’Œå¿«æ‰‹æš—å·
            const kuaishouCode = keyData.applicationInfo ? keyData.applicationInfo.kuaishouCode : 'æœªè®°å½•';
            row.innerHTML = `
                <td>${keyData.key}${cardBadge}${addedByInfo}</td>
                <td>${keyData.telegramUser ? (keyData.telegramUser.username || keyData.telegramUser.firstName || 'æœªçŸ¥') : 'æœªçŸ¥'}</td>
                <td>${kuaishouCode}</td>
                <td ${expiryClass}>${expiryTimeStr.replace(/\//g, '-')}</td>
                <td>
                    <div class="neon-action-group">
                        <button class="neon-action-btn copy" onclick="copyKey('${keyData.key}')">å¤åˆ¶</button>
                        <button class="neon-action-btn view" onclick="viewAccountDetails('${keyData.key}')">è¯¦æƒ…</button>
                        <button class="neon-action-btn delete" onclick="handleDeleteKey('${keyData.key}')">åˆ é™¤</button>
                    </div>
                </td>
            `;
        } else {
            // å…¶ä»–ç§˜é’¥æ˜¾ç¤ºå¤‡æ³¨ä¿¡æ¯
            row.innerHTML = `
                <td>${keyData.key}${cardBadge}${addedByInfo}</td>
                <td>${(keyData.remark || 'æ— ') + bindInfo}</td>
                <td ${expiryClass}>${expiryTimeStr.replace(/\//g, '-')}</td>
                <td>
                    <div class="neon-action-group">
                        <button class="neon-action-btn copy" onclick="copyKey('${keyData.key}')">å¤åˆ¶</button>
                        <button class="neon-action-btn view" onclick="viewAccountDetails('${keyData.key}')">è¯¦æƒ…</button>
                        <button class="neon-action-btn delete" onclick="handleDeleteKey('${keyData.key}')">åˆ é™¤</button>
                    </div>
                </td>
            `;
        }
    }

    function viewAccountDetails(key) {
        fetch(`${API_BASE_URL}/admin/keys?key=${currentKey}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // ä¿®å¤ï¼šä»åˆ†ç±»çš„ç§˜é’¥æ•°æ®ä¸­æŸ¥æ‰¾
                    let keyData = null;
                    
                    // æ£€æŸ¥æ‰€æœ‰åˆ†ç±»
                    if (data.keys.telegram) {
                        keyData = data.keys.telegram.find(k => k.key === key);
                    }
                    if (!keyData && data.keys.superAdmin) {
                        keyData = data.keys.superAdmin.find(k => k.key === key);
                    }
                    if (!keyData && data.keys.normalAdmins) {
                        for (let adminKey in data.keys.normalAdmins) {
                            keyData = data.keys.normalAdmins[adminKey].keys.find(k => k.key === key);
                            if (keyData) break;
                        }
                    }
                    
                    if (keyData) {
                        showAccountDetails(keyData);
                    } else {
                        alert(currentLanguage === 'zh-CN' ? 'æœªæ‰¾åˆ°è¯¥ç§˜é’¥çš„è¯¦ç»†ä¿¡æ¯ï¼' : 
                              currentLanguage === 'zh-TW' ? 'æœªæ‰¾åˆ°è©²ç§˜é‘°çš„è©³ç´°ä¿¡æ¯ï¼' : 'Key details not found!');
                    }
                }
            })
            .catch(error => {
                alert(`${currentLanguage === 'zh-CN' ? 'è·å–è´¦å·è¯¦æƒ…å¤±è´¥: ' : 
                      currentLanguage === 'zh-TW' ? 'ç²å–è³¬è™Ÿè©³æƒ…å¤±æ•—: ' : 'Failed to get account details: '}${error.message}`);
            });
    }

    function showAccountDetails(keyData) {
        const modal = document.getElementById('accountModal');
        const detailsEl = document.getElementById('accountDetails');
        
        const activationTime = keyData.activationTime ? 
            new Date(keyData.activationTime).toLocaleString('zh-CN', { hour12: false }) : 
            (currentLanguage === 'zh-CN' ? 'æœªæ¿€æ´»' : 
             currentLanguage === 'zh-TW' ? 'æœªæ¿€æ´»' : 'Not activated');
        const expiryTime = keyData.expiryTime ? 
            new Date(keyData.expiryTime).toLocaleString('zh-CN', { hour12: false }) : 
            (currentLanguage === 'zh-CN' ? 'æœªæ¿€æ´»' : 
             currentLanguage === 'zh-TW' ? 'æœªæ¿€æ´»' : 'Not activated');
        
        const keyLabel = currentLanguage === 'zh-CN' ? 'ç§˜é’¥:' : 
                        currentLanguage === 'zh-TW' ? 'ç§˜é‘°:' : 'Key:';
        const remarkLabel = currentLanguage === 'zh-CN' ? 'å¤‡æ³¨:' : 
                           currentLanguage === 'zh-TW' ? 'å‚™è¨»:' : 'Remark:';
        const statusLabel = currentLanguage === 'zh-CN' ? 'çŠ¶æ€:' : 
                           currentLanguage === 'zh-TW' ? 'ç‹€æ…‹:' : 'Status:';
        const activateTimeLabel = currentLanguage === 'zh-CN' ? 'å¯ç”¨æ—¶é—´:' : 
                                currentLanguage === 'zh-TW' ? 'å•Ÿç”¨æ™‚é–“:' : 'Activation Time:';
        const expiryTimeLabel = currentLanguage === 'zh-CN' ? 'åˆ°æœŸæ—¶é—´:' : 
                               currentLanguage === 'zh-TW' ? 'åˆ°æœŸæ™‚é–“:' : 'Expiry Time:';
        const bindCountLabel = currentLanguage === 'zh-CN' ? 'ç»‘å®šæ•°é‡:' : 
                              currentLanguage === 'zh-TW' ? 'ç¶å®šæ•¸é‡:' : 'Bind Count:';
        const addedByLabel = currentLanguage === 'zh-CN' ? 'æ·»åŠ è€…:' : 
                           currentLanguage === 'zh-TW' ? 'æ·»åŠ è€…:' : 'Added By:';
        const cardTypeLabel = currentLanguage === 'zh-CN' ? 'ç§˜é’¥ç±»å‹:' : 
                            currentLanguage === 'zh-TW' ? 'ç§˜é‘°é¡å‹:' : 'Key Type:';
        const activatedStatus = currentLanguage === 'zh-CN' ? 'å·²æ¿€æ´»' : 
                              currentLanguage === 'zh-TW' ? 'å·²æ¿€æ´»' : 'Activated';
        const notActivatedStatus = currentLanguage === 'zh-CN' ? 'æœªæ¿€æ´»' : 
                                 currentLanguage === 'zh-TW' ? 'æœªæ¿€æ´»' : 'Not activated';
        const boundAccountsLabel = currentLanguage === 'zh-CN' ? 'ç»‘å®šçš„è´¦å·:' : 
                                  currentLanguage === 'zh-TW' ? 'ç¶å®šçš„è³¬è™Ÿ:' : 'Bound Accounts:';
        const noAccountsLabel = currentLanguage === 'zh-CN' ? 'æš‚æ— ç»‘å®šçš„è´¦å·' : 
                               currentLanguage === 'zh-TW' ? 'æš«ç„¡ç¶å®šçš„è³¬è™Ÿ' : 'No bound accounts';
        
        let cardType = '';
        if (keyData.isTestCard) {
            cardType = translations[currentLanguage].testCardBadge;
        } else if (keyData.isPasswordCard) {
            cardType = translations[currentLanguage].passwordCardBadge;
        } else {
            cardType = currentLanguage === 'zh-CN' ? 'å…¨åŠŸèƒ½å¡' : 
                      currentLanguage === 'zh-TW' ? 'å…¨åŠŸèƒ½å¡' : 'Full Feature Card';
        }
        
        let html = `<div style="margin-bottom: 16px;">
            <strong>${keyLabel}</strong> ${keyData.key}<br>
            <strong>${cardTypeLabel}</strong> ${cardType}<br>
            <strong>${remarkLabel}</strong> ${keyData.remark || (currentLanguage === 'zh-CN' ? 'æ— ' : 
                                                               currentLanguage === 'zh-TW' ? 'ç„¡' : 'None')}<br>
            <strong>${statusLabel}</strong> ${keyData.isActivated ? activatedStatus : notActivatedStatus}<br>
            <strong>${activateTimeLabel}</strong> ${activationTime}<br>
            <strong>${expiryTimeLabel}</strong> ${expiryTime}<br>
            <strong>${bindCountLabel}</strong> ${(keyData.boundEmails || []).length}/${keyData.maxBind || 3}<br>
            <strong>${addedByLabel}</strong> ${keyData.addedByName || (currentLanguage === 'zh-CN' ? 'æœªçŸ¥' : 
                                                                     currentLanguage === 'zh-TW' ? 'æœªçŸ¥' : 'Unknown')}
        </div>`;

        // æ˜¾ç¤ºTGç”¨æˆ·ä¿¡æ¯
        if (keyData.telegramUser) {
            const tgUser = keyData.telegramUser;
            const tgLabel = currentLanguage === 'zh-CN' ? 'Telegramç”¨æˆ·ä¿¡æ¯:' : 
                           currentLanguage === 'zh-TW' ? 'Telegramç”¨æˆ¶ä¿¡æ¯:' : 'Telegram User:';
            const idLabel = currentLanguage === 'zh-CN' ? 'ç”¨æˆ·ID:' : 
                           currentLanguage === 'zh-TW' ? 'ç”¨æˆ¶ID:' : 'User ID:';
            const nameLabel = currentLanguage === 'zh-CN' ? 'ç”¨æˆ·å:' : 
                             currentLanguage === 'zh-TW' ? 'ç”¨æˆ¶å:' : 'Username:';
            const firstNameLabel = currentLanguage === 'zh-CN' ? 'åå­—:' : 
                                 currentLanguage === 'zh-TW' ? 'åå­—:' : 'First Name:';
            
            html += `<div style="margin: 16px 0; padding: 12px; background: rgba(0, 122, 255, 0.1); border-radius: 8px;">
                <strong>${tgLabel}</strong><br>
                <strong>${idLabel}</strong> ${tgUser.id}<br>
                <strong>${nameLabel}</strong> ${tgUser.username || 'æ— '}<br>
                <strong>${firstNameLabel}</strong> ${tgUser.firstName || 'æ— '}
            </div>`;
        }

        // æ˜¾ç¤ºç”³è¯·ä¿¡æ¯
        if (keyData.applicationInfo) {
            const appInfo = keyData.applicationInfo;
            const applyLabel = currentLanguage === 'zh-CN' ? 'ç”³è¯·ä¿¡æ¯:' : 
                              currentLanguage === 'zh-TW' ? 'ç”³è«‹ä¿¡æ¯:' : 'Application Info:';
            const applyTimeLabel = currentLanguage === 'zh-CN' ? 'ç”³è¯·æ—¶é—´:' : 
                                 currentLanguage === 'zh-TW' ? 'ç”³è«‹æ™‚é–“:' : 'Applied At:';
            const kuaishouLabel = currentLanguage === 'zh-CN' ? 'å¿«æ‰‹æš—å·:' : 
                                 currentLanguage === 'zh-TW' ? 'å¿«æ‰‹æš—è™Ÿ:' : 'Kuaishou Code:';
            
            html += `<div style="margin: 16px 0; padding: 12px; background: rgba(255, 149, 0, 0.1); border-radius: 8px;">
                <strong>${applyLabel}</strong><br>
                <strong>${applyTimeLabel}</strong> ${new Date(appInfo.appliedAt).toLocaleString()}<br>
                <strong>${kuaishouLabel}</strong> ${appInfo.kuaishouCode || 'æœªæä¾›'}<br>
                <strong>ç”³è¯·æ¸ é“:</strong> ${appInfo.appliedVia || 'æœªçŸ¥'}
            </div>`;
        }

        const boundAccounts = keyData.boundAccounts || [];
        if (boundAccounts.length > 0) {
            html += `<div><strong>${boundAccountsLabel}</strong></div>`;
            boundAccounts.forEach((account, index) => {
                // ç›´æ¥æ˜¾ç¤ºbase64å¯†ç ï¼Œä¸è§£ç 
                const password = account.password || '';
                
                const accountLabel = currentLanguage === 'zh-CN' ? `è´¦å· ${index + 1}:` : 
                                   currentLanguage === 'zh-TW' ? `è³¬è™Ÿ ${index + 1}:` : `Account ${index + 1}:`;
                const emailLabel = currentLanguage === 'zh-CN' ? 'é‚®ç®±:' : 
                                 currentLanguage === 'zh-TW' ? 'éƒµç®±:' : 'Email:';
                const passwordLabel = currentLanguage === 'zh-CN' ? 'å¯†ç (base64):' : 
                                    currentLanguage === 'zh-TW' ? 'å¯†ç¢¼(base64):' : 'Password(base64):';
                const bindTimeLabel = currentLanguage === 'zh-CN' ? 'ç»‘å®šæ—¶é—´:' : 
                                    currentLanguage === 'zh-TW' ? 'ç¶å®šæ™‚é–“:' : 'Bind Time:';
                const lastLoginLabel = currentLanguage === 'zh-CN' ? 'æœ€åç™»å½•:' : 
                                     currentLanguage === 'zh-TW' ? 'æœ€å¾Œç™»éŒ„:' : 'Last Login:';
                
                html += `
                <div class="account-detail-item">
                    <strong>${accountLabel}</strong><br>
                    <strong>${emailLabel}</strong> ${account.email}<br>
                    <strong>${passwordLabel}</strong> ${password}<br>
                    <strong>${bindTimeLabel}</strong> ${new Date(account.bindTime).toLocaleString()}<br>
                    <strong>${lastLoginLabel}</strong> ${new Date(account.lastLogin).toLocaleString()}
                </div>`;
            });
        } else {
            html += `<div>${noAccountsLabel}</div>`;
        }

        detailsEl.innerHTML = html;
        modal.style.display = 'flex';
    }

    function closeAccountModal() {
        document.getElementById('accountModal').style.display = 'none';
    }

    function copyKey(keyToCopy) {
        navigator.clipboard.writeText(keyToCopy)
            .then(() => {
                updateStatus(`${currentLanguage === 'zh-CN' ? 'ç§˜é’¥ ' : 
                            currentLanguage === 'zh-TW' ? 'ç§˜é‘° ' : 'Key '}${keyToCopy.substring(0, 4)}... ${currentLanguage === 'zh-CN' ? 'å·²å¤åˆ¶æˆåŠŸï¼' : 
                            currentLanguage === 'zh-TW' ? 'å·²è¤‡è£½æˆåŠŸï¼' : 'copied successfully!'}`, false);
                logAction("ç§˜é’¥å¤åˆ¶", `ç§˜é’¥ ${keyToCopy} å·²å¤åˆ¶`, 'success');
            })
            .catch(err => {
                updateStatus(currentLanguage === 'zh-CN' ? 'ç§˜é’¥å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶' : 
                           currentLanguage === 'zh-TW' ? 'ç§˜é‘°è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½' : 'Key copy failed, please copy manually', true);
                logAction("ç§˜é’¥å¤åˆ¶", `ç§˜é’¥å¤åˆ¶å¤±è´¥: ${err.message}`, 'error');
            });
    }

    async function handleAddKey() {
        if (!isAdminMode) return;

        const keyType = document.querySelector('input[name="keyType"]:checked').value;
        const duration = parseInt(document.getElementById('newKeyDuration').value);
        const maxBind = parseInt(document.getElementById('newKeyMaxBind').value) || 3;
        const remark = document.getElementById('newKeyRemark').value.trim();

        // éªŒè¯è¾“å…¥
        if (keyType === 'full') {
            if (!duration || duration <= 0) {
                return alert(currentLanguage === 'zh-CN' ? "è¯·è¾“å…¥æœ‰æ•ˆçš„ç§˜é’¥æ—¶é•¿ (å°æ—¶)" : 
                           currentLanguage === 'zh-TW' ? "è«‹è¼¸å…¥æœ‰æ•ˆçš„ç§˜é‘°æ™‚é•· (å°æ™‚)" : "Please enter valid key duration (hours)");
            }
            if (maxBind <= 0) {
                return alert(currentLanguage === 'zh-CN' ? "è¯·è¾“å…¥æœ‰æ•ˆçš„æœ€å¤§ç»‘å®šæ•°é‡" : 
                           currentLanguage === 'zh-TW' ? "è«‹è¼¸å…¥æœ‰æ•ˆçš„æœ€å¤§ç¶å®šæ•¸é‡" : "Please enter valid max bind count");
            }
        }

        // æ™®é€šç®¡ç†å‘˜åªèƒ½ç”Ÿæˆæµ‹è¯•å¡å’Œæ”¹å¯†å¡
        if (!isSuperAdmin && keyType === 'full') {
            return alert(currentLanguage === 'zh-CN' ? 'æ™®é€šç®¡ç†å‘˜åªèƒ½ç”Ÿæˆæµ‹è¯•å¡å’Œæ”¹å¯†å¡' : 
                        currentLanguage === 'zh-TW' ? 'æ™®é€šç®¡ç†å“¡åªèƒ½ç”Ÿæˆæ¸¬è©¦å¡å’Œæ”¹å¯†å¡' : 'Normal admin can only generate test and password cards');
        }
        
        logAction("ç§˜é’¥ç®¡ç†", `æ­£åœ¨ç”Ÿæˆ${getKeyTypeName(keyType)}...`, 'info');
        updateStatus(currentLanguage === 'zh-CN' ? "æ­£åœ¨ç”Ÿæˆå¹¶æ–°å¢ç§˜é’¥..." : 
                   currentLanguage === 'zh-TW' ? "æ­£åœ¨ç”Ÿæˆä¸¦æ–°å¢ç§˜é‘°..." : "Generating new key...", false);

        try {
            const response = await fetch(`${API_BASE_URL}/admin/keys?key=${currentKey}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ 
                    durationHours: keyType === 'full' ? duration : 1, 
                    maxBind: keyType === 'full' ? maxBind : 1, 
                    remark: remark,
                    isTestCard: keyType === 'test',
                    isPasswordCard: keyType === 'password'
                })
            });

            const data = await response.json();

            if (!response.ok || !data.success) {
                logAction("ç§˜é’¥ç®¡ç†", data.message || "æ–°å¢ç§˜é’¥å¤±è´¥", 'error');
                updateStatus(`${currentLanguage === 'zh-CN' ? 'æ–°å¢ç§˜é’¥å¤±è´¥ï¼š' : 
                            currentLanguage === 'zh-TW' ? 'æ–°å¢ç§˜é‘°å¤±æ•—ï¼š' : 'Failed to add key: '}${data.message || 'æœªçŸ¥é”™è¯¯'}`, true);
                return;
            }

            const keyTypeName = getKeyTypeName(keyType);
            const successMessage = keyType === 'full' ? 
                (currentLanguage === 'zh-CN' ? `å…¨åŠŸèƒ½å¡ç”ŸæˆæˆåŠŸï¼\nç§˜é’¥: ${data.key}\næ—¶é•¿: ${duration} å°æ—¶\næœ€å¤§ç»‘å®š: ${maxBind} ä¸ªè´¦å·\nå¤‡æ³¨: ${remark || 'æ— '}` :
                 currentLanguage === 'zh-TW' ? `å…¨åŠŸèƒ½å¡ç”ŸæˆæˆåŠŸï¼\nç§˜é‘°: ${data.key}\næ™‚é•·: ${duration} å°æ™‚\næœ€å¤§ç¶å®š: ${maxBind} å€‹è³¬è™Ÿ\nå‚™è¨»: ${remark || 'ç„¡'}` :
                 `Full feature card generated successfully!\nKey: ${data.key}\nDuration: ${duration} hours\nMax Bind: ${maxBind} accounts\nRemark: ${remark || 'None'}`) :
                (currentLanguage === 'zh-CN' ? `${keyTypeName}ç”ŸæˆæˆåŠŸï¼\nç§˜é’¥: ${data.key}\næ—¶é•¿: 1 å°æ—¶\næœ€å¤§ç»‘å®š: 1 ä¸ªè´¦å·\nå¤‡æ³¨: ${remark || keyTypeName}` :
                 currentLanguage === 'zh-TW' ? `${keyTypeName}ç”ŸæˆæˆåŠŸï¼\nç§˜é‘°: ${data.key}\næ™‚é•·: 1 å°æ™‚\næœ€å¤§ç¶å®š: 1 å€‹è³¬è™Ÿ\nå‚™è¨»: ${remark || keyTypeName}` :
                 `${keyTypeName} generated successfully!\nKey: ${data.key}\nDuration: 1 hour\nMax Bind: 1 account\nRemark: ${remark || keyTypeName}`);
            
            alert(successMessage);
            
            logAction("ç§˜é’¥ç®¡ç†", `æˆåŠŸç”Ÿæˆ${keyTypeName}: ${data.key}`, 'success');
            
            fetchKeys();

        } catch (error) {
            updateStatus(`${currentLanguage === 'zh-CN' ? 'æ–°å¢ç§˜é’¥å¤±è´¥ï¼š' : 
                        currentLanguage === 'zh-TW' ? 'æ–°å¢ç§˜é‘°å¤±æ•—ï¼š' : 'Failed to add key: '}${error.message}`, true);
            logAction("ç§˜é’¥ç®¡ç†", `æ–°å¢ç§˜é’¥å¤±è´¥ï¼š${error.message}`, 'error');
        }
    }

    function getKeyTypeName(type) {
        if (type === 'test') return 'æµ‹è¯•å¡';
        if (type === 'password') return 'æ”¹å¯†å¡';
        return 'å…¨åŠŸèƒ½å¡';
    }

    async function handleCleanupExpiredKeys() {
        if (!isAdminMode) return;
        
        const confirmMessage = currentLanguage === 'zh-CN' ? 'ç¡®å®šè¦æ¸…ç†æ‰€æœ‰è¿‡æœŸç§˜é’¥å—ï¼Ÿæ­¤æ“ä½œä¸å¯é€†ï¼' :
                             currentLanguage === 'zh-TW' ? 'ç¢ºå®šè¦æ¸…ç†æ‰€æœ‰éæœŸç§˜é‘°å—ï¼Ÿæ­¤æ“ä½œä¸å¯é€†ï¼' :
                             'Are you sure you want to clean up all expired keys? This operation is irreversible!';
        
        if (!confirm(confirmMessage)) return;

        logAction("ç§˜é’¥ç®¡ç†", "æ­£åœ¨æ¸…ç†è¿‡æœŸç§˜é’¥...", 'info');
        updateStatus(currentLanguage === 'zh-CN' ? "æ­£åœ¨æ¸…ç†è¿‡æœŸç§˜é’¥..." : 
                   currentLanguage === 'zh-TW' ? "æ­£åœ¨æ¸…ç†éæœŸç§˜é‘°..." : "Cleaning expired keys...", false);

        try {
            const response = await fetch(`${API_BASE_URL}/admin/cleanup-expired-keys?key=${currentKey}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" }
            });

            const data = await response.json();

            if (!response.ok || !data.success) {
                logAction("ç§˜é’¥ç®¡ç†", data.message || "æ¸…ç†è¿‡æœŸç§˜é’¥å¤±è´¥", 'error');
                updateStatus(`${currentLanguage === 'zh-CN' ? 'æ¸…ç†å¤±è´¥ï¼š' : 
                            currentLanguage === 'zh-TW' ? 'æ¸…ç†å¤±æ•—ï¼š' : 'Cleanup failed: '}${data.message || 'æœªçŸ¥é”™è¯¯'}`, true);
                return;
            }

            logAction("ç§˜é’¥ç®¡ç†", data.message, 'success');
            updateStatus(data.message, false);
            
            fetchKeys();

        } catch (error) {
            updateStatus(`${currentLanguage === 'zh-CN' ? 'æ¸…ç†å¤±è´¥ï¼š' : 
                        currentLanguage === 'zh-TW' ? 'æ¸…ç†å¤±æ•—ï¼š' : 'Cleanup failed: '}${error.message}`, true);
            logAction("ç§˜é’¥ç®¡ç†", `æ¸…ç†å¤±è´¥: ${error.message}`, 'error');
        }
    }
    
    async function handleDeleteKey(keyToDelete) {
        if (!isAdminMode) return;
        
        const confirmMessage = currentLanguage === 'zh-CN' ? `ç¡®å®šè¦æ°¸ä¹…åˆ é™¤ç§˜é’¥ï¼š${keyToDelete} å—ï¼Ÿ\næ­¤æ“ä½œä¸å¯é€†ï¼` :
                             currentLanguage === 'zh-TW' ? `ç¢ºå®šè¦æ°¸ä¹…åˆªé™¤ç§˜é‘°ï¼š${keyToDelete} å—ï¼Ÿ\næ­¤æ“ä½œä¸å¯é€†ï¼` :
                             `Are you sure you want to permanently delete key: ${keyToDelete}?\nThis operation is irreversible!`;
        
        if (!confirm(confirmMessage)) return;

        logAction("ç§˜é’¥ç®¡ç†", `æ­£åœ¨åˆ é™¤ç§˜é’¥: ${keyToDelete}...`, 'info');
        updateStatus(`${currentLanguage === 'zh-CN' ? 'æ­£åœ¨åˆ é™¤ç§˜é’¥: ' : 
                    currentLanguage === 'zh-TW' ? 'æ­£åœ¨åˆªé™¤ç§˜é‘°: ' : 'Deleting key: '}${keyToDelete}...`, false);

        try {
            const response = await fetch(`${API_BASE_URL}/admin/keys?key=${currentKey}&keyToDelete=${keyToDelete}`, {
                method: "DELETE",
                headers: { "Content-Type": "application/json" }
            });

            const data = await response.json();
            
            if (!response.ok || !data.success) {
                logAction("ç§˜é’¥ç®¡ç†", data.message || "åˆ é™¤ç§˜é’¥å¤±è´¥", 'error');
                updateStatus(`${currentLanguage === 'zh-CN' ? 'åˆ é™¤ç§˜é’¥å¤±è´¥ï¼š' : 
                            currentLanguage === 'zh-TW' ? 'åˆªé™¤ç§˜é‘°å¤±æ•—ï¼š' : 'Failed to delete key: '}${data.message || 'æœªçŸ¥é”™è¯¯'}`, true);
                return;
            }

            logAction("ç§˜é’¥ç®¡ç†", `æˆåŠŸåˆ é™¤ç§˜é’¥: ${keyToDelete}`, 'success');
            updateStatus(`${currentLanguage === 'zh-CN' ? 'æˆåŠŸåˆ é™¤ç§˜é’¥: ' : 
                        currentLanguage === 'zh-TW' ? 'æˆåŠŸåˆªé™¤ç§˜é‘°: ' : 'Successfully deleted key: '}${keyToDelete}`, false);
            
            fetchKeys();

        } catch (error) {
            updateStatus(`${currentLanguage === 'zh-CN' ? 'åˆ é™¤ç§˜é’¥å¤±è´¥ï¼š' : 
                        currentLanguage === 'zh-TW' ? 'åˆªé™¤ç§˜é‘°å¤±æ•—ï¼š' : 'Failed to delete key: '}${error.message}`, true);
            logAction("ç§˜é’¥ç®¡ç†", `åˆ é™¤ç§˜é’¥å¤±è´¥ï¼š${error.message}`, 'error');
        }
    }

    async function handleLogin() {
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value;

        if (!email || !password) {
            return updateStatus(currentLanguage === 'zh-CN' ? "è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç ï¼" : 
                              currentLanguage === 'zh-TW' ? "è«‹è¼¸å…¥éƒµç®±å’Œå¯†ç¢¼ï¼" : "Please enter email and password!", true);
        }
        
        updateStatus(currentLanguage === 'zh-CN' ? "æ­£åœ¨ç™»å½•..." : 
                   currentLanguage === 'zh-TW' ? "æ­£åœ¨ç™»éŒ„..." : "Logging in...", false);

        try {
            const response = await fetch(`${API_BASE_URL}/login`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email, password, key: currentKey })
            });

            const data = await response.json();

            if (!response.ok || !data.success) {
                logAction("ç™»å½•", data.message || "ç™»å½•å¤±è´¥", 'error');
                throw new Error(data.message || "ç™»å½•å¤±è´¥");
            }

            currentToken = data.data.idToken;
            currentUser = data.data.email;
            saveAuthToStorage(currentKey, currentToken, currentExpiryTime, currentUser);

            updateStatus(currentLanguage === 'zh-CN' ? "ç™»å½•æˆåŠŸï¼è¿›å…¥åŠŸèƒ½èœå•ã€‚" : 
                       currentLanguage === 'zh-TW' ? "ç™»éŒ„æˆåŠŸï¼é€²å…¥åŠŸèƒ½èœå–®ã€‚" : "Login successful! Entering function menu.", false);
            
            // ç®¡ç†å‘˜ç™»å½•åæ˜¾ç¤ºåŠŸèƒ½èœå•ï¼Œæ™®é€šç”¨æˆ·ä¹Ÿæ˜¾ç¤ºåŠŸèƒ½èœå•
            switchSection('menuButtons', ['keyForm', 'loginForm', 'adminPanel', 'adminChoice']);

            logAction("ç™»å½•", `ç”¨æˆ· ${currentUser} ç™»å½•æˆåŠŸ`, 'success');

        } catch (error) {
            updateStatus(`${currentLanguage === 'zh-CN' ? 'ç™»å½•å¤±è´¥ï¼š' : 
                        currentLanguage === 'zh-TW' ? 'ç™»éŒ„å¤±æ•—ï¼š' : 'Login failed: '}${error.message}`, true);
        }
    }

    async function handleKingRank() {
        if (!checkLogin()) return;

        if (isPasswordCard) {
            alert(translations[currentLanguage].passwordCardKingWarning);
            return;
        }

        logAction("ç­‰çº§è®¾ç½®", "å¼€å§‹å°è¯•è®¾ç½®å›½ç‹ç­‰çº§...", 'info');
        updateStatus(currentLanguage === 'zh-CN' ? "æ­£åœ¨å°è¯•è®¾ç½®å›½ç‹ç­‰çº§..." : 
                   currentLanguage === 'zh-TW' ? "æ­£åœ¨å˜—è©¦è¨­ç½®åœ‹ç‹ç­‰ç´š..." : "Setting king rank...", false);

        try {
            const response = await fetch(`${API_BASE_URL}/king-rank`, {
                method: "POST",
                headers: { 
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${currentToken}`
                }
            });

            const data = await response.json();

            if (!response.ok || !data.success) {
                throw new Error(data.message || "è®¾ç½®å›½ç‹ç­‰çº§å¤±è´¥ï¼");
            }

            logAction("ç­‰çº§è®¾ç½®", data.message, 'success');
            updateStatus(data.message, false);

        } catch (error) {
            updateStatus(`${currentLanguage === 'zh-CN' ? 'ç­‰çº§è®¾ç½®å¤±è´¥ï¼š' : 
                        currentLanguage === 'zh-TW' ? 'ç­‰ç´šè¨­ç½®å¤±æ•—ï¼š' : 'Failed to set rank: '}${error.message}`, true);
            logAction("ç­‰çº§è®¾ç½®", `è®¾ç½®å¤±è´¥: ${error.message}`, 'error');
        }
    }

    async function handleChangeEmail() {
        if (!checkLogin()) return;

        if (isTestCard || isPasswordCard) {
            alert(isTestCard ? translations[currentLanguage].testCardEmailWarning : translations[currentLanguage].passwordCardEmailWarning);
            return;
        }

        const newEmail = prompt(`${currentLanguage === 'zh-CN' ? `è¯·è¾“å…¥æ–°çš„é‚®ç®±åœ°å€ï¼ˆå½“å‰: ${currentUser}ï¼‰ï¼š` : 
                               currentLanguage === 'zh-TW' ? `è«‹è¼¸å…¥æ–°çš„éƒµç®±åœ°å€ï¼ˆç•¶å‰: ${currentUser}ï¼‰ï¼š` : 
                               `Enter new email address (current: ${currentUser}):`}`);
        if (!newEmail) return;

        logAction("ä¿®æ”¹é‚®ç®±", `æ­£åœ¨å°è¯•ä¿®æ”¹é‚®ç®±è‡³ ${newEmail}...`, 'info');
        updateStatus(currentLanguage === 'zh-CN' ? "æ­£åœ¨ä¿®æ”¹é‚®ç®±..." : 
                   currentLanguage === 'zh-TW' ? "æ­£åœ¨ä¿®æ”¹éƒµç®±..." : "Changing email...", false);

        try {
            const response = await fetch(`${API_BASE_URL}/change-email`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    idToken: currentToken,
                    newEmail,
                    oldEmail: currentUser,
                    key: currentKey
                }) 
            });

            const data = await response.json();

            if (!response.ok || !data.success) {
                throw new Error(data.message || "ä¿®æ”¹é‚®ç®±å¤±è´¥ï¼");
            }

            currentToken = data.data.idToken;
            const oldUser = currentUser;
            currentUser = data.data.email;
            saveAuthToStorage(currentKey, currentToken, currentExpiryTime, currentUser);

            logAction("ä¿®æ”¹é‚®ç®±", `æˆåŠŸä» ${oldUser} ä¿®æ”¹ä¸º ${currentUser}`, 'success');
            updateStatus(currentLanguage === 'zh-CN' ? `é‚®ç®±ä¿®æ”¹æˆåŠŸï¼æ–°é‚®ç®±: ${currentUser}` : 
                       currentLanguage === 'zh-TW' ? `éƒµç®±ä¿®æ”¹æˆåŠŸï¼æ–°éƒµç®±: ${currentUser}` : 
                       `Email changed successfully! New email: ${currentUser}`, false);

        } catch (error) {
            updateStatus(`${currentLanguage === 'zh-CN' ? 'ä¿®æ”¹å¤±è´¥ï¼š' : 
                        currentLanguage === 'zh-TW' ? 'ä¿®æ”¹å¤±æ•—ï¼š' : 'Change failed: '}${error.message}`, true);
            logAction("ä¿®æ”¹é‚®ç®±", `ä¿®æ”¹å¤±è´¥: ${error.message}`, 'error');
        }
    }

    async function handleChangePassword() {
        if (!checkLogin()) return;

        if (isTestCard) {
            alert(translations[currentLanguage].testCardPasswordWarning);
            return;
        }

        const newPassword = prompt(currentLanguage === 'zh-CN' ? "è¯·è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰ï¼š" : 
                                 currentLanguage === 'zh-TW' ? "è«‹è¼¸å…¥æ–°å¯†ç¢¼ï¼ˆè‡³å°‘6ä½ï¼‰ï¼š" : 
                                 "Enter new password (at least 6 characters):");
        if (!newPassword) return;
        if (newPassword.length < 6) {
            return updateStatus(currentLanguage === 'zh-CN' ? "æ–°å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½ï¼" : 
                              currentLanguage === 'zh-TW' ? "æ–°å¯†ç¢¼é•·åº¦ä¸èƒ½å°‘æ–¼6ä½ï¼" : 
                              "New password must be at least 6 characters!", true);
        }

        logAction("ä¿®æ”¹å¯†ç ", "æ­£åœ¨å°è¯•ä¿®æ”¹å¯†ç ...", 'info');
        updateStatus(currentLanguage === 'zh-CN' ? "æ­£åœ¨ä¿®æ”¹å¯†ç ..." : 
                   currentLanguage === 'zh-TW' ? "æ­£åœ¨ä¿®æ”¹å¯†ç¢¼..." : "Changing password...", false);

        try {
            const response = await fetch(`${API_BASE_URL}/change-password`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    idToken: currentToken,
                    newPassword,
                    email: currentUser,
                    key: currentKey
                }) 
            });

            const data = await response.json();

            if (!response.ok || !data.success) {
                throw new Error(data.message || "ä¿®æ”¹å¯†ç å¤±è´¥ï¼");
            }

            currentToken = data.data.idToken;
            saveAuthToStorage(currentKey, currentToken, currentExpiryTime, currentUser);

            logAction("ä¿®æ”¹å¯†ç ", "å¯†ç ä¿®æ”¹æˆåŠŸ", 'success');
            updateStatus(currentLanguage === 'zh-CN' ? "å¯†ç ä¿®æ”¹æˆåŠŸï¼" : 
                       currentLanguage === 'zh-TW' ? "å¯†ç¢¼ä¿®æ”¹æˆåŠŸï¼" : "Password changed successfully!", false);

        } catch (error) {
            updateStatus(`${currentLanguage === 'zh-CN' ? 'ä¿®æ”¹å¤±è´¥ï¼š' : 
                        currentLanguage === 'zh-TW' ? 'ä¿®æ”¹å¤±æ•—ï¼š' : 'Change failed: '}${error.message}`, true);
            logAction("ä¿®æ”¹å¯†ç ", `ä¿®æ”¹å¤±è´¥: ${error.message}`, 'error');
        }
    }

    function handleSwitchAccount() {
        currentUser = null;
        currentToken = null;
        localStorage.removeItem('idToken');
        localStorage.removeItem('currentUser');
        
        if (isAdminMode) {
            // ç®¡ç†å‘˜åˆ‡æ¢è´¦å·æ—¶å›åˆ°ç™»å½•ç•Œé¢
            switchSection('loginForm', ['menuButtons', 'adminPanel', 'adminChoice']);
            updateStatus(currentLanguage === 'zh-CN' ? "è¯·ç™»å½•æ–°çš„æ¸¸æˆè´¦å·" : 
                       currentLanguage === 'zh-TW' ? "è«‹ç™»éŒ„æ–°çš„éŠæˆ²è³¬è™Ÿ" : "Please login with new game account", false);
        } else {
            switchSection('loginForm', ['menuButtons', 'adminPanel', 'adminChoice']);
            updateStatus(currentLanguage === 'zh-CN' ? "è¯·ç™»å½•æ–°çš„æ¸¸æˆè´¦å·" : 
                       currentLanguage === 'zh-TW' ? "è«‹ç™»éŒ„æ–°çš„éŠæˆ²è³¬è™Ÿ" : "Please login with new game account", false);
        }
        
        logAction("åˆ‡æ¢è´¦å·", "åˆ‡æ¢åˆ°æ–°è´¦å·ç™»å½•", 'info');
    }

    function handleSwitchKey() {
        handleLogout(true);
        switchSection('keyForm', ['loginForm', 'menuButtons', 'adminPanel', 'adminChoice']);
        updateStatus(currentLanguage === 'zh-CN' ? "è¯·è¾“å…¥æ–°çš„ç§˜é’¥" : 
                   currentLanguage === 'zh-TW' ? "è«‹è¼¸å…¥æ–°çš„ç§˜é‘°" : "Please enter new key", false);
        logAction("åˆ‡æ¢ç§˜é’¥", "åˆ‡æ¢åˆ°æ–°ç§˜é’¥è¾“å…¥", 'info');
    }

    function handleReturnHome() {
        // è¿”å›é¦–é¡µæ—¶æ€»æ˜¯æ˜¾ç¤ºç§˜é’¥éªŒè¯é¡µé¢ï¼Œå¹¶æ˜¾ç¤ºå¹¿å‘Š
        switchSection('keyForm', ['loginForm', 'menuButtons', 'adminPanel', 'adminChoice']);
        updateStatus(currentLanguage === 'zh-CN' ? "è¯·è¾“å…¥ç§˜é’¥éªŒè¯" : 
                   currentLanguage === 'zh-TW' ? "è«‹è¼¸å…¥ç§˜é‘°é©—è­‰" : "Please verify key first", false);
        logAction("å¯¼èˆª", "è¿”å›é¦–é¡µ", 'info');
    }

    function handleLogout(silent = false) {
        localStorage.removeItem('accessKey');
        localStorage.removeItem('idToken');
        localStorage.removeItem('expiryTime');
        localStorage.removeItem('currentUser');
        
        currentUser = null;
        currentToken = null;
        currentKey = null;
        isAdminMode = false;
        isSuperAdmin = false;
        isTestCard = false;
        isPasswordCard = false;

        document.getElementById('accessKey').value = '';
        document.getElementById('email').value = '';
        document.getElementById('password').value = '';
        document.getElementById('adminPanel').style.display = 'none';
        updateBindInfo();
        updateCardStatus(false, false);
        
        updateExpiryDisplay(null, null, null, true);
        switchSection('keyForm', ['loginForm', 'menuButtons', 'adminPanel', 'adminChoice']);

        if (!silent) {
            updateStatus(currentLanguage === 'zh-CN' ? "å·²æˆåŠŸé€€å‡ºç™»å½•ï¼Œè¯·é‡æ–°éªŒè¯ç§˜é’¥" : 
                       currentLanguage === 'zh-TW' ? "å·²æˆåŠŸé€€å‡ºç™»éŒ„ï¼Œè«‹é‡æ–°é©—è­‰ç§˜é‘°" : "Logged out successfully, please verify key again");
            logAction("é€€å‡º", "ç”¨æˆ·å·²é€€å‡ºç™»å½•", 'info');
        }
    }

    function initAuthCheck() {
        logAction("ç³»ç»Ÿåˆå§‹åŒ–", "æ£€æŸ¥æœ¬åœ°ç™»å½•çŠ¶æ€", 'info');
        const hasStored = loadAuthFromStorage();
        
        if (hasStored && currentKey) {
            updateStatus(currentLanguage === 'zh-CN' ? "å‘ç°ä¸Šæ¬¡ç™»å½•çŠ¶æ€ï¼Œæ­£åœ¨é‡æ–°éªŒè¯ç§˜é’¥..." : 
                       currentLanguage === 'zh-TW' ? "ç™¼ç¾ä¸Šæ¬¡ç™»éŒ„ç‹€æ…‹ï¼Œæ­£åœ¨é‡æ–°é©—è­‰ç§˜é‘°..." : 
                       "Found previous login status, re-verifying key...", false);
            document.getElementById('accessKey').value = currentKey; 
            
            handleCheckKey(currentKey).then(() => {
                if(isAdminMode && currentUser && currentToken) {
                    updateStatus(currentLanguage === 'zh-CN' ? `æ¬¢è¿å›æ¥ï¼Œ${isSuperAdmin ? 'è¶…çº§ç®¡ç†å‘˜' : 'ç®¡ç†å‘˜'} ${currentUser}ã€‚` : 
                               currentLanguage === 'zh-TW' ? `æ­¡è¿å›ä¾†ï¼Œ${isSuperAdmin ? 'è¶…ç´šç®¡ç†å“¡' : 'ç®¡ç†å“¡'} ${currentUser}ã€‚` : 
                               `Welcome back, ${isSuperAdmin ? 'super admin' : 'admin'} ${currentUser}.`);
                    switchSection('menuButtons', ['keyForm', 'loginForm', 'adminPanel', 'adminChoice']);
                } else if(currentUser && currentToken) {
                    updateStatus(currentLanguage === 'zh-CN' ? `æ¬¢è¿å›æ¥ï¼Œ${currentUser}ã€‚` : 
                               currentLanguage === 'zh-TW' ? `æ­¡è¿å›ä¾†ï¼Œ${currentUser}ã€‚` : 
                               `Welcome back, ${currentUser}.`);
                    switchSection('menuButtons', ['keyForm', 'loginForm', 'adminPanel', 'adminChoice']);
                } else if (isAdminMode && !currentUser) {
                    // ç®¡ç†å‘˜ä½†æœªç™»å½•æ¸¸æˆè´¦å·ï¼Œæ˜¾ç¤ºç®¡ç†å‘˜é¢æ¿
                    switchSection('adminPanel', ['keyForm', 'loginForm', 'menuButtons', 'adminChoice']);
                    updateAdminUI();
                    fetchKeys();
                }
            }); 
        } else {
            switchSection('keyForm', ['loginForm', 'menuButtons', 'adminPanel', 'adminChoice']);
            updateStatus(currentLanguage === 'zh-CN' ? "è¯·å…ˆè¾“å…¥ç§˜é’¥éªŒè¯" : 
                       currentLanguage === 'zh-TW' ? "è«‹å…ˆè¼¸å…¥ç§˜é‘°é©—è­‰" : "Please verify key first");
        }
    }

    // =================================================================
    // CPMCYå…‹éš†å·¥å…·åŠŸèƒ½
    // =================================================================

    // CPMå…‹éš†å·¥å…·çš„JavaScriptä»£ç 
    document.addEventListener('DOMContentLoaded', function() {
        // ç²’å­æ•ˆæœ
        createParticles();
        
        applyTranslations();
        
        initAuthCheck();

        // é»˜è®¤é€‰æ‹©å…¨åŠŸèƒ½å¡
        selectKeyType('full');

        // æ“ä½œç±»å‹åˆ‡æ¢
        document.querySelectorAll('input[name="operation-type"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const targetCredentials = document.getElementById('target-credentials');
                if (this.value === 'clone-to-new') {
                    targetCredentials.classList.remove('hidden');
                } else {
                    targetCredentials.classList.add('hidden');
                }
            });
        });

        // CPMå…‹éš†ç™»å½•
        document.getElementById('login-btn-clone').addEventListener('click', function() {
            const email = document.getElementById('source-email').value.trim();
            const password = document.getElementById('source-password').value;
            
            if (!email || !password) {
                showCloneStatus('è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç ', 'error');
                return;
            }
            
            showCloneStatus('æ­£åœ¨ç™»å½•...', 'info');
            this.disabled = true;
            
            // è¿™é‡Œåº”è¯¥è°ƒç”¨å®é™…çš„API
            setTimeout(() => {
                // æ¨¡æ‹Ÿç™»å½•æˆåŠŸ
                showCloneStatus('ç™»å½•æˆåŠŸï¼æ­£åœ¨è·å–è´¦å·ä¿¡æ¯...', 'success');
                
                // æ¨¡æ‹Ÿè·å–è´¦å·ä¿¡æ¯
                setTimeout(() => {
                    // æ›´æ–°è´¦å·ä¿¡æ¯æ˜¾ç¤º
                    document.getElementById('account-name').textContent = 'ç©å®¶' + Math.floor(Math.random() * 10000);
                    document.getElementById('account-money').textContent = (Math.random() * 1000000).toFixed(0) + 'é‡‘å¸';
                    document.getElementById('account-cars').textContent = Math.floor(Math.random() * 50);
                    document.getElementById('account-localid').textContent = generateLocalID();
                    document.getElementById('account-status').textContent = 'å·²ç™»å½•';
                    
                    // æ˜¾ç¤ºè´¦å·ä¿¡æ¯
                    document.getElementById('account-info-section-clone').classList.remove('hidden');
                    document.getElementById('logout-btn-clone').style.display = 'block';
                    document.getElementById('login-section-clone').classList.add('hidden');
                    document.getElementById('clone-section-clone').classList.remove('hidden');
                    
                    showCloneStatus('è´¦å·ä¿¡æ¯è·å–å®Œæˆï¼', 'success');
                    this.disabled = false;
                }, 1500);
            }, 1000);
        });

        // CPMå…‹éš†æ‰§è¡Œ
        document.getElementById('clone-btn-clone').addEventListener('click', function() {
            const operationType = document.querySelector('input[name="operation-type"]:checked').value;
            const customLocalID = document.getElementById('custom-localid').value.trim();
            const targetEmail = document.getElementById('target-email').value.trim();
            const targetPassword = document.getElementById('target-password').value;
            
            if (!customLocalID) {
                showCloneStatus('è¯·è¾“å…¥è‡ªå®šä¹‰Local ID', 'error');
                return;
            }
            
            if (operationType === 'clone-to-new' && (!targetEmail || !targetPassword)) {
                showCloneStatus('è¯·è¾“å…¥ç›®æ ‡è´¦å·çš„é‚®ç®±å’Œå¯†ç ', 'error');
                return;
            }
            
            if (!confirm('ç¡®å®šè¦æ‰§è¡Œå…‹éš†æ“ä½œå—ï¼Ÿæ­¤æ“ä½œä¸å¯é€†ï¼')) {
                return;
            }
            
            showCloneStatus('å¼€å§‹å…‹éš†æ“ä½œ...', 'info');
            this.disabled = true;
            
            // æ˜¾ç¤ºè¿›åº¦æ¡
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const statusLog = document.getElementById('status-log');
            
            progressBar.style.width = '0%';
            progressText.textContent = 'å‡†å¤‡å¼€å§‹...';
            
            // æ¸…ç©ºæ—¥å¿—
            statusLog.innerHTML = '';
            
            // æ¨¡æ‹Ÿå…‹éš†è¿‡ç¨‹
            let progress = 0;
            const steps = [
                'æ­£åœ¨è¿æ¥CPMæœåŠ¡å™¨...',
                'æ­£åœ¨éªŒè¯è´¦å·ä¿¡æ¯...',
                'æ­£åœ¨å¤‡ä»½æºè´¦å·æ•°æ®...',
                'æ­£åœ¨å¤„ç†Local IDä¿®æ”¹...',
                'æ­£åœ¨ä¼ è¾“è½¦è¾†æ•°æ®...',
                'æ­£åœ¨ä¼ è¾“é‡‘å¸æ•°æ®...',
                'æ­£åœ¨éªŒè¯ç›®æ ‡è´¦å·...',
                'æ­£åœ¨å†™å…¥ç›®æ ‡è´¦å·...',
                'æ­£åœ¨éªŒè¯æ•°æ®å®Œæ•´æ€§...',
                'å…‹éš†å®Œæˆï¼'
            ];
            
            const interval = setInterval(() => {
                if (progress < steps.length) {
                    progress += 1;
                    const percentage = (progress / steps.length) * 100;
                    progressBar.style.width = `${percentage}%`;
                    progressText.textContent = steps[progress - 1];
                    
                    // æ·»åŠ æ—¥å¿—
                    const logEntry = document.createElement('div');
                    logEntry.className = 'log-entry';
                    logEntry.innerHTML = `<i class="fas fa-info-circle"></i> ${steps[progress - 1]}`;
                    statusLog.prepend(logEntry);
                    
                    if (progress === steps.length) {
                        clearInterval(interval);
                        showCloneStatus('å…‹éš†æ“ä½œå®Œæˆï¼', 'success');
                        this.disabled = false;
                        
                        // æ·»åŠ æˆåŠŸæ—¥å¿—
                        const successLog = document.createElement('div');
                        successLog.className = 'log-entry';
                        successLog.innerHTML = `<i class="fas fa-check-circle" style="color: #2ecc71;"></i> å…‹éš†æ“ä½œå·²æˆåŠŸå®Œæˆï¼`;
                        statusLog.prepend(successLog);
                    }
                }
            }, 3000);
        });

        // å…‹éš†å·¥å…·é€€å‡ºç™»å½•
        document.getElementById('logout-btn-clone').addEventListener('click', function() {
            // éšè—è´¦å·ä¿¡æ¯
            document.getElementById('account-info-section-clone').classList.add('hidden');
            this.style.display = 'none';
            document.getElementById('login-section-clone').classList.remove('hidden');
            document.getElementById('clone-section-clone').classList.add('hidden');
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('source-email').value = '';
            document.getElementById('source-password').value = '';
            document.getElementById('custom-localid').value = '';
            document.getElementById('target-email').value = '';
            document.getElementById('target-password').value = '';
            
            showCloneStatus('å·²é€€å‡ºç™»å½•', 'info');
        });
    });

    function generateLocalID() {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        let result = '';
        for (let i = 0; i < 16; i++) {
            result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return result;
    }

    function showCloneStatus(message, type) {
        const statusEl = document.getElementById('clone-status');
        statusEl.textContent = message;
        statusEl.style.display = 'block';
        
        if (type === 'error') {
            statusEl.className = 'neon-status error';
        } else if (type === 'success') {
            statusEl.className = 'neon-status success';
        } else {
            statusEl.className = 'neon-status';
        }
        
        // 3ç§’åè‡ªåŠ¨éšè—
        setTimeout(() => {
            statusEl.style.display = 'none';
        }, 3000);
    }

    // ç²’å­æ•ˆæœ
    function createParticles() {
        const particlesContainer = document.getElementById('particles');
        const particleCount = 50;
        
        for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            // éšæœºä½ç½®
            const size = Math.random() * 3 + 1;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.left = `${Math.random() * 100}vw`;
            particle.style.opacity = Math.random() * 0.5 + 0.3;
            
            // éšæœºé¢œè‰²
            const colors = [
                'rgba(255, 149, 0, 0.8)',
                'rgba(255, 45, 85, 0.8)',
                'rgba(175, 82, 222, 0.8)',
                'rgba(0, 122, 255, 0.8)',
                'rgba(52, 199, 89, 0.8)'
            ];
            particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            
            // éšæœºåŠ¨ç”»
            particle.style.setProperty('--x', Math.random());
            particle.style.animationDuration = `${Math.random() * 10 + 15}s`;
            particle.style.animationDelay = `${Math.random() * 5}s`;
            
            particlesContainer.appendChild(particle);
        }
    }

    // APIè¯·æ±‚å‡½æ•°
    window.makeAPIRequest = async function(url, data) {
        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            return await response.json();
        } catch (error) {
            console.error('API request error:', error);
            return { ok: false, message: 'ç½‘ç»œè¯·æ±‚å¤±è´¥' };
        }
    };
</script>

<!-- app.js å†…å®¹ -->
<script>
// app.js - CPMå…‹éš†å·¥å…·ä¸»è¦åŠŸèƒ½
(function() {
    'use strict';
    
    // å…¨å±€å˜é‡
    let currentAccount = null;
    let cloneProcessActive = false;
    let progressInterval = null;
    
    // åˆå§‹åŒ–å…‹éš†å·¥å…·
    function initCloneTool() {
        console.log('ğŸ”§ CPMå…‹éš†å·¥å…·åˆå§‹åŒ–å®Œæˆ');
        
        // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
        bindEvents();
        
        // æ¢å¤ä¼šè¯çŠ¶æ€
        restoreSession();
    }
    
    // ç»‘å®šäº‹ä»¶
    function bindEvents() {
        // æ“ä½œç±»å‹åˆ‡æ¢
        document.querySelectorAll('input[name="operation-type"]').forEach(radio => {
            radio.addEventListener('change', handleOperationTypeChange);
        });
        
        // ç™»å½•æŒ‰é’®
        const loginBtn = document.getElementById('login-btn-clone');
        if (loginBtn) {
            loginBtn.addEventListener('click', handleCloneLogin);
        }
        
        // å…‹éš†æŒ‰é’®
        const cloneBtn = document.getElementById('clone-btn-clone');
        if (cloneBtn) {
            cloneBtn.addEventListener('click', handleCloneExecute);
        }
        
        // é€€å‡ºç™»å½•æŒ‰é’®
        const logoutBtn = document.getElementById('logout-btn-clone');
        if (logoutBtn) {
            logoutBtn.addEventListener('click', handleCloneLogout);
        }
        
        // è¾“å…¥æ¡†å›è½¦äº‹ä»¶
        const passwordInput = document.getElementById('source-password');
        if (passwordInput) {
            passwordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleCloneLogin();
                }
            });
        }
        
        const targetPasswordInput = document.getElementById('target-password');
        if (targetPasswordInput) {
            targetPasswordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleCloneExecute();
                }
            });
        }
    }
    
    // æ¢å¤ä¼šè¯çŠ¶æ€
    function restoreSession() {
        const savedAccount = localStorage.getItem('cpmcy_account_data');
        if (savedAccount) {
            try {
                currentAccount = JSON.parse(savedAccount);
                if (currentAccount && currentAccount.email) {
                    // æ¢å¤è´¦å·ä¿¡æ¯æ˜¾ç¤º
                    updateAccountDisplay(currentAccount);
                    showAccountInfo();
                }
            } catch (e) {
                console.error('æ¢å¤ä¼šè¯å¤±è´¥:', e);
                localStorage.removeItem('cpmcy_account_data');
            }
        }
    }
    
    // æ“ä½œç±»å‹åˆ‡æ¢å¤„ç†
    function handleOperationTypeChange(event) {
        const targetCredentials = document.getElementById('target-credentials');
        const customIdGroup = document.getElementById('custom-id-group');
        
        if (event.target.value === 'clone-to-new') {
            targetCredentials.classList.remove('hidden');
            
            // æ›´æ–°è‡ªå®šä¹‰IDè¾“å…¥æ¡†çš„placeholder
            const customIdInput = document.getElementById('custom-localid');
            if (customIdInput) {
                customIdInput.placeholder = 'è¾“å…¥æ–°çš„Local IDï¼ˆå°†è¦†ç›–ç›®æ ‡è´¦å·ï¼‰';
            }
        } else {
            targetCredentials.classList.add('hidden');
            
            // æ¢å¤è‡ªå®šä¹‰IDè¾“å…¥æ¡†çš„placeholder
            const customIdInput = document.getElementById('custom-localid');
            if (customIdInput) {
                customIdInput.placeholder = 'è¾“å…¥æ–°çš„Local IDï¼ˆå­—æ¯æ•°å­—ï¼Œå»ºè®®10-20ä½ï¼‰';
            }
        }
    }
    
    // å…‹éš†ç™»å½•å¤„ç†
    async function handleCloneLogin() {
        const email = document.getElementById('source-email').value.trim();
        const password = document.getElementById('source-password').value;
        const loginBtn = document.getElementById('login-btn-clone');
        const loginStatus = document.getElementById('login-status');
        
        // éªŒè¯è¾“å…¥
        if (!email || !password) {
            showStatus(loginStatus, 'è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç ', 'error');
            return;
        }
        
        // éªŒè¯é‚®ç®±æ ¼å¼
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            showStatus(loginStatus, 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®', 'error');
            return;
        }
        
        // éªŒè¯å¯†ç é•¿åº¦
        if (password.length < 6) {
            showStatus(loginStatus, 'å¯†ç é•¿åº¦è‡³å°‘6ä½', 'error');
            return;
        }
        
        // ç¦ç”¨æŒ‰é’®ï¼Œæ˜¾ç¤ºåŠ è½½çŠ¶æ€
        loginBtn.disabled = true;
        loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ç™»å½•ä¸­...';
        showStatus(loginStatus, 'æ­£åœ¨è¿æ¥æœåŠ¡å™¨...', 'info');
        
        try {
            // è¿™é‡Œåº”è¯¥è°ƒç”¨å®é™…çš„ç™»å½•API
            // æ¨¡æ‹ŸAPIè°ƒç”¨å»¶è¿Ÿ
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            // æ¨¡æ‹Ÿç™»å½•æˆåŠŸ
            const mockAccountData = {
                email: email,
                name: 'ç©å®¶' + Math.floor(Math.random() * 10000),
                money: Math.floor(Math.random() * 1000000),
                cars: Math.floor(Math.random() * 50),
                localid: generateLocalID(),
                level: Math.floor(Math.random() * 100),
                lastLogin: new Date().toLocaleString()
            };
            
            // ä¿å­˜è´¦å·æ•°æ®
            currentAccount = mockAccountData;
            localStorage.setItem('cpmcy_account_data', JSON.stringify(mockAccountData));
            
            // æ›´æ–°ç•Œé¢æ˜¾ç¤º
            updateAccountDisplay(mockAccountData);
            showAccountInfo();
            
            // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
            showStatus(loginStatus, 'ç™»å½•æˆåŠŸï¼è´¦å·ä¿¡æ¯å·²åŠ è½½', 'success');
            
            // è®°å½•æ—¥å¿—
            addLogEntry(`ç”¨æˆ· ${email} ç™»å½•æˆåŠŸ`, 'success');
            
        } catch (error) {
            // å¤„ç†é”™è¯¯
            showStatus(loginStatus, `ç™»å½•å¤±è´¥: ${error.message || 'æœªçŸ¥é”™è¯¯'}`, 'error');
            addLogEntry(`ç™»å½•å¤±è´¥: ${error.message || 'æœªçŸ¥é”™è¯¯'}`, 'error');
        } finally {
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            loginBtn.disabled = false;
            loginBtn.innerHTML = '<i class="fas fa-key"></i> ç™»å½•å¹¶éªŒè¯è´¦å·';
        }
    }
    
    // å…‹éš†æ‰§è¡Œå¤„ç†
    async function handleCloneExecute() {
        // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
        if (!currentAccount) {
            alert('è¯·å…ˆç™»å½•æºè´¦å·ï¼');
            return;
        }
        
        const operationType = document.querySelector('input[name="operation-type"]:checked').value;
        const customLocalID = document.getElementById('custom-localid').value.trim();
        const targetEmail = document.getElementById('target-email').value.trim();
        const targetPassword = document.getElementById('target-password').value;
        const cloneBtn = document.getElementById('clone-btn-clone');
        const cloneStatus = document.getElementById('clone-status');
        
        // éªŒè¯è¾“å…¥
        if (!customLocalID) {
            showStatus(cloneStatus, 'è¯·è¾“å…¥è‡ªå®šä¹‰Local ID', 'error');
            return;
        }
        
        // éªŒè¯Local IDæ ¼å¼
        if (customLocalID.length < 10 || customLocalID.length > 20) {
            showStatus(cloneStatus, 'Local IDé•¿åº¦åº”åœ¨10-20ä½ä¹‹é—´', 'error');
            return;
        }
        
        if (operationType === 'clone-to-new') {
            if (!targetEmail || !targetPassword) {
                showStatus(cloneStatus, 'è¯·è¾“å…¥ç›®æ ‡è´¦å·çš„é‚®ç®±å’Œå¯†ç ', 'error');
                return;
            }
            
            // éªŒè¯ç›®æ ‡é‚®ç®±æ ¼å¼
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(targetEmail)) {
                showStatus(cloneStatus, 'ç›®æ ‡é‚®ç®±æ ¼å¼ä¸æ­£ç¡®', 'error');
                return;
            }
            
            // ä¸èƒ½å…‹éš†åˆ°åŒä¸€ä¸ªè´¦å·
            if (targetEmail === currentAccount.email) {
                showStatus(cloneStatus, 'ä¸èƒ½å…‹éš†åˆ°åŒä¸€ä¸ªè´¦å·', 'error');
                return;
            }
            
            // éªŒè¯ç›®æ ‡å¯†ç é•¿åº¦
            if (targetPassword.length < 6) {
                showStatus(cloneStatus, 'ç›®æ ‡å¯†ç é•¿åº¦è‡³å°‘6ä½', 'error');
                return;
            }
        }
        
        // ç¡®è®¤å¯¹è¯æ¡†
        const confirmMessage = operationType === 'modify-id' 
            ? `ç¡®å®šè¦ä¿®æ”¹å½“å‰è´¦å·çš„Local IDä¸º ${customLocalID} å—ï¼Ÿ`
            : `ç¡®å®šè¦å°†å½“å‰è´¦å·æ•°æ®å…‹éš†åˆ° ${targetEmail} å—ï¼Ÿ\nç›®æ ‡è´¦å·çš„æ‰€æœ‰æ•°æ®å°†è¢«è¦†ç›–ï¼`;
        
        if (!confirm(confirmMessage)) {
            return;
        }
        
        // é˜²æ­¢é‡å¤æ‰§è¡Œ
        if (cloneProcessActive) {
            showStatus(cloneStatus, 'å…‹éš†æ“ä½œæ­£åœ¨è¿›è¡Œä¸­ï¼Œè¯·ç­‰å¾…å®Œæˆ', 'warning');
            return;
        }
        
        // ç¦ç”¨æŒ‰é’®ï¼Œå¼€å§‹å…‹éš†è¿‡ç¨‹
        cloneProcessActive = true;
        cloneBtn.disabled = true;
        cloneBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> å…‹éš†ä¸­...';
        
        // æ˜¾ç¤ºè¿›åº¦æ¡
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const statusLog = document.getElementById('status-log');
        
        // åˆå§‹åŒ–è¿›åº¦
        progressBar.style.width = '0%';
        progressText.textContent = 'å‡†å¤‡å¼€å§‹å…‹éš†æ“ä½œ...';
        
        // æ¸…ç©ºæ—¥å¿—
        statusLog.innerHTML = '';
        addLogEntry('å¼€å§‹å…‹éš†æ“ä½œ...', 'info');
        
        try {
            // å…‹éš†æ­¥éª¤é…ç½®
            const steps = operationType === 'modify-id' 
                ? getModifyIdSteps(customLocalID)
                : getCloneSteps(targetEmail, customLocalID);
            
            let currentStep = 0;
            
            // è®¾ç½®è¿›åº¦æ›´æ–°é—´éš”
            progressInterval = setInterval(() => {
                if (currentStep < steps.length) {
                    const step = steps[currentStep];
                    const percentage = ((currentStep + 1) / steps.length) * 100;
                    
                    // æ›´æ–°è¿›åº¦æ¡
                    progressBar.style.width = `${percentage}%`;
                    progressText.textContent = step.message;
                    
                    // æ·»åŠ æ—¥å¿—
                    addLogEntry(step.message, step.type || 'info');
                    
                    // å¦‚æœæ­¥éª¤æœ‰å»¶è¿Ÿï¼Œç­‰å¾…
                    if (step.delay) {
                        setTimeout(() => {
                            currentStep++;
                        }, step.delay);
                    } else {
                        currentStep++;
                    }
                    
                    // å¦‚æœæ˜¯æœ€åä¸€æ­¥ï¼Œå®Œæˆå…‹éš†
                    if (currentStep === steps.length) {
                        clearInterval(progressInterval);
                        completeCloneProcess(operationType, customLocalID, targetEmail);
                    }
                }
            }, 2000);
            
        } catch (error) {
            handleCloneError(error);
        }
    }
    
    // è·å–ä¿®æ”¹IDçš„æ­¥éª¤
    function getModifyIdSteps(newLocalID) {
        return [
            { message: 'æ­£åœ¨éªŒè¯å½“å‰è´¦å·...', delay: 1000 },
            { message: 'æ­£åœ¨å¤‡ä»½å½“å‰è´¦å·æ•°æ®...', delay: 1500 },
            { message: `æ­£åœ¨ä¿®æ”¹Local IDä¸º ${newLocalID}...`, delay: 2000 },
            { message: 'æ­£åœ¨æ›´æ–°æœåŠ¡å™¨è®°å½•...', delay: 1500 },
            { message: 'æ­£åœ¨éªŒè¯ä¿®æ”¹ç»“æœ...', delay: 1000 },
            { message: 'Local IDä¿®æ”¹å®Œæˆï¼', delay: 0 }
        ];
    }
    
    // è·å–å…‹éš†çš„æ­¥éª¤
    function getCloneSteps(targetEmail, newLocalID) {
        return [
            { message: 'æ­£åœ¨éªŒè¯æºè´¦å·æ•°æ®...', delay: 1000 },
            { message: 'æ­£åœ¨è¿æ¥ç›®æ ‡è´¦å·...', delay: 1500 },
            { message: 'æ­£åœ¨å¤‡ä»½æºè´¦å·æ•°æ®...', delay: 2000 },
            { message: `æ­£åœ¨ä¿®æ”¹Local IDä¸º ${newLocalID}...`, delay: 1500 },
            { message: `æ­£åœ¨å…‹éš†æ•°æ®åˆ° ${targetEmail}...`, delay: 2500 },
            { message: 'æ­£åœ¨ä¼ è¾“è½¦è¾†æ•°æ®...', delay: 2000 },
            { message: 'æ­£åœ¨ä¼ è¾“é‡‘å¸æ•°æ®...', delay: 1500 },
            { message: 'æ­£åœ¨éªŒè¯æ•°æ®å®Œæ•´æ€§...', delay: 1000 },
            { message: 'å…‹éš†æ“ä½œå®Œæˆï¼', delay: 0 }
        ];
    }
    
    // å®Œæˆå…‹éš†è¿‡ç¨‹
    function completeCloneProcess(operationType, customLocalID, targetEmail) {
        const cloneBtn = document.getElementById('clone-btn-clone');
        const cloneStatus = document.getElementById('clone-status');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        
        // æ›´æ–°å½“å‰è´¦å·çš„Local ID
        if (operationType === 'modify-id') {
            currentAccount.localid = customLocalID;
            localStorage.setItem('cpmcy_account_data', JSON.stringify(currentAccount));
            updateAccountDisplay(currentAccount);
            
            addLogEntry(`Local IDå·²æˆåŠŸä¿®æ”¹ä¸º ${customLocalID}`, 'success');
            showStatus(cloneStatus, 'Local IDä¿®æ”¹æˆåŠŸï¼', 'success');
        } else {
            addLogEntry(`è´¦å·æ•°æ®å·²æˆåŠŸå…‹éš†åˆ° ${targetEmail}`, 'success');
            showStatus(cloneStatus, 'å…‹éš†æ“ä½œå®Œæˆï¼', 'success');
        }
        
        // æ›´æ–°è¿›åº¦æ˜¾ç¤º
        progressBar.style.width = '100%';
        progressText.textContent = operationType === 'modify-id' ? 'Local IDä¿®æ”¹å®Œæˆï¼' : 'å…‹éš†æ“ä½œå®Œæˆï¼';
        
        // æ¢å¤æŒ‰é’®çŠ¶æ€
        cloneBtn.disabled = false;
        cloneBtn.innerHTML = '<i class="fas fa-clone"></i> å¼€å§‹æ‰§è¡Œ';
        cloneProcessActive = false;
        
        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        const successMessage = operationType === 'modify-id' 
            ? `Local IDå·²æˆåŠŸä¿®æ”¹ä¸º: ${customLocalID}`
            : `è´¦å·æ•°æ®å·²æˆåŠŸå…‹éš†åˆ°: ${targetEmail}`;
        
        alert(`âœ… ${successMessage}\n\nè¯·é‡æ–°ç™»å½•éªŒè¯æ“ä½œç»“æœã€‚`);
    }
    
    // å¤„ç†å…‹éš†é”™è¯¯
    function handleCloneError(error) {
        const cloneBtn = document.getElementById('clone-btn-clone');
        const cloneStatus = document.getElementById('clone-status');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        
        // æ¸…é™¤è¿›åº¦é—´éš”
        if (progressInterval) {
            clearInterval(progressInterval);
        }
        
        // æ›´æ–°è¿›åº¦æ˜¾ç¤º
        progressBar.style.width = '0%';
        progressText.textContent = 'å…‹éš†æ“ä½œå¤±è´¥';
        
        // æ·»åŠ é”™è¯¯æ—¥å¿—
        addLogEntry(`å…‹éš†å¤±è´¥: ${error.message || 'æœªçŸ¥é”™è¯¯'}`, 'error');
        
        // æ˜¾ç¤ºé”™è¯¯çŠ¶æ€
        showStatus(cloneStatus, `å…‹éš†å¤±è´¥: ${error.message || 'æœªçŸ¥é”™è¯¯'}`, 'error');
        
        // æ¢å¤æŒ‰é’®çŠ¶æ€
        cloneBtn.disabled = false;
        cloneBtn.innerHTML = '<i class="fas fa-clone"></i> å¼€å§‹æ‰§è¡Œ';
        cloneProcessActive = false;
    }
    
    // å…‹éš†é€€å‡ºç™»å½•
    function handleCloneLogout() {
        if (!currentAccount) return;
        
        if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
            // æ¸…ç©ºå½“å‰è´¦å·
            currentAccount = null;
            localStorage.removeItem('cpmcy_account_data');
            
            // éšè—è´¦å·ä¿¡æ¯
            document.getElementById('account-info-section-clone').classList.add('hidden');
            document.getElementById('logout-btn-clone').style.display = 'none';
            document.getElementById('login-section-clone').classList.remove('hidden');
            document.getElementById('clone-section-clone').classList.add('hidden');
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('source-email').value = '';
            document.getElementById('source-password').value = '';
            document.getElementById('custom-localid').value = '';
            document.getElementById('target-email').value = '';
            document.getElementById('target-password').value = '';
            
            // é‡ç½®è¿›åº¦æ¡
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const statusLog = document.getElementById('status-log');
            
            progressBar.style.width = '0%';
            progressText.textContent = 'å‡†å¤‡å¼€å§‹...';
            statusLog.innerHTML = '<div class="log-entry"><i class="fas fa-info-circle"></i> ç³»ç»Ÿå·²å°±ç»ªï¼Œè¯·å…ˆç™»å½•æºè´¦å·</div>';
            
            // æ·»åŠ æ—¥å¿—
            addLogEntry('ç”¨æˆ·å·²é€€å‡ºç™»å½•', 'info');
            
            // æ˜¾ç¤ºçŠ¶æ€
            const cloneStatus = document.getElementById('clone-status');
            showStatus(cloneStatus, 'å·²é€€å‡ºç™»å½•', 'info');
        }
    }
    
    // æ›´æ–°è´¦å·ä¿¡æ¯æ˜¾ç¤º
    function updateAccountDisplay(accountData) {
        document.getElementById('account-name').textContent = accountData.name || 'æœªçŸ¥';
        document.getElementById('account-money').textContent = (accountData.money || 0).toLocaleString() + 'é‡‘å¸';
        document.getElementById('account-cars').textContent = accountData.cars || 0;
        document.getElementById('account-localid').textContent = accountData.localid || 'æœªçŸ¥';
        document.getElementById('account-status').textContent = 'å·²ç™»å½•';
        
        // æ›´æ–°è‡ªå®šä¹‰IDè¾“å…¥æ¡†çš„é»˜è®¤å€¼
        const customIdInput = document.getElementById('custom-localid');
        if (customIdInput && !customIdInput.value) {
            // ç”Ÿæˆä¸€ä¸ªæ¨èçš„Local ID
            const recommendedID = generateRecommendedLocalID(accountData.localid);
            customIdInput.value = recommendedID;
            customIdInput.placeholder = 'æ¨èä½¿ç”¨æ­¤IDæˆ–è‡ªå®šä¹‰';
        }
    }
    
    // æ˜¾ç¤ºè´¦å·ä¿¡æ¯
    function showAccountInfo() {
        document.getElementById('account-info-section-clone').classList.remove('hidden');
        document.getElementById('logout-btn-clone').style.display = 'block';
        document.getElementById('login-section-clone').classList.add('hidden');
        document.getElementById('clone-section-clone').classList.remove('hidden');
    }
    
    // ç”Ÿæˆæ¨èçš„Local ID
    function generateRecommendedLocalID(currentLocalID) {
        if (!currentLocalID || currentLocalID === 'æœªçŸ¥') {
            return generateLocalID();
        }
        
        // åœ¨åŸæœ‰IDåŸºç¡€ä¸Šæ·»åŠ æ—¶é—´æˆ³åç¼€
        const timestamp = Date.now().toString(36);
        return currentLocalID.substring(0, 10) + '_' + timestamp.substring(0, 6);
    }
    
    // ç”ŸæˆéšæœºLocal ID
    function generateLocalID() {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        let result = '';
        const length = 16;
        
        for (let i = 0; i < length; i++) {
            result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        
        return result;
    }
    
    // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
    function showStatus(element, message, type) {
        if (!element) return;
        
        element.textContent = message;
        element.className = 'neon-status';
        
        if (type === 'error') {
            element.classList.add('error');
        } else if (type === 'success') {
            element.classList.add('success');
        } else if (type === 'warning') {
            element.classList.add('admin');
        } else {
            element.classList.add('test-card');
        }
        
        element.style.display = 'block';
        
        // 3ç§’åè‡ªåŠ¨éšè—
        setTimeout(() => {
            element.style.display = 'none';
        }, 3000);
    }
    
    // æ·»åŠ æ—¥å¿—æ¡ç›®
    function addLogEntry(message, type = 'info') {
        const statusLog = document.getElementById('status-log');
        if (!statusLog) return;
        
        const now = new Date().toLocaleTimeString('zh-CN', { hour12: false });
        const logEntry = document.createElement('div');
        logEntry.className = 'log-entry';
        
        let icon = 'info-circle';
        let color = '#6a11cb';
        
        switch (type) {
            case 'success':
                icon = 'check-circle';
                color = '#2ecc71';
                break;
            case 'error':
                icon = 'exclamation-circle';
                color = '#ff416c';
                break;
            case 'warning':
                icon = 'exclamation-triangle';
                color = '#ff9500';
                break;
        }
        
        logEntry.innerHTML = `<i class="fas fa-${icon}" style="color: ${color};"></i> [${now}] ${message}`;
        
        // æ·»åŠ åˆ°æ—¥å¿—é¡¶éƒ¨
        statusLog.insertBefore(logEntry, statusLog.firstChild);
        
        // é™åˆ¶æ—¥å¿—æ•°é‡
        const maxLogs = 20;
        while (statusLog.children.length > maxLogs) {
            statusLog.removeChild(statusLog.lastChild);
        }
    }
    
    // å·¥å…·å‡½æ•°ï¼šæ ¼å¼åŒ–æ—¶é—´
    function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }
    
    // å·¥å…·å‡½æ•°ï¼šéªŒè¯Local IDæ ¼å¼
    function isValidLocalID(localID) {
        if (!localID || localID.length < 10 || localID.length > 20) {
            return false;
        }
        
        // åªèƒ½åŒ…å«å­—æ¯æ•°å­—
        const regex = /^[a-zA-Z0-9]+$/;
        return regex.test(localID);
    }
    
    // å¯¼å‡ºå…¨å±€å‡½æ•°
    window.CPMCloneTool = {
        init: initCloneTool,
        login: handleCloneLogin,
        execute: handleCloneExecute,
        logout: handleCloneLogout,
        getAccount: () => currentAccount,
        isValidLocalID: isValidLocalID,
        generateLocalID: generateLocalID
    };
    
    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
        // å»¶è¿Ÿåˆå§‹åŒ–ä»¥ç¡®ä¿DOMå®Œå…¨åŠ è½½
        setTimeout(initCloneTool, 500);
        
        // åœ¨æ§åˆ¶å°è¾“å‡ºè°ƒè¯•ä¿¡æ¯
        console.log('ğŸš€ CPMå…‹éš†å·¥å…· v2.3 å·²åŠ è½½');
        console.log('ğŸ“– å¯ç”¨å‘½ä»¤:');
        console.log('  - CPMCloneTool.init() - é‡æ–°åˆå§‹åŒ–å·¥å…·');
        console.log('  - CPMCloneTool.login() - æ¨¡æ‹Ÿç™»å½•');
        console.log('  - CPMCloneTool.execute() - æ‰§è¡Œå…‹éš†');
        console.log('  - CPMCloneTool.logout() - é€€å‡ºç™»å½•');
        console.log('  - CPMCloneTool.getAccount() - è·å–å½“å‰è´¦å·ä¿¡æ¯');
    });
    
})();

   <script src="app.js"></script>
</body>
</html>
