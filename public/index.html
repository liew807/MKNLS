<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPMCY - CPM账号克隆工具</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <meta name="author" content="快手Jack">
    
    <!-- 样式保持不变 -->
    <style>
        /* 这里是你之前的完整CSS样式 */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); min-height: 100vh; color: #333; line-height: 1.6; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { background: rgba(255, 255, 255, 0.95); border-radius: 20px; padding: 30px; margin-bottom: 30px; text-align: center; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.3); }
        .header h1 { color: #2c3e50; font-size: 2.5rem; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; gap: 15px; }
        .header h1 i { color: #6a11cb; }
        .subtitle { color: #7f8c8d; font-size: 1.1rem; font-weight: 500; }
        .card { background: rgba(255, 255, 255, 0.9); border-radius: 15px; padding: 30px; margin-bottom: 25px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); transition: all 0.3s ease; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15); }
        .card h2 { color: #34495e; font-size: 1.8rem; margin-bottom: 25px; display: flex; align-items: center; gap: 15px; padding-bottom: 15px; border-bottom: 2px solid #ecf0f1; }
        .card h2 i { color: #6a11cb; }
        .account-details { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 25px; }
        .info-row { background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 18px; border-radius: 10px; border-left: 4px solid #6a11cb; }
        .info-label { display: block; color: #7f8c8d; font-size: 0.9rem; font-weight: 600; margin-bottom: 5px; text-transform: uppercase; }
        .info-value { display: block; color: #2c3e50; font-size: 1.2rem; font-weight: 700; }
        .status-badge { display: inline-block; padding: 6px 15px; border-radius: 50px; font-size: 0.9rem; font-weight: 600; }
        .info-text { color: #7f8c8d; margin-bottom: 20px; font-size: 0.95rem; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; color: #2c3e50; font-weight: 600; margin-bottom: 8px; font-size: 0.95rem; }
        .form-group input { width: 100%; padding: 14px 18px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1rem; transition: all 0.3s ease; background: #f8f9fa; }
        .form-group input:focus { outline: none; border-color: #6a11cb; box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.1); background: white; }
        .operation-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .option-item { position: relative; }
        .option-item input[type="radio"] { display: none; }
        .option-item label { display: block; padding: 20px; background: #f8f9fa; border: 2px solid #e0e0e0; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; }
        .option-item input[type="radio"]:checked + label { border-color: #6a11cb; background: linear-gradient(135deg, #f5f1ff 0%, #e8e0ff 100%); transform: scale(1.02); }
        .option-item label strong { display: block; color: #2c3e50; font-size: 1rem; margin-bottom: 5px; }
        .option-item label small { color: #7f8c8d; font-size: 0.85rem; line-height: 1.4; }
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 10px; padding: 15px 30px; border: none; border-radius: 10px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-top: 10px; }
        .btn i { font-size: 1.1rem; }
        .btn-primary { background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); color: white; box-shadow: 0 8px 20px rgba(106, 17, 203, 0.2); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 12px 25px rgba(106, 17, 203, 0.3); }
        .btn-secondary { background: linear-gradient(135deg, #7f8c8d 0%, #95a5a6 100%); color: white; box-shadow: 0 8px 20px rgba(127, 140, 141, 0.2); }
        .btn-secondary:hover { transform: translateY(-2px); box-shadow: 0 12px 25px rgba(127, 140, 141, 0.3); }
        .btn-danger { background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%); color: white; box-shadow: 0 8px 20px rgba(255, 65, 108, 0.2); }
        .btn-danger:hover { transform: translateY(-2px); box-shadow: 0 12px 25px rgba(255, 65, 108, 0.3); }
        .warning { background: linear-gradient(135deg, #fff5f5 0%, #ffeaea 100%); border: 2px solid #ffcccc; color: #e74c3c; padding: 18px; border-radius: 10px; margin: 20px 0; display: flex; align-items: center; gap: 12px; }
        .time-warning { background: linear-gradient(135deg, #fffaf0 0%, #fff5e6 100%); border: 2px solid #ffd699; color: #f39c12; padding: 18px; border-radius: 10px; margin: 20px 0; display: flex; align-items: center; gap: 12px; }
        .warning i, .time-warning i { font-size: 1.2rem; }
        .progress-container { background: #f0f3f5; border-radius: 10px; height: 20px; overflow: hidden; margin: 20px 0; position: relative; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, #6a11cb 0%, #2575fc 100%); width: 0%; transition: width 0.4s ease; position: relative; }
        .progress-bar::after { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(90deg, transparent 25%, rgba(255, 255, 255, 0.2) 50%, transparent 75%); animation: shimmer 2s infinite; }
        @keyframes shimmer { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        .progress-text { text-align: center; margin: 10px 0; color: #34495e; font-weight: 600; }
        .time-estimate { text-align: center; color: #7f8c8d; font-size: 0.9rem; margin-bottom: 15px; }
        .status-log { background: #f8f9fa; border-radius: 10px; padding: 15px; max-height: 300px; overflow-y: auto; border: 1px solid #e0e0e0; }
        .log-entry { padding: 10px 12px; border-bottom: 1px solid #eee; color: #2c3e50; display: flex; align-items: center; gap: 10px; }
        .log-entry:last-child { border-bottom: none; }
        .log-entry i { color: #6a11cb; }
        .account-logs-container { margin-top: 25px; }
        .logs-controls { display: flex; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; }
        .logs-filter { padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.9rem; background: white; min-width: 150px; }
        .logs-search { flex: 1; padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.9rem; background: white; }
        .logs-container { background: white; border-radius: 10px; border: 1px solid #e0e0e0; max-height: 500px; overflow-y: auto; margin-top: 10px; }
        .log-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        .log-table th { background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 12px 15px; text-align: left; color: #2c3e50; font-weight: 600; border-bottom: 2px solid #dee2e6; position: sticky; top: 0; }
        .log-table td { padding: 12px 15px; border-bottom: 1px solid #e0e0e0; }
        .log-table tr:hover { background-color: #f8f9fa; }
        .log-type { padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
        .log-type-login { background-color: #e3f2fd; color: #1976d2; }
        .log-type-purchase { background-color: #e8f5e8; color: #388e3c; }
        .log-type-game { background-color: #fff3e0; color: #f57c00; }
        .log-type-error { background-color: #ffebee; color: #d32f2f; }
        .log-type-system { background-color: #f3e5f5; color: #7b1fa2; }
        .log-type-info { background-color: #e0f7fa; color: #0097a7; }
        .log-datetime { font-family: monospace; color: #6c757d; font-size: 0.85rem; }
        .log-message { color: #495057; line-height: 1.4; }
        .log-ip { font-family: monospace; color: #6c757d; font-size: 0.85rem; }
        .logs-stats { display: flex; gap: 20px; margin-bottom: 15px; flex-wrap: wrap; }
        .stat-item { display: flex; align-items: center; gap: 8px; }
        .stat-value { font-weight: 700; color: #2c3e50; }
        .stat-label { color: #6c757d; font-size: 0.9rem; }
        .export-btn { padding: 8px 16px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; }
        .export-btn:hover { background: linear-gradient(135deg, #218838 0%, #1aa179 100%); }
        .instructions ol { padding-left: 20px; margin-bottom: 20px; }
        .instructions li { margin-bottom: 12px; color: #2c3e50; }
        .instructions li b { color: #6a11cb; }
        .note { background: linear-gradient(135deg, #f0fff4 0%, #e8ffe8 100%); border: 2px solid #b6e3b6; color: #27ae60; padding: 18px; border-radius: 10px; margin: 15px 0; display: flex; align-items: center; gap: 12px; }
        .note i { color: #2ecc71; }
        .author-info { background: linear-gradient(135deg, #f9f0ff 0%, #f0e6ff 100%); border: 2px solid #d9c9f9; color: #8e44ad; padding: 18px; border-radius: 10px; display: flex; align-items: center; gap: 12px; font-weight: 600; margin-top: 20px; }
        .author-info i { color: #9b59b6; }
        .footer { text-align: center; color: white; padding: 25px 0; margin-top: 30px; }
        .footer p { margin-bottom: 8px; opacity: 0.9; }
        .disclaimer { font-size: 0.85rem; opacity: 0.7; max-width: 800px; margin: 0 auto; }
        .status { padding: 12px 15px; border-radius: 8px; margin-top: 15px; font-weight: 500; }
        .hidden { display: none !important; }
        @media (max-width: 768px) { body { padding: 15px; } .header h1 { font-size: 2rem; flex-direction: column; gap: 10px; } .card { padding: 20px; } .card h2 { font-size: 1.5rem; } .account-details { grid-template-columns: 1fr; } .operation-options { grid-template-columns: 1fr; } .btn { width: 100%; } .logs-controls { flex-direction: column; } .logs-search { width: 100%; } .log-table { font-size: 0.8rem; } .log-table th, .log-table td { padding: 8px 10px; } }
        @media (max-width: 480px) { .header { padding: 20px; } .card { padding: 18px; } .info-value { font-size: 1.1rem; } }
    </style>
</head>

<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-user-shield"></i> CPMCY- CPM账号数据克隆工具</h1>
            <p class="subtitle">快手Jack制作 | 克隆CPM账号数据到其他账号</p>
        </header>

        <!-- 账号信息展示区 -->
        <div class="card hidden" id="account-info-section">
            <h2><i class="fas fa-user-circle"></i> 当前账号信息</h2>
            <div class="account-details">
                <div class="info-row">
                    <span class="info-label">账号昵称:</span>
                    <span class="info-value" id="account-name">--</span>
                </div>
                <div class="info-row">
                    <span class="info-label">游戏金币:</span>
                    <span class="info-value" id="account-money">--</span>
                </div>
                <div class="info-row">
                    <span class="info-label">车辆数量:</span>
                    <span class="info-value" id="account-cars">--</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Local ID:</span>
                    <span class="info-value" id="account-localid">--</span>
                </div>
                <div class="info-row">
                    <span class="info-label">账号状态:</span>
                    <span class="info-value status-badge" id="account-status">未登录</span>
                </div>
                <div class="info-row">
                    <span class="info-label">账号等级:</span>
                    <span class="info-value" id="account-level">--</span>
                </div>
                <div class="info-row">
                    <span class="info-label">创建时间:</span>
                    <span class="info-value" id="account-created">--</span>
                </div>
            </div>
            <button id="logout-btn" class="btn btn-secondary">
                <i class="fas fa-sign-out-alt"></i> 退出登录
            </button>
            
            <!-- 账号日志查看部分 -->
            <div class="account-logs-container">
                <h3><i class="fas fa-history"></i> 账号日志记录</h3>
                <div class="logs-stats">
                    <div class="stat-item">
                        <span class="stat-label">日志总数:</span>
                        <span class="stat-value" id="logs-total">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">最近登录:</span>
                        <span class="stat-value" id="logs-last-login">--</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">登录次数:</span>
                        <span class="stat-value" id="logs-login-count">0</span>
                    </div>
                </div>
                <div class="logs-controls">
                    <select class="logs-filter" id="logs-filter-type">
                        <option value="all">所有类型</option>
                        <option value="login">登录记录</option>
                        <option value="purchase">购买记录</option>
                        <option value="game">游戏记录</option>
                        <option value="error">错误记录</option>
                        <option value="system">系统记录</option>
                        <option value="info">信息记录</option>
                    </select>
                    <input type="text" class="logs-search" id="logs-search" placeholder="搜索日志内容...">
                    <button class="export-btn" id="export-logs-btn">
                        <i class="fas fa-download"></i> 导出日志
                    </button>
                    <button class="export-btn" id="refresh-logs-btn" style="background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);">
                        <i class="fas fa-sync-alt"></i> 刷新日志
                    </button>
                </div>
                <div class="logs-container">
                    <table class="log-table" id="logs-table">
                        <thead>
                            <tr>
                                <th width="120">时间</th>
                                <th width="100">类型</th>
                                <th>日志内容</th>
                                <th width="150">IP地址</th>
                                <th width="100">设备</th>
                            </tr>
                        </thead>
                        <tbody id="logs-body">
                            <!-- 日志内容将通过JavaScript动态生成 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 登录部分 -->
        <div class="card" id="login-section">
            <h2><i class="fas fa-sign-in-alt"></i> 第一步：源账号登录</h2>
            <p class="info-text">请登录要被克隆的源账号（你的主账号）</p>
            <div class="form-group">
                <label for="source-email">邮箱地址</label>
                <input type="email" id="source-email" placeholder="输入CPM账号邮箱" required>
            </div>
            <div class="form-group">
                <label for="source-password">密码</label>
                <input type="password" id="source-password" placeholder="输入CPM账号密码" required>
            </div>
            <div class="form-group">
                <label>API服务器地址</label>
                <select id="api-server" class="logs-filter">
                    <option value="https://api.cpmcy.com/v1">主服务器 (api.cpmcy.com)</option>
                    <option value="https://api-backup.cpmcy.com/v1">备用服务器</option>
                    <option value="http://localhost:3000/api">本地测试服务器</option>
                    <option value="custom">自定义服务器</option>
                </select>
                <input type="text" id="custom-api-server" class="hidden" placeholder="输入自定义API地址 (例如: https://your-api.com/v1)" style="margin-top: 10px;">
            </div>
            <button id="login-btn" class="btn btn-primary">
                <i class="fas fa-key"></i> 登录并验证账号
            </button>
            <div id="login-status" class="status"></div>
            
            <div class="time-warning">
                <i class="fas fa-server"></i>
                <strong>API状态:</strong> <span id="api-status">未连接</span>
            </div>
        </div>

        <!-- 克隆部分 -->
        <div class="card hidden" id="clone-section">
            <h2><i class="fas fa-clone"></i> 第二步：选择操作类型</h2>
            
            <div class="form-group">
                <label for="operation-type">选择操作类型</label>
                <div class="operation-options">
                    <div class="option-item">
                        <input type="radio" id="op-type1" name="operation-type" value="modify-id" checked>
                        <label for="op-type1">
                            <strong>选项1：修改当前账号ID</strong><br>
                            <small>仅修改当前登录账号的Local ID，其他数据不变</small>
                        </label>
                    </div>
                    <div class="option-item">
                        <input type="radio" id="op-type2" name="operation-type" value="clone-to-new">
                        <label for="op-type2">
                            <strong>选项2：克隆到新账号</strong><br>
                            <small>复制当前账号所有数据到另一个账号（覆盖目标账号）</small>
                        </label>
                    </div>
                    <div class="option-item">
                        <input type="radio" id="op-type3" name="operation-type" value="backup-account">
                        <label for="op-type3">
                            <strong>选项3：备份当前账号</strong><br>
                            <small>创建当前账号的完整备份</small>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="form-group" id="custom-id-group">
                <label for="custom-localid">自定义新的Local ID</label>
                <input type="text" id="custom-localid" placeholder="输入新的Local ID（字母数字，建议10-20位）" required>
            </div>
            
            <div id="target-credentials" class="hidden">
                <div class="form-group">
                    <label for="target-email">目标账号邮箱</label>
                    <input type="email" id="target-email" placeholder="输入目标账号邮箱">
                </div>
                <div class="form-group">
                    <label for="target-password">目标账号密码</label>
                    <input type="password" id="target-password" placeholder="输入目标账号密码">
                </div>
            </div>
            
            <div id="backup-options" class="hidden">
                <div class="form-group">
                    <label for="backup-name">备份名称</label>
                    <input type="text" id="backup-name" placeholder="输入备份名称（可选）">
                </div>
                <div class="form-group">
                    <label for="backup-description">备份描述</label>
                    <textarea id="backup-description" placeholder="输入备份描述（可选）" rows="3" style="width:100%; padding: 14px 18px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1rem; background: #f8f9fa;"></textarea>
                </div>
            </div>
            
            <div class="warning">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>警告：</strong> 这将覆盖目标账号的所有数据！请谨慎操作！
            </div>
            
            <div class="time-warning">
                <i class="fas fa-clock"></i>
                <strong>注意：</strong> 克隆过程可能需要2-5分钟，请勿关闭页面！
            </div>
            
            <button id="clone-btn" class="btn btn-danger">
                <i class="fas fa-clone"></i> 开始执行
            </button>
            <div id="clone-status" class="status"></div>
        </div>

        <!-- 状态显示部分 -->
        <div class="card" id="status-section">
            <h2><i class="fas fa-info-circle"></i> 克隆进度状态</h2>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
                <div class="progress-text" id="progress-text">准备开始...</div>
            </div>
            <div class="time-estimate" id="time-estimate">预计时间: --</div>
            <div class="status-log" id="status-log">
                <div class="log-entry"><i class="fas fa-info-circle"></i> 系统已就绪，请先登录源账号</div>
            </div>
            
            <div class="time-warning">
                <i class="fas fa-database"></i>
                <strong>服务器信息:</strong> 
                <span id="server-info">未连接到服务器</span>
            </div>
        </div>

        <!-- 使用说明 -->
        <div class="card instructions">
            <h2><i class="fas fa-question-circle"></i> 使用说明</h2>
            <ol>
                <li>使用<b>源账号</b>（你要克隆的主账号）登录</li>
                <li>系统会显示账号的详细信息</li>
                <li>选择操作类型：修改当前账号ID 或 克隆到新账号</li>
                <li>输入自定义Local ID</li>
                <li>如选择克隆到新账号，输入目标账号凭据</li>
                <li><b>重要：</b>克隆过程中不要关闭浏览器！</li>
            </ol>
            <p class="note"><i class="fas fa-lightbulb"></i> <strong>提示：</strong> 克隆时间取决于车辆数量，通常需要2-5分钟。</p>
            <div class="author-info">
                <i class="fas fa-user-tie"></i> 开发者：快手Jack | API版本: v1.2.0
            </div>
        </div>

        <footer class="footer">
            <p>CPMCY 账号克隆工具 v2.3 | 快手Jack制作</p>
            <p class="disclaimer">仅供学习交流使用，请勿用于非法用途。使用本工具造成的任何问题，作者概不负责。</p>
            <p class="disclaimer">API状态: <span id="api-status-footer">离线</span> | 最后更新: <span id="last-update">--</span></p>
        </footer>
    </div>

    <!-- 这里是完整的 app.js 代码，包含后端API调用 -->
    <script>
        // app.js - CPMCY 账号克隆工具
        // 版本: 2.3
        // 作者: 快手Jack
        
        // 全局变量
        let currentAccount = null;
        let accountLogs = [];
        let cloneProgress = 0;
        let isCloning = false;
        let authToken = null;
        let apiBaseUrl = 'https://api.cpmcy.com/v1';
        let sessionId = generateSessionId();
        
        // DOM 元素引用
        const accountInfoSection = document.getElementById('account-info-section');
        const loginSection = document.getElementById('login-section');
        const cloneSection = document.getElementById('clone-section');
        const loginBtn = document.getElementById('login-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const loginStatus = document.getElementById('login-status');
        const cloneBtn = document.getElementById('clone-btn');
        const cloneStatus = document.getElementById('clone-status');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const timeEstimate = document.getElementById('time-estimate');
        const statusLog = document.getElementById('status-log');
        const apiServerSelect = document.getElementById('api-server');
        const customApiServer = document.getElementById('custom-api-server');
        const apiStatus = document.getElementById('api-status');
        const apiStatusFooter = document.getElementById('api-status-footer');
        const serverInfo = document.getElementById('server-info');
        const lastUpdate = document.getElementById('last-update');
        
        // 日志相关元素
        const logsBody = document.getElementById('logs-body');
        const logsTotal = document.getElementById('logs-total');
        const logsLastLogin = document.getElementById('logs-last-login');
        const logsLoginCount = document.getElementById('logs-login-count');
        const logsFilterType = document.getElementById('logs-filter-type');
        const logsSearch = document.getElementById('logs-search');
        const exportLogsBtn = document.getElementById('export-logs-btn');
        const refreshLogsBtn = document.getElementById('refresh-logs-btn');
        
        // 操作类型选择
        const operationTypeRadios = document.querySelectorAll('input[name="operation-type"]');
        const targetCredentials = document.getElementById('target-credentials');
        const backupOptions = document.getElementById('backup-options');
        
        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            initEventListeners();
            clearLogsTable();
            updateTimeEstimate();
            checkApiStatus();
            updateLastUpdateTime();
        });
        
        // 初始化事件监听器
        function initEventListeners() {
            // 登录按钮
            loginBtn.addEventListener('click', handleLogin);
            
            // 退出登录
            logoutBtn.addEventListener('click', handleLogout);
            
            // 克隆按钮
            cloneBtn.addEventListener('click', handleClone);
            
            // 操作类型选择
            operationTypeRadios.forEach(radio => {
                radio.addEventListener('change', handleOperationTypeChange);
            });
            
            // API服务器选择
            apiServerSelect.addEventListener('change', handleApiServerChange);
            customApiServer.addEventListener('input', handleCustomApiServerInput);
            
            // 日志过滤功能
            logsFilterType.addEventListener('change', filterLogs);
            logsSearch.addEventListener('input', filterLogs);
            
            // 导出日志功能
            exportLogsBtn.addEventListener('click', exportLogs);
            
            // 刷新日志功能
            refreshLogsBtn.addEventListener('click', () => {
                if (currentAccount) {
                    fetchAccountLogs();
                }
            });
            
            // 回车键登录
            document.getElementById('source-password').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleLogin();
            });
            
            // 保存API服务器设置到本地存储
            window.addEventListener('beforeunload', () => {
                if (apiBaseUrl) {
                    localStorage.setItem('cpmcy_api_server', apiBaseUrl);
                }
            });
        }
        
        // 处理API服务器变更
        function handleApiServerChange() {
            const selectedValue = apiServerSelect.value;
            
            if (selectedValue === 'custom') {
                customApiServer.classList.remove('hidden');
                const savedServer = localStorage.getItem('cpmcy_custom_api_server');
                if (savedServer) {
                    customApiServer.value = savedServer;
                    apiBaseUrl = savedServer;
                }
            } else {
                customApiServer.classList.add('hidden');
                apiBaseUrl = selectedValue;
                checkApiStatus();
            }
        }
        
        // 处理自定义API服务器输入
        function handleCustomApiServerInput() {
            apiBaseUrl = customApiServer.value;
            localStorage.setItem('cpmcy_custom_api_server', apiBaseUrl);
            if (apiBaseUrl) {
                checkApiStatus();
            }
        }
        
        // 检查API状态
        async function checkApiStatus() {
            updateApiStatus('检查中...', 'warning');
            
            try {
                const response = await fetchWithTimeout(`${apiBaseUrl}/health`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Session-ID': sessionId
                    }
                }, 5000);
                
                if (response.ok) {
                    const data = await response.json();
                    updateApiStatus('在线', 'success');
                    updateServerInfo(data);
                } else {
                    updateApiStatus('离线', 'error');
                }
            } catch (error) {
                console.error('API检查失败:', error);
                updateApiStatus('连接失败', 'error');
            }
        }
        
        // 更新API状态显示
        function updateApiStatus(status, type = 'info') {
            apiStatus.textContent = status;
            apiStatusFooter.textContent = status;
            
            const colors = {
                'success': '#28a745',
                'error': '#dc3545',
                'warning': '#ffc107',
                'info': '#17a2b8'
            };
            
            apiStatusFooter.style.color = colors[type] || colors.info;
        }
        
        // 更新服务器信息
        function updateServerInfo(data) {
            if (data && data.server) {
                serverInfo.textContent = `${data.server.name} | 版本: ${data.server.version} | 在线用户: ${data.server.activeUsers}`;
            }
        }
        
        // 更新最后更新时间
        function updateLastUpdateTime() {
            const now = new Date();
            lastUpdate.textContent = now.toLocaleString('zh-CN');
        }
        
        // 处理登录
        async function handleLogin() {
            const email = document.getElementById('source-email').value;
            const password = document.getElementById('source-password').value;
            
            if (!email || !password) {
                showLoginStatus('请输入邮箱和密码', 'error');
                return;
            }
            
            showLoginStatus('正在登录并获取账号信息...', 'info');
            updateProgress(10, '连接到API服务器...');
            
            try {
                // 调用真实登录API
                const loginData = await apiLogin(email, password);
                
                if (loginData.success) {
                    // 保存认证令牌
                    authToken = loginData.token;
                    currentAccount = loginData.account;
                    
                    // 更新账号信息显示
                    updateAccountInfo();
                    showLoginStatus('登录成功！正在获取账号日志...', 'success');
                    
                    // 显示账号信息区和克隆区
                    accountInfoSection.classList.remove('hidden');
                    cloneSection.classList.remove('hidden');
                    loginSection.classList.add('hidden');
                    
                    // 获取账号日志
                    await fetchAccountLogs();
                    
                    // 添加登录日志
                    addLog('login', `账号登录成功 - ${email}`, 'api');
                    
                    updateProgress(100, '登录完成');
                } else {
                    showLoginStatus(`登录失败: ${loginData.message}`, 'error');
                    updateProgress(0, '登录失败');
                }
            } catch (error) {
                console.error('登录错误:', error);
                showLoginStatus('登录失败：网络错误或服务器无响应', 'error');
                updateProgress(0, '登录失败');
            }
        }
        
        // API登录函数
        async function apiLogin(email, password) {
            const response = await fetchWithTimeout(`${apiBaseUrl}/auth/login`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Session-ID': sessionId
                },
                body: JSON.stringify({
                    email: email,
                    password: password,
                    device: getDeviceInfo()
                })
            }, 10000);
            
            if (!response.ok) {
                throw new Error(`HTTP错误: ${response.status}`);
            }
            
            return await response.json();
        }
        
        // 更新账号信息显示
        function updateAccountInfo() {
            if (!currentAccount) return;
            
            document.getElementById('account-name').textContent = currentAccount.name || '--';
            document.getElementById('account-money').textContent = formatNumber(currentAccount.money || 0);
            document.getElementById('account-cars').textContent = currentAccount.cars || 0;
            document.getElementById('account-localid').textContent = currentAccount.localId || '--';
            document.getElementById('account-level').textContent = currentAccount.level || '--';
            document.getElementById('account-created').textContent = currentAccount.createdAt ? 
                new Date(currentAccount.createdAt).toLocaleDateString('zh-CN') : '--';
            
            const statusElement = document.getElementById('account-status');
            statusElement.textContent = '已登录';
            statusElement.style.background = 'linear-gradient(135deg, #2ecc71 0%, #27ae60 100%)';
            statusElement.style.color = 'white';
        }
        
        // 处理退出登录
        async function handleLogout() {
            try {
                // 调用API登出
                if (authToken) {
                    await apiLogout();
                }
            } catch (error) {
                console.error('登出错误:', error);
            }
            
            // 清理本地状态
            currentAccount = null;
            authToken = null;
            accountLogs = [];
            
            // 隐藏账号信息区和克隆区
            accountInfoSection.classList.add('hidden');
            cloneSection.classList.add('hidden');
            loginSection.classList.remove('hidden');
            
            // 清空输入框
            document.getElementById('source-email').value = '';
            document.getElementById('source-password').value = '';
            document.getElementById('custom-localid').value = '';
            document.getElementById('target-email').value = '';
            document.getElementById('target-password').value = '';
            document.getElementById('backup-name').value = '';
            document.getElementById('backup-description').value = '';
            
            // 清空状态
            loginStatus.innerHTML = '';
            cloneStatus.innerHTML = '';
            clearLogsTable();
            resetProgress();
            
            // 添加系统日志
            addStatusLog('用户已退出登录', 'info');
        }
        
        // API登出函数
        async function apiLogout() {
            const response = await fetch(`${apiBaseUrl}/auth/logout`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${authToken}`,
                    'X-Session-ID': sessionId
                }
            });
            
            return await response.json();
        }
        
        // 处理操作类型变更
        function handleOperationTypeChange(e) {
            const value = e.target.value;
            
            // 隐藏所有选项区域
            targetCredentials.classList.add('hidden');
            backupOptions.classList.add('hidden');
            
            // 显示对应的选项区域
            if (value === 'clone-to-new') {
                targetCredentials.classList.remove('hidden');
            } else if (value === 'backup-account') {
                backupOptions.classList.remove('hidden');
            }
        }
        
        // 处理克隆操作
        async function handleClone() {
            if (isCloning) {
                showCloneStatus('克隆操作正在进行中，请等待完成...', 'warning');
                return;
            }
            
            const operationType = document.querySelector('input[name="operation-type"]:checked').value;
            const customLocalId = document.getElementById('custom-localid').value;
            
            // 验证输入
            if (operationType !== 'backup-account' && (!customLocalId || customLocalId.length < 10)) {
                showCloneStatus('请输入有效的Local ID（至少10位）', 'error');
                return;
            }
            
            if (operationType === 'clone-to-new') {
                const targetEmail = document.getElementById('target-email').value;
                const targetPassword = document.getElementById('target-password').value;
                
                if (!targetEmail || !targetPassword) {
                    showCloneStatus('请输入目标账号的邮箱和密码', 'error');
                    return;
                }
            }
            
            // 开始克隆
            isCloning = true;
            cloneProgress = 0;
            showCloneStatus('开始克隆操作...', 'info');
            
            try {
                // 根据操作类型执行不同的克隆逻辑
                if (operationType === 'modify-id') {
                    await modifyAccountId(customLocalId);
                } else if (operationType === 'clone-to-new') {
                    await cloneToNewAccount(customLocalId);
                } else if (operationType === 'backup-account') {
                    await backupCurrentAccount();
                }
                
                showCloneStatus('操作完成！', 'success');
            } catch (error) {
                console.error('克隆操作失败:', error);
                showCloneStatus(`操作失败: ${error.message}`, 'error');
            } finally {
                isCloning = false;
            }
        }
        
        // 修改账号ID - 调用真实API
        async function modifyAccountId(newLocalId) {
            updateProgress(10, '正在验证新Local ID...');
            addStatusLog('开始修改账号Local ID', 'info');
            
            try {
                const response = await fetch(`${apiBaseUrl}/account/modify-id`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`,
                        'X-Session-ID': sessionId
                    },
                    body: JSON.stringify({
                        newLocalId: newLocalId,
                        reason: '用户手动修改'
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP错误: ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.success) {
                    updateProgress(100, 'Local ID修改完成！');
                    
                    // 更新显示的Local ID
                    if (currentAccount) {
                        currentAccount.localId = newLocalId;
                        document.getElementById('account-localid').textContent = newLocalId;
                    }
                    
                    // 添加系统日志
                    addLog('system', `账号Local ID修改为: ${newLocalId}`, 'api');
                    addStatusLog('Local ID修改操作完成', 'success');
                    
                    return result;
                } else {
                    throw new Error(result.message || '修改失败');
                }
            } catch (error) {
                updateProgress(0, '修改失败');
                throw error;
            }
        }
        
        // 克隆到新账号 - 调用真实API
        async function cloneToNewAccount(newLocalId) {
            const targetEmail = document.getElementById('target-email').value;
            const targetPassword = document.getElementById('target-password').value;
            
            updateProgress(5, '正在连接CPM服务器...');
            addStatusLog('开始克隆账号数据', 'info');
            
            try {
                const response = await fetch(`${apiBaseUrl}/account/clone`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`,
                        'X-Session-ID': sessionId
                    },
                    body: JSON.stringify({
                        sourceAccountId: currentAccount.id,
                        targetEmail: targetEmail,
                        targetPassword: targetPassword,
                        newLocalId: newLocalId,
                        options: {
                            cloneCars: true,
                            cloneMoney: true,
                            cloneItems: true,
                            cloneProgress: true
                        }
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP错误: ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.success) {
                    updateProgress(100, '账号克隆完成！');
                    
                    // 添加系统日志
                    addLog('system', `账号数据克隆到: ${targetEmail} (新Local ID: ${newLocalId})`, 'api');
                    addStatusLog('账号克隆操作完成', 'success');
                    
                    return result;
                } else {
                    throw new Error(result.message || '克隆失败');
                }
            } catch (error) {
                updateProgress(0, '克隆失败');
                throw error;
            }
        }
        
        // 备份当前账号 - 调用真实API
        async function backupCurrentAccount() {
            const backupName = document.getElementById('backup-name').value || `备份_${new Date().toISOString().split('T')[0]}`;
            const backupDescription = document.getElementById('backup-description').value || '用户手动备份';
            
            updateProgress(10, '正在创建备份...');
            addStatusLog('开始备份账号数据', 'info');
            
            try {
                const response = await fetch(`${apiBaseUrl}/account/backup`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`,
                        'X-Session-ID': sessionId
                    },
                    body: JSON.stringify({
                        accountId: currentAccount.id,
                        backupName: backupName,
                        description: backupDescription,
                        includeData: {
                            cars: true,
                            money: true,
                            items: true,
                            settings: true,
                            progress: true
                        }
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP错误: ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.success) {
                    updateProgress(100, '备份创建完成！');
                    
                    // 添加系统日志
                    addLog('system', `账号备份创建: ${backupName}`, 'api');
                    addStatusLog('账号备份操作完成', 'success');
                    
                    showCloneStatus(`备份创建成功！备份ID: ${result.backupId}`, 'success');
                    return result;
                } else {
                    throw new Error(result.message || '备份失败');
                }
            } catch (error) {
                updateProgress(0, '备份失败');
                throw error;
            }
        }
        
        // 获取账号日志 - 调用真实API
        async function fetchAccountLogs() {
            showLoginStatus('正在获取账号日志...', 'info');
            
            try {
                const response = await fetch(`${apiBaseUrl}/account/logs`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`,
                        'X-Session-ID': sessionId
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP错误: ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.success) {
                    accountLogs = result.logs || [];
                    
                    // 更新日志统计
                    updateLogsStats();
                    
                    // 渲染日志表格
                    renderLogsTable();
                    
                    showLoginStatus('账号日志加载完成！', 'success');
                    addStatusLog('账号日志已加载', 'success');
                    updateLastUpdateTime();
                    
                    return result;
                } else {
                    throw new Error(result.message || '获取日志失败');
                }
            } catch (error) {
                console.error('获取日志失败:', error);
                showLoginStatus('获取日志失败，使用模拟数据', 'warning');
                
                // 如果API失败，使用模拟数据
                generateMockLogs();
                updateLogsStats();
                renderLogsTable();
            }
        }
        
        // 更新进度条
        function updateProgress(percent, message) {
            cloneProgress = percent;
            progressBar.style.width = `${percent}%`;
            progressText.textContent = message;
            updateTimeEstimate();
            
            // 添加状态日志
            addStatusLog(message, 'info');
        }
        
        // 重置进度
        function resetProgress() {
            cloneProgress = 0;
            progressBar.style.width = '0%';
            progressText.textContent = '准备开始...';
            timeEstimate.textContent = '预计时间: --';
        }
        
        // 更新时间估计
        function updateTimeEstimate() {
            const remaining = 100 - cloneProgress;
            let estimate = Math.ceil(remaining / 5);
            
            if (cloneProgress === 0) {
                timeEstimate.textContent = '预计时间: --';
            } else if (cloneProgress === 100) {
                timeEstimate.textContent = '预计时间: 完成';
            } else {
                timeEstimate.textContent = `预计时间: 约${estimate}分钟`;
            }
        }
        
        // 添加状态日志
        function addStatusLog(message, type = 'info') {
            const icon = getLogIcon(type);
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `<i class="${icon}"></i> ${message}`;
            
            statusLog.appendChild(entry);
            statusLog.scrollTop = statusLog.scrollHeight;
        }
        
        // 添加日志记录
        function addLog(type, message, source = 'local') {
            const logEntry = {
                id: accountLogs.length + 1,
                timestamp: new Date(),
                type: type,
                message: message,
                ip: generateRandomIP(),
                device: getDeviceInfo(),
                source: source
            };
            
            accountLogs.unshift(logEntry);
            updateLogsStats();
            filterLogs();
        }
        
        // 获取设备信息
        function getDeviceInfo() {
            const ua = navigator.userAgent;
            let device = 'Unknown';
            
            if (ua.match(/Android/i)) device = 'Android';
            else if (ua.match(/iPhone|iPad|iPod/i)) device = 'iOS';
            else if (ua.match(/Windows/i)) device = 'Windows';
            else if (ua.match(/Mac/i)) device = 'Mac';
            else if (ua.match(/Linux/i)) device = 'Linux';
            
            return `${device} - ${navigator.platform}`;
        }
        
        // 渲染日志表格
        function renderLogsTable(filteredLogs = accountLogs) {
            logsBody.innerHTML = '';
            
            if (filteredLogs.length === 0) {
                logsBody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 30px; color: #6c757d;">没有找到相关日志记录</td></tr>';
                return;
            }
            
            filteredLogs.forEach(log => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="log-datetime">${formatDateTime(log.timestamp)}</td>
                    <td><span class="log-type log-type-${log.type}">${getLogTypeText(log.type)}</span></td>
                    <td class="log-message">${log.message}</td>
                    <td class="log-ip">${log.ip}</td>
                    <td>${log.device || '--'}</td>
                `;
                logsBody.appendChild(row);
            });
        }
        
        // 更新日志统计信息
        function updateLogsStats() {
            logsTotal.textContent = accountLogs.length;
            
            // 计算登录次数
            const loginLogs = accountLogs.filter(log => log.type === 'login');
            logsLoginCount.textContent = loginLogs.length;
            
            // 获取最近登录时间
            if (loginLogs.length > 0) {
                logsLastLogin.textContent = formatDateTime(loginLogs[0].timestamp);
            } else {
                logsLastLogin.textContent = '无记录';
            }
        }
        
        // 清除日志表格
        function clearLogsTable() {
            logsBody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 30px; color: #6c757d;">请先登录账号查看日志</td></tr>';
            logsTotal.textContent = '0';
            logsLastLogin.textContent = '--';
            logsLoginCount.textContent = '0';
        }
        
        // 日志过滤功能
        function filterLogs() {
            const typeFilter = logsFilterType.value;
            const searchText = logsSearch.value.toLowerCase();
            
            let filteredLogs = accountLogs;
            
            // 按类型过滤
            if (typeFilter !== 'all') {
                filteredLogs = filteredLogs.filter(log => log.type === typeFilter);
            }
            
            // 按搜索文本过滤
            if (searchText) {
                filteredLogs = filteredLogs.filter(log => 
                    log.message.toLowerCase().includes(searchText) ||
                    log.ip.toLowerCase().includes(searchText) ||
                    (log.device && log.device.toLowerCase().includes(searchText))
                );
            }
            
            // 更新统计和渲染
            logsTotal.textContent = filteredLogs.length;
            renderLogsTable(filteredLogs);
        }
        
        // 导出日志功能
        function exportLogs() {
            if (accountLogs.length === 0) {
                alert('没有日志可以导出！');
                return;
            }
            
            const csvContent = generateCSV();
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `cpm_account_logs_${formatDateForFilename(new Date())}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert(`日志已导出，共 ${accountLogs.length} 条记录`);
            addStatusLog('账号日志已导出为CSV文件', 'success');
        }
        
        // 生成CSV文件内容
        function generateCSV() {
            const headers = ['时间', '类型', '日志内容', 'IP地址', '设备信息', '数据来源'];
            const rows = accountLogs.map(log => [
                formatDateTime(log.timestamp),
                getLogTypeText(log.type),
                log.message,
                log.ip,
                log.device || 'N/A',
                log.source || 'local'
            ]);
            
            const csvRows = [
                headers.join(','),
                ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
            ];
            
            return csvRows.join('\n');
        }
        
        // 显示状态消息
        function showLoginStatus(message, type = 'info') {
            updateStatus(loginStatus, message, type);
        }
        
        function showCloneStatus(message, type = 'info') {
            updateStatus(cloneStatus, message, type);
        }
        
        function updateStatus(element, message, type) {
            element.textContent = message;
            element.className = 'status';
            
            const styles = {
                'success': { bg: '#d4edda', color: '#155724', border: '#c3e6cb' },
                'error': { bg: '#f8d7da', color: '#721c24', border: '#f5c6cb' },
                'warning': { bg: '#fff3cd', color: '#856404', border: '#ffeaa7' },
                'info': { bg: '#d1ecf1', color: '#0c5460', border: '#bee5eb' }
            };
            
            const style = styles[type] || styles.info;
            element.style.backgroundColor = style.bg;
            element.style.color = style.color;
            element.style.border = `1px solid ${style.border}`;
        }
        
        // 辅助函数
        function formatDateTime(date) {
            if (!date) return '--';
            if (typeof date === 'string') date = new Date(date);
            return date.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        }
        
        function formatDateForFilename(date) {
            return date.toISOString().split('T')[0].replace(/-/g, '');
        }
        
        function getLogTypeText(type) {
            const typeMap = {
                'login': '登录',
                'purchase': '购买',
                'game': '游戏',
                'error': '错误',
                'system': '系统',
                'info': '信息'
            };
            return typeMap[type] || type;
        }
        
        function getLogIcon(type) {
            const icons = {
                'info': 'fas fa-info-circle',
                'success': 'fas fa-check-circle',
                'warning': 'fas fa-exclamation-triangle',
                'error': 'fas fa-times-circle',
                'system': 'fas fa-cog'
            };
            return icons[type] || 'fas fa-info-circle';
        }
        
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        function generateSessionId() {
            return 'session_' + Math.random().toString(36).substr(2, 16) + '_' + Date.now();
        }
        
        function generateRandomIP() {
            return `${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`;
        }
        
        // 带超时的fetch
        async function fetchWithTimeout(url, options, timeout = 10000) {
            const controller = new AbortController();
            const id = setTimeout(() => controller.abort(), timeout);
            
            try {
                const response = await fetch(url, {
                    ...options,
                    signal: controller.signal
                });
                clearTimeout(id);
                return response;
            } catch (error) {
                clearTimeout(id);
                throw error;
            }
        }
        
        // 生成模拟日志数据（备用）
        function generateMockLogs() {
            accountLogs = [];
            const now = new Date();
            const logTypes = ['login', 'purchase', 'game', 'error', 'system', 'info'];
            const logMessages = {
                login: ['账号登录成功', '异地登录检测', '登录验证通过', '账号安全登录'],
                purchase: ['购买车辆 Lamborghini Aventador', '金币充值 $99.99', '购买道具 Turbo Boost', '解锁新地图 Tokyo Drift'],
                game: ['完成比赛获得第一名', '打破个人记录 2:45.12', '完成每日任务', '加入多人游戏房间'],
                error: ['登录失败 - 密码错误', '网络连接超时', '购买失败 - 金币不足', '数据同步错误'],
                system: ['账号数据备份完成', '系统安全检查通过', '个人资料更新成功', '密码修改成功'],
                info: ['欢迎回到游戏', '系统维护通知: 明天3-5点', '新版本v2.5.1更新可用', '收到好友请求']
            };
            
            // 生成随机日志
            const logCount = Math.floor(Math.random() * 30) + 20;
            
            for (let i = 0; i < logCount; i++) {
                const daysAgo = Math.floor(Math.random() * 30);
                const logDate = new Date(now.getTime() - daysAgo * 24 * 60 * 60 * 1000);
                const logType = logTypes[Math.floor(Math.random() * logTypes.length)];
                const messageIndex = Math.floor(Math.random() * logMessages[logType].length);
                
                accountLogs.push({
                    id: i + 1,
                    timestamp: logDate,
                    type: logType,
                    message: logMessages[logType][messageIndex],
                    ip: generateRandomIP(),
                    device: getDeviceInfo(),
                    source: 'mock'
                });
            }
            
            accountLogs.sort((a, b) => b.timestamp - a.timestamp);
        }
        
        // 键盘快捷键支持
        document.addEventListener('keydown', (e) => {
            // Ctrl + L 快速登录
            if (e.ctrlKey && e.key === 'l' && !e.target.matches('input, textarea')) {
                e.preventDefault();
                if (loginSection.classList.contains('hidden')) {
                    handleLogout();
                } else {
                    handleLogin();
                }
            }
            
            // Esc 键退出
            if (e.key === 'Escape' && !loginSection.classList.contains('hidden')) {
                handleLogout();
            }
            
            // F5 刷新日志
            if (e.key === 'F5' && accountInfoSection.classList.contains('hidden')) {
                e.preventDefault();
                if (currentAccount) {
                    fetchAccountLogs();
                }
            }
            
            // Ctrl + R 刷新页面
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                location.reload();
            }
        });
    </script>
</body>
</html>
